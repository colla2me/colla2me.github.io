<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>å¼ ä¸‰ã®é”…</title>
  <icon>https://www.gravatar.com/avatar/ceda53888b8ef623959d14c61af2d1c0</icon>
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://zhaoxinyu.me/"/>
  <updated>2017-11-14T05:26:28.425Z</updated>
  <id>http://zhaoxinyu.me/</id>
  
  <author>
    <name>å¼ ä¸‰</name>
    <email>zhanglevan@gmail.com</email>
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>Phantom Types in Swift</title>
    <link href="http://zhaoxinyu.me/2017-11-14-Phantom-Types/"/>
    <id>http://zhaoxinyu.me/2017-11-14-Phantom-Types/</id>
    <published>2017-11-14T05:30:00.000Z</published>
    <updated>2017-11-14T05:26:28.425Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ Objc.io ä¸Šçœ‹åˆ°äº†è¿™æ ·<a href="https://talk.objc.io/episodes/S01E71-type-safe-file-paths-with-phantom-types" target="_blank" rel="external">ä¸€æœŸè§†é¢‘</a>ã€‚ä¸»è¦ä»‹ç»äº†ä¸€ç§å« Phantom Types çš„æŠ€å·§ï¼Œå®ƒçš„ä½œç”¨å°±æ˜¯åœ¨ç±»å‹ï¼ˆtypeï¼‰ï¼Œè€Œä¸æ˜¯å€¼ï¼ˆvalueï¼‰è¿™ä¸ªå±‚é¢ä¸Šæ¥è¡¨ç¤ºçŠ¶æ€ï¼Œè€Œä¸”åœ¨ç¼–è¯‘æ—¶æœŸå¯¹é”™è¯¯ç±»å‹é—´çš„è¿ç®—åšå‡ºæç¤ºã€‚</p><p>Phantom Typesï¼ˆå¹½çµç±»å‹ï¼‰ å…¶å®å°±æ˜¯ç©ºç±»å‹ã€‚æ¯”å¦‚è¿™æ ·ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Miles</span> </span>&#123;&#125;</div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Kilometers</span> </span>&#123;&#125;</div></pre></td></tr></table></figure><p>å®ƒæ¯”è¾ƒå®é™…çš„ä¸€ä¸ªåº”ç”¨æ˜¯ï¼Œè®©ç¼–è¯‘å™¨å¸®ä½ æ£€æŸ¥æŸäº›å¯¹è±¡åœ¨ç‰¹å®šçš„çŠ¶æ€ä¸‹èƒ½å¤Ÿè°ƒç”¨å“ªäº›æ–¹æ³•ã€‚ä¹Ÿèƒ½é€šè¿‡ç±»å‹æ¥è¡¨ç¤ºçŠ¶æ€ã€‚</p><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>ä¸¾ä¸€ä¸ª Foundation ä¸­ API çš„ä¾‹å­ã€‚æœ‰è¿™æ ·ä¸€ä¸ªç±» <code>NSFileHandle</code>ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)fileHandleForReadingAtPath:(<span class="built_in">NSString</span> *)path;</div><div class="line">+ (<span class="keyword">nullable</span> <span class="keyword">instancetype</span>)fileHandleForWritingAtPath:(<span class="built_in">NSString</span> *)path;</div><div class="line"></div><div class="line">- (<span class="built_in">NSData</span> *)readDataToEndOfFile;</div><div class="line">- (<span class="keyword">void</span>)writeData:(<span class="built_in">NSData</span> *)data;</div></pre></td></tr></table></figure><p>å®ƒæœ‰å‡ ç§åˆå§‹åŒ–æ–¹æ³•ï¼Œå½“ä½ åˆ›å»ºä¸€ä¸ªè¯»æ–¹å¼çš„ <code>fileHandle</code> æ—¶ï¼Œä½ åªèƒ½è°ƒç”¨è¯»ç›¸å…³çš„ APIï¼Œè°ƒç”¨å†™ç›¸å…³çš„æ˜¯æ²¡æœ‰æ„ä¹‰çš„ã€‚ä½†æ˜¯åœ¨ Objective-C ä¸­ï¼Œä¸è¶³ä»¥åœ¨ç¼–è¯‘æ—¶æœŸæŠŠè¿™ä¸ªé—®é¢˜æå®šï¼Œä½ è¿˜æ˜¯å¯ä»¥å¼€ä¸€ä¸ªè¯»çš„ <code>fileHandle</code>ï¼Œç„¶åå¯¹å®ƒè°ƒç”¨å†™çš„æ–¹æ³•ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">NSFileHandle</span> *handle = [<span class="built_in">NSFileHandle</span> fileHandleForReadingAtPath:<span class="string">@"path"</span>];</div><div class="line"><span class="comment">/// it does't make sense</span></div><div class="line">[handle writeData:someData];</div></pre></td></tr></table></figure><p>å¦‚ä½•é€šè¿‡ Phantom Types æ¥è§£å†³è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå®ç°çš„æ–¹å¼å¾ˆç®€å•ï¼Œå€ŸåŠ© Swift ä¸­çš„æ³›å‹ï¼ŒæŠŠå½“å‰ç±»å‹ä¸‹èƒ½å¤Ÿè°ƒç”¨çš„æ–¹æ³•å®šä¹‰åœ¨ç±»å‹é™å®šçš„ <code>extension</code> ä¸­å°±å¯ä»¥äº†ã€‚</p><p>æˆ‘ä»¬å®šä¹‰å‡ºä¸¤ä¸ª Phantom Typesï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Write</span> </span>&#123;&#125;</div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">Read</span> </span>&#123;&#125;</div></pre></td></tr></table></figure><p>ç„¶åå®šä¹‰å‡ºæ”¯æŒæ³›å‹çš„ <code>FileHandle</code> ç±»ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">FileHandle</span>&lt;<span class="title">OperationType</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">let</span> path: <span class="type">String</span></div><div class="line">    <span class="keyword">init</span>(<span class="number">_</span> path: <span class="type">String</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.path = path</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æŠŠä¸åŒç±»å‹ <code>handle</code> å¯ä»¥è°ƒç”¨çš„æ–¹æ³•æ”¾åˆ°ä¸åŒçš„ <code>extension</code> ä¸­ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">FileHandle</span> <span class="title">where</span> <span class="title">OperationType</span> == <span class="title">Write</span> </span>&#123;</div><div class="line">    <span class="comment">/// æŠŠåˆå§‹åŒ–æ–¹æ³•ä¹Ÿæ”¾åˆ°å„è‡ªçš„åŸå› æ˜¯å¯ä»¥è®©ç¼–è¯‘å™¨æ¨å€’ç±»å‹</span></div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">handleWithWirtePath</span><span class="params">(path: String)</span></span> -&gt; <span class="type">FileHandle</span>&lt;<span class="type">Write</span>&gt; &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">FileHandle</span>&lt;<span class="type">Write</span>&gt;(path)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">write</span><span class="params">(string: String)</span></span> &#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">FileHandle</span> <span class="title">where</span> <span class="title">OperationType</span> == <span class="title">Read</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">handleWithReadPath</span><span class="params">(path: String)</span></span> -&gt; <span class="type">FileHandle</span>&lt;<span class="type">Read</span>&gt; &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">FileHandle</span>&lt;<span class="type">Read</span>&gt;(path)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">read</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="string">""</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è°ƒç”¨å°±å¾ˆç®€å•äº†ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> f = <span class="type">FileHandle</span>.handleWithReadPath(path: <span class="string">"path/to/resources"</span>)</div><div class="line">f.read()</div></pre></td></tr></table></figure><p>å¦‚æœä½ æƒ³è¦é€šè¿‡ä¸Šé¢çš„ <code>handle</code> è°ƒç”¨ <code>write</code> ç›¸å…³çš„æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºæç¤ºï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// error: 'FileHandle&lt;Read&gt;' is not convertible to 'FileHandle&lt;Write&gt;'</span></div><div class="line">f.write(string: <span class="string">""</span>)</div></pre></td></tr></table></figure><h2 id="å†å¤šè¯´ä¸¤å¥"><a href="#å†å¤šè¯´ä¸¤å¥" class="headerlink" title="å†å¤šè¯´ä¸¤å¥"></a>å†å¤šè¯´ä¸¤å¥</h2><p>åœ¨ Haskell ä¸­ï¼Œè¿™ç§åº”ç”¨æ˜¯ä¼šåœ¨ç¼–è¯‘æ—¶æœŸè¢«ä¼˜åŒ–æ‰çš„ï¼Œæ‰€ä»¥å¹¶ä¸ä¼šå¯¹æ€§èƒ½äº§ç”Ÿä»»ä½•å½±å“ã€‚ä¸çŸ¥é“ Swift æ˜¯ä¸æ˜¯ä¹Ÿæ˜¯ä¸€æ ·ï¼ˆbut who caresï¼‰ã€‚</p><p>ä»¥ååœ¨çœ‹åˆ°ä¸€äº›ç©ºç±»å‹çš„å®šä¹‰å¯ä»¥å…ˆæ€€ç–‘å®ƒæ˜¯ä¸æ˜¯ Phantom Types çš„ä¸€ç§åº”ç”¨ï¼Œä¹Ÿè®¸å®ƒçš„å‡ºç°æ˜¯å­˜åœ¨æ„ä¹‰çš„ã€‚è¦å¥½å¥½åˆ©ç”¨ç±»å‹ç³»ç»Ÿçš„å¼ºå¤§ã€‚</p><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><ul><li><a href="https://talk.objc.io/episodes/S01E71-type-safe-file-paths-with-phantom-types" target="_blank" rel="external">Type-Safe File Paths with Phantom Types</a></li><li><a href="http://jayeshkawli.ghost.io/using-phantom-types-in-swift/" target="_blank" rel="external">Using Phantom Types in Swift</a></li><li><a href="https://www.natashatherobot.com/swift-money-phantom-types/" target="_blank" rel="external">Swift: Money with Phantom Types ğŸ‘»</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨ Objc.io ä¸Šçœ‹åˆ°äº†è¿™æ ·&lt;a href=&quot;https://talk.objc.io/episodes/S01E71-type-safe-file-paths-with-phantom-types&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ä¸€æœŸè§†
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>å‡çº§ Swift 4</title>
    <link href="http://zhaoxinyu.me/2017-09-21-Swift-4/"/>
    <id>http://zhaoxinyu.me/2017-09-21-Swift-4/</id>
    <published>2017-09-21T14:37:00.000Z</published>
    <updated>2017-09-22T05:23:54.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¬å¸çš„ CI ç»ˆäºå‡çº§åˆ°äº† Xcode 9ï¼Œæ‰€ä»¥é¡¹ç›®çš„ä»£ç ä¹Ÿå¯ä»¥å‡çº§ä¸€ä¸‹ Swift 4 äº†ã€‚å› ä¸º Xcode 9 æ˜¯æ”¯æŒ Swift 4 å’Œ Swift 3.2 åŒæ—¶å­˜åœ¨çš„ï¼Œå¦‚æœä½ æ‰€æœ‰ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“éƒ½èƒ½å¤Ÿæ”¯æŒåˆ° Swift 3.2 åŠä»¥ä¸Šï¼Œé‚£ä½ çš„é¡¹ç›®å°±èƒ½æ— ç—›å‡çº§äº†ã€‚å¦‚æœçœŸçš„å¸Œæœ›ä¸€åŠæ˜¯ 3.2 ä¸€åŠæ˜¯ 4ï¼Œå¯ä»¥é€šè¿‡<a href="https://gist.github.com/JohnSundell/519cb322978ac59f5ac161ff67e4413b" target="_blank" rel="external">è¿™æ ·</a>æ›´æ”¹ <code>Podfile</code> å®ç°è¿™ç§éœ€æ±‚ã€‚</p><p>ä½¿ç”¨ Xcode æä¾›çš„è½¬æ¢å·¥å…· <code>Edit - Conver - To current Swift syntaxâ€¦</code>ï¼Œå‹¾é€‰é»˜è®¤çš„é€‰é¡¹ <code>Minimize Inference</code>ï¼Œå°±å¯ä»¥å¼€å§‹è¿›è¡Œç¼–è¯‘å™¨è¾…åŠ©åœ°è½¬æ¢æµç¨‹äº†ã€‚è¿™è¿˜å¯ä»¥å‡å°‘ä¸€å®šçš„åŒ…å¤§å°ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿ</p><p>å¯¹äº Objective-C å’Œ Swift æ··åˆçš„é¡¹ç›®ï¼Œåœ¨ Objective-C è°ƒç”¨ Swift ä»£ç ä¹‹å‰æ˜¯éœ€è¦å¼•ç”¨ <code>xxx-Swift.h</code> å¤´æ–‡ä»¶çš„ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ç”±ç¼–è¯‘å™¨åŠ¨æ€ç”Ÿæˆçš„ã€‚åœ¨ Swift 4 ä¹‹å‰ï¼Œä¹Ÿå°±æ˜¯å¯¹åº”ä¸‹é¢çš„ <code>Match Swift 3 Behavior</code> ï¼Œç¼–è¯‘å™¨ä¼šæ— è„‘æ¨æ–­ï¼ŒæŠŠæ‰€æœ‰çš„ <code>pulic</code> å±æ€§å’Œæ–¹æ³•æš´éœ²ç»™ Objective-Cï¼Œä¹Ÿå°±æ˜¯ä¼šæœ‰å¾ˆå¤š <code>xxx-Swift.h</code> è€Œä¸”æ¯ä¸ªéƒ½å¾ˆå¤§ã€‚ä½†æ˜¯ Swift 4 ä¸­å˜å¾—ä¸¥æ ¼äº†ï¼Œåªæœ‰è¢«æ ‡è®°ä¸º <code>@objc</code> çš„æ–¹æ³•å’Œå±æ€§æ‰ä¼šæš´éœ²ç»™ Objective-Cã€‚é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥å‡å°‘ä¸€äº›ä»£ç çš„ç”Ÿæˆï¼Œä»è€Œå‡å°‘åŒ…å¤§å°ã€‚</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170921223606_7bm7p7_Screenshot.png" alt="Minimize Inference"></p><p>ç‚¹å‡» Nextã€‚ç»è¿‡ä¸€æ®µæ¼«é•¿çš„ç­‰å¾…ï¼ˆéœ€è¦ä¸€æ¬¡å®Œæ•´çš„ç¼–è¯‘ï¼‰ï¼Œç¼–è¯‘å™¨ä¼šå¸®ä½ æŠŠé¡¹ç›®ä¸­å®ƒèƒ½è½¬æ¢çš„ä»£ç éƒ½è½¬æ¢äº†ï¼Œé¡ºä¾¿æŠŠå·¥ç¨‹è®¾ç½®ä¸­çš„ Build Setting - Swift version æ”¹ä¸º 4ã€‚ä½†ä½ ä»¥ä¸ºè¿™æ ·å°±å¤§åŠŸå‘Šæˆäº†å—ï¼ŸToo yongï¼ç¼–è¯‘å™¨èƒ½å¸®ä½ åšçš„åªæ˜¯ä¸€äº›å¾®å°çš„å·¥ä½œï¼Œè€Œä¸”å®ƒè¿˜å¯èƒ½ç»™ä½ æ”¹é”™ï¼ä¸€å®šè¦åœ¨å®ƒæ”¹å®Œä¹‹åå†æ£€æŸ¥ä¸€æ¬¡ï¼Œä»¥å…å‘ç”Ÿé”™è¯¯ã€‚å† build ä¸€æ¬¡ä½ å°±ä¼šå‘ç°å¤§é‡çš„ errorï¼Œå°¤å…¶æ˜¯ä¸€ä¸ª Objective-C å’Œ Swift æ··åˆçš„é¡¹ç›®ï¼Œå‡çº§ Swift 4 å°±æ˜¯ä¸€ä¸ªä¸åœåœ¨ Swift å±æ€§å’Œæ–¹æ³•åå‰åŠ  <code>@objc</code> çš„è¿‡ç¨‹ï¼ŒåŠ åˆ°ä½ æ€€ç–‘äººç”Ÿã€‚ã€‚</p><h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><ul><li><a href="https://www.raywenderlich.com/163857/whats-new-swift-4" target="_blank" rel="external">Whatâ€™s New in Swift 4?</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å…¬å¸çš„ CI ç»ˆäºå‡çº§åˆ°äº† Xcode 9ï¼Œæ‰€ä»¥é¡¹ç›®çš„ä»£ç ä¹Ÿå¯ä»¥å‡çº§ä¸€ä¸‹ Swift 4 äº†ã€‚å› ä¸º Xcode 9 æ˜¯æ”¯æŒ Swift 4 å’Œ Swift 3.2 åŒæ—¶å­˜åœ¨çš„ï¼Œå¦‚æœä½ æ‰€æœ‰ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“éƒ½èƒ½å¤Ÿæ”¯æŒåˆ° Swift 3.2 åŠä»¥ä¸Šï¼Œé‚£ä½ çš„é¡¹ç›®å°±èƒ½æ— ç—›å‡çº§äº†ã€‚å¦‚æœçœŸ
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚æœä½ ä¹Ÿç”¨ Development Pods</title>
    <link href="http://zhaoxinyu.me/2017-09-16-development-pods-dependency-checker/"/>
    <id>http://zhaoxinyu.me/2017-09-16-development-pods-dependency-checker/</id>
    <published>2017-09-16T08:50:00.000Z</published>
    <updated>2017-09-16T08:48:15.000Z</updated>
    
    <content type="html"><![CDATA[<!-- TOC --><ul><li><a href="#èµ·æº">èµ·æº</a></li><li><a href="#ä¸ºæŸä¸ª-development-pods-åˆ›å»ºç‹¬ç«‹å·¥ç¨‹">ä¸ºæŸä¸ª Development Pods åˆ›å»ºç‹¬ç«‹å·¥ç¨‹</a></li><li><a href="#development-pods-dependency-checker">Development Pods Dependency Checker</a></li></ul><!-- /TOC --><blockquote><p>å¦‚æœä½ çš„ iOS é¡¹ç›®æ˜¯ä½¿ç”¨ Development Pods æ¥åšç»„ä»¶åŒ–çš„è¯ï¼Œè¿™ç¯‡æ–‡ç« æˆ–è®¸å€¼å¾—ä¸€çœ‹ã€‚</p></blockquote><h2 id="èµ·æº"><a href="#èµ·æº" class="headerlink" title="èµ·æº"></a>èµ·æº</h2><p>çŸ¥ä¹çš„ iOS é¡¹ç›®å¤§æ¦‚åœ¨ 2016 å¹´ Q4 å¼€å§‹è¿›è¡Œç»„ä»¶åŒ–çš„å·¥ä½œï¼Œå½“æ—¶çš„è®¡åˆ’å°±æ˜¯æŠŠä¸» target å†…çš„æ–‡ä»¶ä»¥ Development Pods çš„å½¢å¼æ‹†åˆ†ä¸º Basicï¼ŒCoreï¼ŒMiddlewareï¼ŒModule å››ç§ç±»åˆ«çš„ Development Pods ä¾›ä¸» target è¿›è¡Œä¾èµ–ã€‚</p><p>è¿™å‡ å±‚ç»“æ„ä¹‹é—´æœ‰ä¸‹é¢è¿™ä¸ªä¸‹é¢è¿™ä¸ªçº¦æŸå…³ç³»ï¼ŒPods åªèƒ½ä¾èµ–æ¯”å®ƒä»¬å±‚çº§ä½çš„è€Œä¸èƒ½ä¾èµ–æ¯”å®ƒä»¬å±‚çº§é«˜çš„ï¼Œè€Œä¸”åŒå±‚é—´ä¹Ÿå°½é‡é¿å…ä¾èµ–å…³ç³»ã€‚æ¢åè¯è¯´ï¼ŒCore å¯ä»¥ä¾èµ– Basic ä½†æ˜¯ Basic ä¸èƒ½ä¾èµ– Coreã€‚è¿™æ ·åšçš„åŸå› å¾ˆç®€å•ï¼Œå°±æ˜¯é¿å…å¾ªç¯å¼•ç”¨çš„é—®é¢˜ã€‚</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170916152928_zC1Cz2_Screenshot.png" alt=""></p><p>ç»„ä»¶åŒ–çš„ç›®çš„ä¹‹ä¸€æ˜¯å‡å°‘ä¾èµ–ï¼Œå¯ä»¥è®©ä¸€ä¸ªç»„ä»¶ç‹¬ç«‹äºä¸» target ä¹‹å¤–ç‹¬ç«‹è¿è¡Œï¼Œè¿™æ ·ä¸ºäº†è¿™ä¸ªç»„ä»¶å»ºç«‹å•ç‹¬çš„å·¥ç¨‹ï¼Œç‹¬ç«‹ç¼–è¯‘ã€å¼€å‘ï¼Œæå‡æ•ˆç‡ã€‚</p><h2 id="ä¸ºæŸä¸ª-Development-Pods-åˆ›å»ºç‹¬ç«‹å·¥ç¨‹"><a href="#ä¸ºæŸä¸ª-Development-Pods-åˆ›å»ºç‹¬ç«‹å·¥ç¨‹" class="headerlink" title="ä¸ºæŸä¸ª Development Pods åˆ›å»ºç‹¬ç«‹å·¥ç¨‹"></a>ä¸ºæŸä¸ª Development Pods åˆ›å»ºç‹¬ç«‹å·¥ç¨‹</h2><p>ä½†æ˜¯å½“æˆ‘ä¸ºä¸€ä¸ªç»„ä»¶å•ç‹¬åˆ›å»ºå·¥ç¨‹çš„æ—¶å€™ï¼Œé‡åˆ°äº†ä¸€ä¸ªé—®é¢˜ï¼Œå§‘ä¸”æŠŠå®ƒå«ä½œç»„ä»¶ R å§ã€‚ä½œä¸ºä¸€ä¸ª Podï¼ŒR çš„ä¾èµ–å…³ç³»æ˜¯ç”± R.podspec ä½“ç°çš„ï¼Œå®ƒåªéœ€è¦å…³å¿ƒå®ƒç›´æ¥ä¾èµ–çš„ä¸œè¥¿å°±å¥½äº†ï¼Œå¯¹äºå®ƒä¾èµ–çš„ä¾èµ–å®ƒæ˜¯ä¸éœ€è¦å…³å¿ƒçš„ï¼ŒCocoapods å·²ç»å¸®æˆ‘ä»¬å¤„ç†å¥½äº†ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new <span class="keyword">do</span> <span class="params">|s|</span></div><div class="line"> s.name = <span class="string">"R"</span></div><div class="line"><span class="comment"># some other fields...</span></div><div class="line"> s.dependency <span class="string">'A'</span></div><div class="line"> s.dependency <span class="string">'C'</span></div><div class="line"> s.dependency <span class="string">'E'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p>æ¯”å¦‚ï¼Œä¸Šå›¾çš„ R ä¾èµ–äº† Aã€Cã€E ä¸‰ä¸ª Podsã€‚</p><p>ä¸º R åˆ›å»ºä¾èµ–ç‹¬ç«‹å·¥ç¨‹çš„æ—¶å€™ï¼Œéœ€è¦æŠŠ R ä½œä¸ºè¿™ä¸ªå·¥ç¨‹çš„ä¸€ä¸ªä¾èµ–ï¼Œä½¿ç”¨è·¯å¾„çš„å½¢å¼å¼•å…¥ã€‚</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Podfile</span></div><div class="line"></div><div class="line">target <span class="string">'Example'</span> <span class="keyword">do</span></div><div class="line"> pod <span class="string">'R'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../R'</span>,</div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p>å¦‚æœä½ ä»¥ä¸ºè¿™æ ·å†™å°±å¤§åŠŸå‘Šæˆäº†ï¼Œå°±å¤§é”™ç‰¹é”™äº†ã€‚æ‰§è¡Œ <code>pod install</code> åå°±ä¼šå‘ç° <code>æœªèƒ½æ‰¾åˆ° A</code> ç±»ä¼¼çš„é”™è¯¯ã€‚ä¸ºä»€ä¹ˆä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜å‘¢ï¼Ÿå…¶å®æˆ‘ä¹Ÿä¸çŸ¥é“å…·ä½“çš„åŸå› ğŸ˜‚ï¼Œä½†æ˜¯ä¸€ä¸ªå¯èƒ½çš„çŒœæµ‹æ˜¯<br> <code>Podfile</code> ä¸­çš„ä¾èµ–å…³ç³»å¿…é¡»è¦æ˜ç¡®ï¼Œå°¤å…¶æ˜¯è¿™äº› pods éƒ½æ˜¯ä»¥æœ¬åœ°è·¯å¾„å…³ç³»ç›¸äº’ä¾èµ–çš„æƒ…å†µä¸‹ã€‚è€Œ <code>podspec</code> ä¸­çš„ä¾èµ–ä¸éœ€è¦é‚£ä¹ˆæ˜ç¡®ï¼ŒCocoapods ä¼šå¸®ä½ å¤„ç†ã€‚</p><p>å› ä¸ºæˆ‘ä»¬ä½¿ç”¨ Development Podsï¼Œæ‰€ä»¥æ‰€æœ‰çš„ Pods å¿…ç„¶ä»¥æœ¬åœ°è·¯å¾„çš„å…³ç³»è¿›è¡Œä¾èµ–ã€‚æ‰€ä»¥åœ¨ä¸º R åˆ›å»ºç‹¬ç«‹å·¥ç¨‹çš„æ—¶å€™ï¼Œéœ€è¦æŠŠ R ä¾èµ–çš„æ‰€æœ‰ Pods çš„è·¯å¾„æ ‡è®°å‡ºæ¥ç»™ CocoaPods çœ‹ã€‚æ‰€ä»¥ä½ å¯èƒ½ä¼šå†™å‡ºä¸‹é¢çš„ <code>Podfile</code> ï¼Œ</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'Example'</span> <span class="keyword">do</span></div><div class="line"> pod <span class="string">'R'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../R'</span></div><div class="line"> pod <span class="string">'A'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../A'</span></div><div class="line"> pod <span class="string">'C'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../C'</span></div><div class="line"> pod <span class="string">'E'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../E'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p>æ»¡æ¬£æ¬¢å–œåœ°è·‘å» <code>pod install</code> ï¼Œç»“æœåˆå¤±è´¥äº†ï¼ŒåŸæ¥ C è¿˜ä¾èµ–äº† Bï¼äºæ˜¯ä½ åˆè·‘å»ç»™ <code>podfile</code> åŠ äº†ä¸€è¡Œï¼Œ</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'Example'</span> <span class="keyword">do</span></div><div class="line"> pod <span class="string">'R'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../R'</span></div><div class="line"> pod <span class="string">'A'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../A'</span></div><div class="line"> pod <span class="string">'B'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../B'</span></div><div class="line"> pod <span class="string">'C'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../C'</span></div><div class="line"> pod <span class="string">'E'</span>, <span class="symbol">:path</span> =&gt; <span class="string">'../../E'</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p>å¥½å§ï¼Œä½ åˆå¤±è´¥äº†ï¼ŒE è¿˜ä¾èµ–äº† Dâ€¦â€¦ Stop! å¦‚æœæ€»æ˜¯è¿™æ ·ä¸€æ¬¡åˆä¸€æ¬¡ <code>pod install</code> æ‰èƒ½çŸ¥é“è‡ªå·±å…¨éƒ¨ä¾èµ–çš„ Pods æœ‰ä»€ä¹ˆæ˜¯ä¸æ˜¯å¤ªæ“äº†ï¼Ÿå¦‚æœä¾èµ–å°‘è¿˜å¥½ï¼Œä½†æ˜¯å¯¹äºä¾èµ–å¾ˆå¤šæƒ…å†µï¼Œè¿™æ ·ä¸€æ¬¡æ¬¡å¤„ç†å°±æœ‰ç‚¹ 2 äº†ã€‚èƒ½ä¸èƒ½æœ‰ä»€ä¹ˆåˆ«çš„æ–¹æ³•èƒ½ä¸€æ¬¡æ€§çŸ¥é“æŸä¸ª Development Pod çš„å…¨éƒ¨ä¾èµ–å‘¢ï¼Ÿ</p><p>ç­”æ¡ˆæ˜¯å¯ä»¥çš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥ç›´æ¥ç§»æ­¥è¿™é‡Œ <a href="https://github.com/X140Yu/development-pods-dependency-checker" target="_blank" rel="external">X140Yu/development-pods-dependency-checker</a> </p><h2 id="Development-Pods-Dependency-Checker"><a href="#Development-Pods-Dependency-Checker" class="headerlink" title="Development Pods Dependency Checker"></a>Development Pods Dependency Checker</h2><p>æ•ˆæœåœ¨ repo é‡Œçš„ README å°±å¯ä»¥çœ‹åˆ°äº†ï¼Œå®ƒèƒ½æ‰¾å‡ºå·¥ç¨‹ä¸­çš„æ‰€æœ‰ä¾èµ–ï¼Œå¹¶ä¸”æŠŠæ¯ä¸ª Pod çš„ä¾èµ–å±•å¼€ï¼Œæ˜¾ç¤ºå‡ºå®ƒçš„å…¨éƒ¨ä¾èµ–ï¼Œè€Œä¸æ˜¯ podspec ä¸­çš„é‚£ä¸€å°éƒ¨åˆ†ã€‚</p><p>å®ƒçš„åŸç†å¾ˆç®€å•ï¼Œåœ¨ <code>pod install</code> æˆåŠŸä¹‹åï¼Œ <code>Pods/Local Podspecs</code> ç›®å½•ä¸­ä¼šå‡ºç°ä¸€å † <code>*.podspec.json</code> æ–‡ä»¶ï¼Œä½ å¯ä»¥æŠŠå®ƒä»¬ç†è§£ä¸º <code>podspec</code> çš„ JSON ç‰ˆæœ¬ï¼Œè¿™å¯¹ JS å¤„ç†æ›´åŠ å‹å¥½ã€‚</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// R.podspec.json</span></div><div class="line">&#123;</div><div class="line"> <span class="string">"name"</span>: <span class="string">"R"</span>,</div><div class="line"> <span class="string">"version"</span>: <span class="string">"0.0.1"</span>,</div><div class="line"> <span class="comment">// ...</span></div><div class="line"> <span class="string">"dependencies"</span>: &#123;</div><div class="line"> <span class="string">"A"</span>: [],</div><div class="line"> <span class="string">"C"</span>: [],</div><div class="line"> <span class="string">"E"</span>: []</div><div class="line"> &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è€Œä½œä¸º localpods çš„ A, C, E ä¹Ÿä¼šæœ‰ç±»ä¼¼è¿™æ ·çš„æ–‡ä»¶ã€‚æ‰€ä»¥æˆ‘ä»¬è¦åšçš„äº‹æƒ…å°±å¾ˆç®€å•äº†ï¼ŒæŒ¨ä¸ª parse å„ä¸ª JSON æ–‡ä»¶ï¼Œé€’å½’å¤„ç† <code>dependencies</code> ä¸­çš„æ¯ä¸€é¡¹ï¼Œç›´åˆ°å®ƒçš„ <code>dependencies</code> æ˜¯ç©ºä¸ºæ­¢ã€‚å…¶å®æ ¸å¿ƒçš„é€»è¾‘ä¹Ÿå°±ä¸‹é¢è¿™ä¸€å°æ®µï¼Œ</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">trigger</span>(<span class="params">pods</span>)</span>&#123;</div><div class="line"> <span class="keyword">let</span> podsRet =[]</div><div class="line"> pods.forEach(<span class="function"><span class="params">ele</span> =&gt;</span>&#123;</div><div class="line"> podsRet.push(recursiveFindDependencies(ele, pods))</div><div class="line"> &#125;)</div><div class="line"> <span class="keyword">return</span> podsRet</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">recursiveFindDependencies</span>(<span class="params">ele, pods</span>)</span>&#123;</div><div class="line"> <span class="keyword">let</span> pod =&#123;&#125;</div><div class="line"> <span class="keyword">if</span> (ele.name == <span class="literal">undefined</span>)&#123;</div><div class="line"> <span class="keyword">return</span></div><div class="line"> &#125;</div><div class="line"> pod.name = ele.name</div><div class="line"> pod.dependencies =[]</div><div class="line"> ele.dependencies.forEach(<span class="function"><span class="params">dep</span> =&gt;</span>&#123;</div><div class="line"> <span class="keyword">if</span> (pod.dependencies.filter(<span class="function"><span class="params">es</span> =&gt;</span> es == dep).length == <span class="number">0</span>)&#123;</div><div class="line"> pod.dependencies.push(dep)</div><div class="line"> &#125;</div><div class="line"> <span class="keyword">let</span> deps = findDependencies(pods, dep).forEach(<span class="function"><span class="params">e</span> =&gt;</span>&#123;</div><div class="line"> <span class="built_in">Array</span>.prototype.push.apply(pod.dependencies, recursiveFindDependencies(e, pods))</div><div class="line"> </div><div class="line"> <span class="keyword">if</span> (pod.dependencies.filter(<span class="function"><span class="params">es</span> =&gt;</span> es == e).length == <span class="number">0</span>)&#123;</div><div class="line"> pod.dependencies.push(e)</div><div class="line"> &#125;</div><div class="line"> &#125;)</div><div class="line"> &#125;)</div><div class="line"> <span class="keyword">return</span> pod</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æœ‰äº†è¿™ä¸ªå·¥å…·ä»¥åï¼Œå°±èƒ½å¤Ÿçœ‹æ¸…ä¸€ä¸ª pod åˆ°åº•ä¾èµ–äº†ä»€ä¹ˆï¼Œé¦–å…ˆå®ƒæ›´ä¾¿äºä¸º pod åˆ›å»ºç‹¬ç«‹è¿è¡Œçš„å·¥ç¨‹ï¼Œå…¶æ¬¡ï¼Œä¹Ÿèƒ½åœ¨å¼€å‘é˜¶æ®µçŸ¥é“ä¾èµ–å…³ç³»ï¼Œé¿å…åŒå±‚ä¾èµ–åŠä½å±‚å‘æ›´é«˜å±‚çš„ pod ä¾èµ–ã€‚</p><p>å…³äºè¿™ä¸ªå°å·¥å…·ï¼Œè¿˜æƒ³è¯´ä¸¤å¥ã€‚å®ƒæ˜¯ç”¨ <a href="https://electron.atom.io/" target="_blank" rel="external">electron</a> å†™çš„ï¼Œå…¶å®è¿™ä¸œè¥¿å®Œå…¨ç”¨ä¸ä¸Š electron çš„è·¨å¹³å°ä¾¿åˆ©æ€§ï¼Œå› ä¸ºå®ƒåªå¯èƒ½åœ¨ mac ä¸Šè¿è¡Œï¼Œä½†æˆ‘è¿˜æ˜¯è„‘ä¸€æŠ½ç”¨å®ƒå†™äº†ï¼Œæ¯•ç«Ÿ HTML &amp; CSS æ¯”åŸç”Ÿå¼€å‘æ•ˆç‡é«˜å¾—å¤šã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#èµ·æº&quot;&gt;èµ·æº&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸ºæŸä¸ª-development-pods-åˆ›å»ºç‹¬ç«‹å·¥ç¨‹&quot;&gt;ä¸ºæŸä¸ª Development Pods åˆ›å»ºç‹¬ç«‹å·¥ç¨‹&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="electron" scheme="http://zhaoxinyu.me/tags/electron/"/>
    
  </entry>
  
  <entry>
    <title>ä¸ºä½ çš„ pod æ·»åŠ æµ‹è¯•</title>
    <link href="http://zhaoxinyu.me/2017-08-05-add-test-to-your-pod/"/>
    <id>http://zhaoxinyu.me/2017-08-05-add-test-to-your-pod/</id>
    <published>2017-08-05T14:00:00.000Z</published>
    <updated>2017-08-05T14:07:42.000Z</updated>
    
    <content type="html"><![CDATA[<!-- TOC --><ul><li><a href="#è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•">è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•</a></li><li><a href="#ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•">ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•</a></li><li><a href="#ä¸¾ä¸ªä¾‹å­">ä¸¾ä¸ªä¾‹å­</a></li><li><a href="#something-else">Something else</a></li></ul><!-- /TOC --><p>å‰å‡ å¤© Cocoapods release äº† <a href="http://link.zhihu.com/?target=http%3A//blog.cocoapods.org/CocoaPods-1.3.0/" target="_blank" rel="external">1.3.0</a> ï¼Œä¸€ä¸ªæ¯”è¾ƒä»¤äººæ¿€åŠ¨çš„åŠŸèƒ½æ˜¯å¯ä»¥åœ¨ pod å†…éƒ¨æ·»åŠ æµ‹è¯•äº†ã€‚</p><h2 id="è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•"><a href="#è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•" class="headerlink" title="è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•"></a>è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•</h2><p>åœ¨è¿‡å»ä¸æ”¯æŒè¿™ä¸ªåŠŸèƒ½çš„æ—¶å€™ï¼Œå¦‚æœè¦ä¸ºä¸€ä¸ª pod æ·»åŠ æµ‹è¯•å°±éœ€è¦å¦å¤–ä¸€ä¸ªå·¥ç¨‹ä¾èµ–ä¹‹ï¼Œç„¶åæŠŠæµ‹è¯•æ–‡ä»¶éƒ½æ·»åŠ åˆ°ç¦»æ­¤ pod åä¸‡å…«åƒé‡Œçš„åœ°æ–¹ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œ</p><p><img src="https://pic1.zhimg.com/v2-dc07e962a10db0e609a37fc855a3f080_b.png" alt=""></p><p>è¿™æ ·å­çš„å¼Šç«¯æ˜¯ååˆ†æ˜æ˜¾çš„ï¼Œ</p><p>é¦–å…ˆå°±æ˜¯<strong>ä»£ç å’Œæµ‹è¯•åˆ†ç¦»äº†</strong>ï¼ˆå…³äºä¸ºä»€ä¹ˆè¦æŠŠä»£ç å’Œæµ‹è¯•æ”¾åˆ°ä¸€èµ·ï¼Œ<a href="http://link.zhihu.com/?target=https%3A//kickstarter.engineering/why-you-should-co-locate-your-xcode-tests-c69f79211411" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>è§£é‡Šåœ°å¾ˆæ¸…æ¥šï¼‰ã€‚è¿™ç§åˆ†ç¦»è¿˜ä¸æ˜¯åŒä¸€ä¸ª project ä¸­ä¸åŒ target çš„åˆ†ç¦»ï¼Œè€Œæ˜¯ä¸åŒ project çš„é‚£ç§åˆ†ç¦»ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä¸ºäº†çœ‹åˆ°è¿™ä¸ª pod ä¸­çš„æµ‹è¯•ï¼Œè¿˜å¿…é¡»è¦ä¸‹è½½å¯¹åº”çš„ project æ‰“å¼€æ‰èƒ½çœ‹åˆ°ã€‚</p><p>å…¶æ¬¡ï¼Œè¿™ä¸ª pod ä¸­çš„æµ‹è¯•æ²¡æ³•åŠä½œä¸ºä¸€ä¸ª target å•ç‹¬è¿è¡Œã€‚å½“ç„¶äº†ï¼Œè¿™åªæ˜¯ä¸ªå°é—®é¢˜ã€‚</p><h2 id="ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•"><a href="#ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•" class="headerlink" title="ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•"></a>ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•</h2><p>é‚£ CocoaPods 1.3 ä¹‹åæ˜¯æ€æ ·äº†å‘¢ï¼Ÿ</p><p><img src="https://pic4.zhimg.com/v2-54e34b9e175ca1a85492d0f05a9946af_b.png" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæºç å’Œæµ‹è¯•å·²ç»åœ¨ä¸€èµ·äº†ã€‚å¦‚æœæˆ‘ä»¬æƒ³çœ‹åˆ°å¯¹åº” pod ä¸­çš„æµ‹è¯•ï¼Œç°åœ¨å·²ç»ä¸éœ€è¦ä¸‹è½½å®ƒ Example æˆ–è€… Demo çš„ project æ¥çœ‹äº†ï¼Œè€Œæ˜¯å¯ä»¥ç›´æ¥åœ¨å¯¹åº”çš„ pod æ–‡ä»¶å¤¹ä¸­çœ‹åˆ°ï¼Œååˆ†æ–¹ä¾¿ã€‚è€Œä¸”è¿™ä¸ª pod ä¸­çš„æµ‹è¯•å¯ä»¥é€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ target è¿è¡Œèµ·æ¥ï¼ˆå¦‚æœçœ‹ä¸åˆ°éœ€è¦åœ¨ <code>Manage Schemes</code> ä¸­æŠŠæµ‹è¯• target å‹¾é€‰ <code>show</code>ï¼‰ã€‚äºæ˜¯ä¸Šé¢ä¸¤ä¸ªé—®é¢˜éƒ½å¾—åˆ°äº†è§£å†³ã€‚</p><p><img src="https://pic4.zhimg.com/v2-db1f12ee5f31964825d030dea3d5233f_b.png" alt=""></p><h2 id="ä¸¾ä¸ªä¾‹å­"><a href="#ä¸¾ä¸ªä¾‹å­" class="headerlink" title="ä¸¾ä¸ªä¾‹å­"></a>ä¸¾ä¸ªä¾‹å­</h2><p>æˆ‘çš„ä¸€ä¸ª pod <a href="http://link.zhihu.com/?target=https%3A//github.com/X140Yu/pangu.Swift" target="_blank" rel="external">pangu.Swift</a> æ”¶åˆ°äº†ä¸€æ¡æ¥è‡ª <a href="http://www.zhihu.com/people/ce825ce5cb9e00b0c9046197f9edbcbd" target="_blank" rel="external">@Gao JiJi</a> çš„ issueï¼Œ</p><p><img src="https://pic4.zhimg.com/v2-4cbfa018fe2e7a94c32a4d0c6370f087_b.png" alt=""></p><p>ä½œä¸ºä¸€ä¸ªæœ‰è¿½æ±‚çš„ engineerï¼Œæ€ä¹ˆä¼šä¸å†™æµ‹è¯•å‘¢ï¼Ÿæˆ‘ä»¬å°±ä»¥è¿™ä¸ª repo ä¸ºä¾‹ï¼Œçœ‹çœ‹å¦‚ä½•ä¸ºè¿™ä¸ª pod æ·»åŠ æµ‹è¯•ã€‚</p><p>é¦–å…ˆä½ è¦ç¡®ä¿ Cocoapods çš„ç‰ˆæœ¬ &gt;= 1.3ï¼Œç‰ˆæœ¬ä¸å¤Ÿçš„åŒå­¦å¯ä»¥æ‰§è¡Œï¼Œ</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">gem install cocoapods</div></pre></td></tr></table></figure><p>æ‰“å¼€å¯¹åº”çš„ podspecï¼Œæ·»åŠ ä¸‹é¢å‡ è¡Œï¼Œ</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Pod::Spec.new <span class="keyword">do</span> <span class="params">|s|</span></div><div class="line"></div><div class="line">  <span class="comment"># ...</span></div><div class="line"></div><div class="line">  s.test_spec <span class="string">'Tests'</span> <span class="keyword">do</span> <span class="params">|test_spec|</span></div><div class="line">    test_spec.source_files = <span class="string">'Tests/*.swift'</span></div><div class="line">  <span class="keyword">end</span></div><div class="line"></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p>æ„æ€æ˜¯æˆ‘ä»¬æ·»åŠ äº†ä¸€ä¸ªå« <code>Tests</code> çš„ <code>test_spec</code>ï¼Œé‡Œé¢æµ‹è¯•æ–‡ä»¶çš„ä½ç½®åœ¨ <code>Tests/*.swift</code>ã€‚</p><p>å¦‚æœä½ çš„æµ‹è¯•éœ€è¦ä¾èµ–å…¶å®ƒ podsï¼Œå¯ä»¥åƒ sub_spec ä¸€æ ·ï¼Œæ·»åŠ  test_spec çš„ dependencyï¼Œå…·ä½“åšæ³• cocoapods ä¸­çš„é‚£ç¯‡æ–‡ç« ä¸­æœ‰å†™ã€‚</p><p>ç„¶åæˆ‘ä»¬å°±å¯ä»¥åœ¨ <code>Tests</code> ç›®å½•ä¸­æ·»åŠ æµ‹è¯•æ–‡ä»¶äº†ï¼Œæ·»åŠ å®Œæ¯•ååˆ«å¿˜è®°è‡ªå·±æµ‹è¯•ä¸€ä¸‹ï¼Œç„¶åå°±å¯ä»¥å‡çº§ä¸ªç‰ˆæœ¬ç„¶å push åˆ° spec repo ä¸­äº†ã€‚æ˜¯çš„ï¼Œå°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</p><p>å¯¹äºæ­¤ pod ä½¿ç”¨è€…ï¼Œå¦‚æœä½ ä¸æƒ³çœ‹åˆ°å®ƒçš„æµ‹è¯•ï¼Œé‚£ä»€ä¹ˆéƒ½ä¸ç”¨åšå°±å¥½äº†ã€‚ä½†æ˜¯å¦‚æœä½ æƒ³åœ¨å·¥ç¨‹é‡Œçœ‹åˆ°å¹¶è¿è¡Œå¯¹åº”çš„æµ‹è¯•ï¼Œå°±éœ€è¦ç»™ Podfile ä¸­çš„å¼•ç”¨æ·»åŠ ä¸€ä¸ªå‚æ•° <code>testspecs</code>ï¼Œ</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">target <span class="string">'Demo'</span> <span class="keyword">do</span></div><div class="line"></div><div class="line">  pod <span class="string">'Pangu-Swift'</span>, <span class="symbol">:testspecs</span> =&gt; [<span class="string">'Tests'</span>]</div><div class="line"></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><p>è¿™ä¸ªå‚æ•°å¯¹åº”çš„æ˜¯å®ƒ podspec ä¸­çš„ â€˜Testsâ€™ã€‚</p><p>æ›´æ”¹ä¹‹åè®°å¾— <code>pod install</code>ï¼Œè¿™æ ·ï¼Œæ­¤ pod ä¸­çš„æµ‹è¯•æ–‡ä»¶å°±éƒ½è¢«å¼•å…¥äº†ï¼Œè€Œä¸”è¿˜å¤šä¸€ä¸ªæµ‹è¯•çš„ target ä»¥æ”¯æŒå•ç‹¬è¿è¡Œã€‚</p><h2 id="Something-else"><a href="#Something-else" class="headerlink" title="Something else"></a>Something else</h2><ul><li>testspec å’Œ subspec ä¸€æ ·ï¼Œéƒ½æ”¯æŒå¤šä¸ªã€‚å¦‚æœä½ çš„ pod æµ‹è¯•å¤ªå¤šï¼Œå¯ä»¥æŠŠå®ƒä»¬æ‹†åˆ°ä¸åŒçš„ testspec ä¸­</li><li>å†™æµ‹è¯•æ˜¯ä¸€ç§ç¾å¾·</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;!-- TOC --&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•&quot;&gt;è¿‡å»æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•&quot;&gt;ç°åœ¨æˆ‘ä»¬å¦‚ä½•æ·»åŠ æµ‹è¯•&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ä¸¾ä¸ªä¾‹å­&quot;&gt;ä¸¾ä¸ªä¾‹å­&lt;/a&gt;&lt;/
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>èŠèŠ Result è¿™ä¸ª Swift Âµframework</title>
    <link href="http://zhaoxinyu.me/2017-07-23-result/"/>
    <id>http://zhaoxinyu.me/2017-07-23-result/</id>
    <published>2017-07-23T14:51:33.000Z</published>
    <updated>2017-12-03T15:26:42.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>æœ¬æ–‡ä¸»è¦ä»‹ç»äº† <a href="https://github.com/antitypical/Result" target="_blank" rel="external">Result</a> è¿™ä¸ª Swift çš„ Âµframework è§£å†³çš„é—®é¢˜ä»¥åŠå…¶åŸºæœ¬çš„ä½¿ç”¨ã€‚</p></blockquote><p>å…ˆæ¥çœ‹ä¸€æ®µæˆ‘ä»¬æ›¾ç»å†™è¿‡æ— æ•°æ¬¡çš„ä»£ç ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">login</span><span class="params">(userName: String, password: String, completionHandler: @escaping <span class="params">(token: String?, error: Error?)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</div><div class="line">    <span class="comment">// network request ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è¿™ä¹ˆçœ‹å¯èƒ½çœ‹ä¸å‡ºä»€ä¹ˆé—®é¢˜ï¼Œæˆ‘ä»¬æ¥è¯•ç€è°ƒç”¨ä¸€ä¸‹è¿™ä¸ªæ–¹æ³•å§ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="type">RequestHelper</span>.login(username: <span class="string">"123"</span>, password: <span class="string">"123"</span>) &#123; (token, error) <span class="keyword">in</span></div><div class="line">    <span class="comment">/// how to handle token &amp; error?</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p><code>completionHandler</code> ä¸­çš„ token å’Œ error æ˜¯åŒ…åœ¨ä¸€ä¸ªæ‹¬å·é‡Œçš„ï¼ŒåŒ…åœ¨ä¸€ä¸ªæ‹¬å·é‡Œè¯´æ˜å®ƒä»¬æ„æˆä¸€ä¸ª tuppleï¼Œtupple ä»£è¡¨ <code>and</code> çš„æ„æ€ï¼Œè€Œä¸”è¿™ä¸¤ä¸ªå‚æ•°è¿˜éƒ½æ˜¯ optional çš„ï¼Œä¹Ÿå°±è¯´æ˜è¿™ä¸ª completion çš„å‚æ•°æœ‰ä»¥ä¸‹å››ç§æƒ…å†µï¼Œ</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170723172210_MAvDKk_Screenshot.png" alt=""></p><p>å¯ä»¥çœ‹å‡ºï¼Œåªæœ‰ (1) å’Œ (4) çš„å‚æ•°ç»„åˆå¯¹äºè°ƒç”¨è€…æ˜¯æœ‰æ„ä¹‰çš„ã€‚ä½ å¯èƒ½ä¼šæå‡ºç–‘é—®ï¼Œ(2) å’Œ (3) çš„ç»„åˆåº”è¯¥ä¸ä¼šæœ‰äººå»åˆ¤æ–­å§ï¼Ÿçš„ç¡®ï¼Œä½†æ˜¯è¿™æ˜¯å› ä¸ºä½ çš„åˆ¤æ–­å»ºç«‹åœ¨å¤§å®¶æˆ–è€…å›¢é˜Ÿçš„ã€Œéšæ€§ã€çº¦å®šä¹‹ä¸Šï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™ä¸¤ç§æƒ…å½¢çš„ç»„åˆæ˜¯ä¸åº”å½“å­˜åœ¨ï¼Œæ‰€ä»¥æ‰ä¸å»åˆ¤æ–­ï¼Œè€Œä¸æ˜¯è®©ä»£ç æ˜ç¡®åœ°è¯´æ˜æ ¹æœ¬æ²¡æœ‰è¿™ä¸¤ç§ç»„åˆçš„æƒ…å†µã€‚</p><p>è¿™ä¸ª <code>completionHandler</code> å‚æ•°çš„è¯­æ„ä»£è¡¨çš„åº”å½“æ˜¯ <code>token | error</code> è€Œä¸æ˜¯ <code>token? &amp; error?</code> æ—¢ç„¶ tuple æ˜¯ä»£è¡¨ <code>&amp;</code>ï¼Œé‚£ä»€ä¹ˆä»€ä¹ˆä»£è¡¨ <code>|</code> å‘¢ï¼Ÿ</p><p>æ²¡é”™ï¼Œå°±æ˜¯ enumï¼</p><p><a href="https://github.com/antitypical/Result" target="_blank" rel="external">Result</a> è¿™ä¸ªç®€å•çš„ library å°±æ˜¯è§£å†³è¿™ç±»é—®é¢˜çš„ã€‚</p><h2 id="Result-è§£å†³äº†ä»€ä¹ˆé—®é¢˜"><a href="#Result-è§£å†³äº†ä»€ä¹ˆé—®é¢˜" class="headerlink" title="Result è§£å†³äº†ä»€ä¹ˆé—®é¢˜"></a>Result è§£å†³äº†ä»€ä¹ˆé—®é¢˜</h2><p>åœ¨ä½¿ç”¨äº† Result ä¹‹åï¼Œå‡½æ•°çš„å®šä¹‰åŠå®ç°å˜æˆäº†è¿™æ ·ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="class"><span class="keyword">enum</span> <span class="title">LoginError</span>: <span class="title">Error</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> noNetwork</div><div class="line">    <span class="keyword">case</span> wrongUsername</div><div class="line">    <span class="keyword">case</span> wrongPassword</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">login</span>(<span class="title">username</span>: <span class="title">String</span>, <span class="title">password</span>: <span class="title">String</span>, <span class="title">completion</span>: @<span class="title">escaping</span> (<span class="title">Result</span>&lt;<span class="title">String</span>, <span class="title">LoginError</span>&gt;) -&gt; <span class="title">Void</span>) </span>&#123;</div><div class="line">    <span class="comment">// network request</span></div><div class="line">    completion(.success(<span class="string">"123jl123"</span>))</div><div class="line">    <span class="comment">// or</span></div><div class="line">    completion(.failure(.wrongPassword))</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>è°ƒç”¨è€…è§†è§’ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="type">RequestHelper</span>.login(username: <span class="string">"123"</span>, password: <span class="string">"123"</span>) &#123; (result) <span class="keyword">in</span></div><div class="line">    <span class="keyword">switch</span> result &#123;</div><div class="line">    <span class="keyword">case</span> .success(<span class="keyword">let</span> token):</div><div class="line">        <span class="comment">// do something with token</span></div><div class="line">        <span class="keyword">break</span></div><div class="line">    <span class="keyword">case</span> .failure(<span class="keyword">let</span> error):</div><div class="line">        <span class="keyword">switch</span> error &#123;</div><div class="line">        <span class="keyword">case</span> .noNetwork:</div><div class="line">            <span class="keyword">break</span></div><div class="line">        <span class="keyword">case</span> .wrongUsername:</div><div class="line">            <span class="keyword">break</span></div><div class="line">        <span class="keyword">case</span> .wrongPassword:</div><div class="line">            <span class="keyword">break</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">break</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸è§‰å¾—ç”Ÿæ´»æ›´ç¾å¥½äº†å—ï¼Ÿè¿™å…¶ä¸­æ²¡æœ‰éšæ€§çš„çº¦å®šï¼Œæ²¡æœ‰å‡ºç°ç†è§£ä¸äº†çš„æƒ…å†µç»„åˆï¼Œåªéœ€è¦æŒ‰ç…§ swich é‡Œé¢çš„ case å¤„ç†å¯¹åº”çš„æƒ…å†µå°±å¥½äº†ã€‚</p><p>æ‰€ä»¥ Result è§£å†³äº†ä¸€ç±»é—®é¢˜ï¼Œå°±æ˜¯æŠŠ<em>å¯èƒ½æˆåŠŸ</em>æˆ–è€…<em>å¯èƒ½å¤±è´¥</em>çš„æƒ…å†µç»„åˆä» tuple å˜ä¸ºäº† enumã€‚</p><p>Swift çš„ç½‘ç»œè¯·æ±‚åº“ <a href="https://github.com/Moya/Moya/blob/master/Moya.podspec#L26" target="_blank" rel="external">Moya</a> ä¾èµ–äº†è¿™ä¸ªå°æ¡†æ¶ï¼Œå¦ä¸€ä¸ªè‘—åçš„ç½‘ç»œåº“ <a href="https://github.com/Alamofire/Alamofire/blob/master/Source/Result.swift" target="_blank" rel="external">Alamofire</a> ä¹Ÿæœ‰ç±»ä¼¼çš„è®¾è®¡ã€‚</p><p>é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼Œå¦‚æœåªæ˜¯ä¸ºäº†ä¸€ä¸ª enum çš„å®šä¹‰ï¼Œæˆ‘ä»¬æœ‰ä»€ä¹ˆç†ç”±ä¾èµ–ä¸€ä¸ª framework å‘¢ï¼Ÿ</p><h2 id="Result-ä¸­çš„é«˜é˜¶å‡½æ•°"><a href="#Result-ä¸­çš„é«˜é˜¶å‡½æ•°" class="headerlink" title="Result ä¸­çš„é«˜é˜¶å‡½æ•°"></a>Result ä¸­çš„é«˜é˜¶å‡½æ•°</h2><p>çœ‹æ–‡æ¡£ä¼šçŸ¥é“ Result ç±»å‹å®ç°äº† <code>map</code> å’Œ <code>flatMap</code> å‡½æ•°ï¼Œæ‰€ä»¥ Result æ˜¯ä¸ª Monadï¼ˆå¦‚æœä½ ä¸çŸ¥é“ä»€ä¹ˆæ˜¯ Monad æ²¡æœ‰å…³ç³»ï¼Œæˆ‘åªæ˜¯è·©äº†ä¸€ä¸ªåè¯ï¼Œåƒä¸‡ä¸è¦ä¸€è§åˆ° Monad å°±å®³æ€•äº†ï¼Œå…¶å®æ²¡æœ‰ä»€ä¹ˆå¤æ‚çš„ä¸œè¥¿ï¼‰ã€‚æˆ‘ä»¬ç®€å•åœ°çœ‹ä¸€ä¸‹ Result çš„ <code>map</code> å’Œ <code>flatMap</code> éƒ½åšäº†ä»€ä¹ˆï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// Returns a new Result by mapping `Success`esâ€™ values using `transform`, or re-wrapping `Failure`sâ€™ errors.</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">map</span>&lt;U&gt;<span class="params">(<span class="number">_</span> transform: <span class="params">(<span class="keyword">Self</span>.Value)</span></span></span> -&gt; <span class="type">U</span>) -&gt; <span class="type">Result</span>.<span class="type">Result</span>&lt;<span class="type">U</span>, <span class="type">Self</span>.<span class="type">Error</span>&gt;</div><div class="line"></div><div class="line"><span class="comment">/// Returns the result of applying `transform` to `Success`esâ€™ values, or re-wrapping `Failure`â€™s errors.</span></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">flatMap</span>&lt;U&gt;<span class="params">(<span class="number">_</span> transform: <span class="params">(<span class="keyword">Self</span>.Value)</span></span></span> -&gt; <span class="type">Result</span>.<span class="type">Result</span>&lt;<span class="type">U</span>, <span class="type">Self</span>.<span class="type">Error</span>&gt;) -&gt; <span class="type">Result</span>.<span class="type">Result</span>&lt;<span class="type">U</span>, <span class="type">Self</span>.<span class="type">Error</span>&gt;</div></pre></td></tr></table></figure><p>å‡å¦‚æˆ‘ä»¬çš„ç±»å‹æ˜¯è¿™æ ·çš„ï¼Œ<code>Result&lt;T, E&gt;</code>ï¼ˆT æ˜¯ value çš„ç±»å‹ï¼ŒE æ˜¯ Error çš„ç±»å‹ï¼‰ï¼Œè§‚å¯Ÿä¸Šé¢çš„å‡½æ•°ç­¾åï¼Œ</p><p>å¯¹å®ƒè°ƒç”¨ <code>map</code> æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„ <code>Result&lt;U, E&gt;</code>ï¼Œä¹Ÿå°±æ˜¯ Value ç±»å‹å‘ç”Ÿäº†æ”¹å˜ï¼Œè€Œ Error çš„ç±»å‹è¿˜è·ŸåŸæ¥ä¸€æ ·ã€‚</p><p>å¯¹å®ƒè°ƒç”¨ <code>flatMap</code> æ–¹æ³•ï¼Œä¼šè¿”å›ä¸€ä¸ªæ–°çš„ <code>Result&lt;U, F&gt;</code>ï¼Œvalue å’Œ error çš„ç±»å‹éƒ½å¯ä»¥è¢«æ”¹å˜ï¼Œ</p><p>é€šè¿‡ä¸€ä¸ªä¾‹å­æ¥ç†è§£ä¸€ä¸‹ã€‚æ¯”å¦‚æœ‰è¿™æ ·ä¸€ä¸ª Resultï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> loginResult = <span class="type">Result</span>&lt;<span class="type">String</span>, <span class="type">LoginError</span>&gt;(<span class="string">"123"</span>)</div></pre></td></tr></table></figure><p>å¯¹å®ƒè°ƒç”¨ <code>map</code>ï¼Œ<code>transform</code> å‡½æ•°ç»™äº†ä½ ä¸€ä¸ªæ”¹å˜ value ç±»å‹çš„æœºä¼šï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">loginResult.<span class="built_in">map</span> &#123; token -&gt; <span class="type">U</span> <span class="keyword">in</span></div><div class="line">    <span class="comment">/// transform token to any type you like</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¯¹å®ƒè°ƒç”¨ <code>flatMap</code>ï¼Œ<code>transform</code> å‡½æ•°ç»™äº†ä½ ä¸€ä¸ªè¿”å›ä¸€ä¸ªç±»å‹å®Œå…¨ä¸ä¸€æ ·çš„ <code>Result</code> çš„æœºä¼šï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">loginResult.flatMap &#123; token -&gt; <span class="type">Result</span>&lt;<span class="type">U</span>, <span class="type">E</span>&gt; <span class="keyword">in</span></div><div class="line">    <span class="comment">// trnasform token or error to any type you like</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¾ˆå¤š framwork ä¸­çš„ç±»å‹éƒ½å®ç°äº† <code>map</code> å’Œ <code>flatMap</code>ï¼Œæ¯”å¦‚ RxSwift ä¸­çš„ <code>Observable</code>ï¼ŒPromise ä¸­çš„ <code>Promise</code>ï¼ˆè™½ç„¶å‘½åå¯èƒ½æ˜¯ <code>then</code> ä½†è·Ÿ <code>flatMap</code> çš„ç­¾åæ˜¯ç±»ä¼¼çš„ï¼‰ã€‚</p><p>æœ‰äº†è¿™äº›æ–¹æ³•å°±å¯ä»¥å¯¹ Result è¿›è¡Œæ›´å¤šçš„å˜æ¢æ“ä½œï¼Œä»è€ŒæŠŠä¸€ä¸ªä¸çŸ¥é“ä»ä»€ä¹ˆåœ°æ–¹é£æ¥çš„ Result å˜æˆä¸€ä¸ªä½ çœŸæ­£éœ€è¦çš„ Resultã€‚</p><h2 id="Result-çš„ä»·å€¼"><a href="#Result-çš„ä»·å€¼" class="headerlink" title="Result çš„ä»·å€¼"></a>Result çš„ä»·å€¼</h2><p>å®ƒ repo ä¸­çš„ README æœ‰è¿™æ ·ä¸€å¥è¯ï¼Œ</p><blockquote><p>Using this Âµframework instead of rolling your own Result type allows you to easily interface with other frameworks that also use Result.</p></blockquote><p>å¯¹äºå¾ˆå¤š framework æ¥è¯´ï¼Œå®ƒä»¬éƒ½éœ€è¦åƒ Result ç±»ä¼¼çš„æ•°æ®ç»“æ„æ¥ä»£è¡¨å¯èƒ½æˆåŠŸå¯èƒ½å¤±è´¥çš„ç»“æœã€‚æ‰€ä»¥ Result çš„æ„¿æ™¯æ˜¯ï¼Œä¸å¸Œæœ›å¤§å®¶å†å®šä¹‰å±äºè‡ªå·±çš„ Result ç±»å‹ï¼Œè€Œæ˜¯ä½¿ç”¨æˆ‘ï¼Œè¿™æ ·åœ¨ Result ä¹‹é—´çš„è½¬æ¢ä¹Ÿæ¯”è¾ƒè½»æ¾ï¼Œè€Œä¸”è¿˜çœå»äº†å¾ˆå¤šç±»ä¼¼çš„å†—ä½™ä»£ç ã€‚</p><p>å¦‚æœä½ ä¾èµ–çš„ framwork å·²ç»ä¾èµ–äº† Resultï¼Œé‚£ä¹ˆåœ¨å†™ä¸‹ä¸€ä¸ªç±»ä¼¼ <code>login</code> çš„å‡½æ•°æ—¶ï¼Œè¯•è¯•è¿”å›ä¸€ä¸ª Resultï¼›æ²¡æœ‰ä¾èµ–ä¹Ÿæ²¡æœ‰å…³ç³»ï¼Œåœ¨å†™ä¸‹ä¸€ä¸ªè¿”å›å¯èƒ½æˆåŠŸå¯èƒ½å¤±è´¥çš„å¤šä¸ªå‚æ•°çš„å‡½æ•°æ—¶ï¼Œç”¨ <code>enum</code> ä»£æ›¿ <code>tuple</code> å§ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;æœ¬æ–‡ä¸»è¦ä»‹ç»äº† &lt;a href=&quot;https://github.com/antitypical/Result&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Result&lt;/a&gt; è¿™ä¸ª Swift çš„ Âµframework è§£å†³çš„é—®
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•æ­£ç¡®ä¹¦å†™ iOS ä¸­çš„ Initializer</title>
    <link href="http://zhaoxinyu.me/2017-07-16-iOS-initializers/"/>
    <id>http://zhaoxinyu.me/2017-07-16-iOS-initializers/</id>
    <published>2017-07-16T08:46:33.000Z</published>
    <updated>2017-07-16T08:47:41.000Z</updated>
    
    <content type="html"><![CDATA[<p>å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå†™ Initializer åº”è¯¥æ˜¯æ—¥å¸¸ã€‚ä¼šå†™çš„å¯ä»¥ç›´æ¥ä¸çœ‹ã€‚å¦‚æœæ²¡æœ‰å¥½å¥½äº†è§£è¿‡å¦‚ä½•å†™ Initializerï¼Œæ¯æ¬¡éƒ½å‡­ç€æ„Ÿè§‰å†™è€Œä¸”è¿˜æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯´æ˜å…¶ä¸­çš„ã€Œç„æœºã€ä½ å·²ç»æŒæ¡äº†ï¼Œå¯ä»¥å¤§æ¦‚æ‰«ä¸€æ‰«ã€‚ä½†æ˜¯æ¯æ¬¡å†™ Initializer éƒ½è¦æŸ¥ Googleï¼Œé‚£è¿™ç¯‡æ–‡ç« å°±æ˜¯ç»™ä½ ï¼ˆæˆ‘ğŸŒšï¼‰å‡†å¤‡çš„</p><h2 id="Initializer-çš„ç§ç±»"><a href="#Initializer-çš„ç§ç±»" class="headerlink" title="Initializer çš„ç§ç±»"></a>Initializer çš„ç§ç±»</h2><p>ä¸€ä¸ªç±»ä¸­å¯èƒ½ä¼šæœ‰å¤šä¸ª Initializerï¼Œä½†ä¸ç®¡æœ‰å¤šå°‘ï¼Œéƒ½åªä¼šæ˜¯ä¸‹é¢ä¸¤ç§ç±»å‹ä¸­çš„ä¸€ç§ã€‚</p><h3 id="Designated-Initializer-æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•"><a href="#Designated-Initializer-æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•" class="headerlink" title="Designated Initializer (æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•)"></a>Designated Initializer (æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•)</h3><p>æ˜¯ç±»ä¸­çš„ä¸€ç­‰ Initializerï¼Œä¼šæŠŠç±»ä¸­æ‰€æœ‰ç›¸å…³çš„å±æ€§éƒ½åˆå§‹åŒ–ã€‚éœ€è¦è°ƒç”¨çˆ¶ç±»çš„ Designated Initializerã€‚</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170716155049_I9fzIr_Screenshot.png" alt=""></p><h3 id="Convenience-Initializer-ä¾¿æ·åˆå§‹åŒ–æ–¹æ³•"><a href="#Convenience-Initializer-ä¾¿æ·åˆå§‹åŒ–æ–¹æ³•" class="headerlink" title="Convenience Initializer (ä¾¿æ·åˆå§‹åŒ–æ–¹æ³•)"></a>Convenience Initializer (ä¾¿æ·åˆå§‹åŒ–æ–¹æ³•)</h3><p>æ˜¯ç±»ä¸­çš„äºŒç­‰ Initializerï¼Œä¼šè°ƒç”¨ç±»ä¸­çš„ Designated Initializer æˆ– Convenience Initializerï¼ŒæŠŠå…¶å®ƒæ²¡æœ‰ä¼ è¿›æ¥çš„å±æ€§åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ã€‚ä¸»è¦æ˜¯ç»™è°ƒç”¨è€…ä»¥æ–¹ä¾¿ã€‚è¢«å…¶å®ƒ Convenience Initializer è°ƒç”¨çš„ Convenience Initializerï¼Œå¿…é¡»è°ƒç”¨åŒç±»ä¸­çš„ Designated Initializerã€‚</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170716155026_ntKTia_Screenshot.png" alt=""></p><p>é‚£ä¹ˆå¦‚ä½•åŒºåˆ†ç±»ä¸­çš„åˆå§‹åŒ–æ–¹æ³•æ˜¯ designated çš„è¿˜æ˜¯ convenience çš„å‘¢ï¼Ÿæœ‰å‡ ä¸ªæ–¹æ³•ï¼Œ</p><ul><li>é€šå¸¸æ¥è¯´ï¼ŒDesignated Initializer çš„å‚æ•°è¦æ¯” Convenience Initializer å¤šï¼Œå› ä¸ºæŒ‡å®šåˆå§‹åŒ–æ–¹æ³•å¸Œæœ›æŠŠè¿™ä¸ªç±»ä¸­çš„ç›¸å…³å±æ€§éƒ½åˆå§‹åŒ–æ‰ï¼Œè€Œä¾¿æ·åˆå§‹åŒ–æ–¹æ³•åªä¼šåˆå§‹åŒ–æ‰ä¸€éƒ¨åˆ†ï¼Œå…¶ä½™ä¸å¤ªè¦ç´§çš„å±æ€§åˆ™ä¼šæä¾›é»˜è®¤å€¼ã€‚</li><li>çœ‹è¿™ä¸ªæ–¹æ³•çš„å£°æ˜é‡Œæœ‰æ²¡æœ‰ä½¿ç”¨ <code>NS_DESIGNATED_INITIALIZER</code> æ ‡è®°ã€‚</li></ul><p>ç»“åˆä¸€ä¸ª <code>UIViewController</code> å­ç±»ï¼Œçœ‹çœ‹ Initializer åˆ°åº•è¯¥æ€ä¹ˆå†™ã€‚</p><h2 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h2><p>ä¸è€ƒè™‘ä½¿ç”¨ StoryBoard çš„æƒ…å†µ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">ProfileViewController</span> : <span class="title">UIViewController</span></span></div><div class="line"></div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *userID;</div><div class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">readonly</span>, <span class="keyword">copy</span>) <span class="built_in">NSString</span> *gender; <span class="comment">// "0" or "1"</span></div><div class="line"></div><div class="line"><span class="keyword">@end</span></div></pre></td></tr></table></figure><p>åœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œ<code>userID</code> æ˜¯å¿…é¡»è¦è¢«åˆå§‹åŒ–çš„ï¼Œè€Œ <code>gender</code> åœ¨ä¸çŸ¥é“çš„æƒ…å†µä¸‹å¯ä»¥è¢«åˆå§‹åŒ–ä¸ºé»˜è®¤å€¼ï¼Œåç»­å¯ä»¥é€šè¿‡ç½‘ç»œè¯·æ±‚æ›´æ–°è¿™ä¸ªå€¼ã€‚é‚£ä¹ˆè¿™ä¸ªç±»çš„åˆå§‹åŒ–æ–¹æ³•å¤§æ¦‚åº”è¯¥é•¿æˆè¿™ä¸ªæ ·å­ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">+ (<span class="keyword">instancetype</span>)new <span class="built_in">NS_UNAVAILABLE</span>; <span class="comment">// (1)</span></div><div class="line">- (<span class="keyword">instancetype</span>)init <span class="built_in">NS_UNAVAILABLE</span>; <span class="comment">// (2)</span></div><div class="line">- (<span class="keyword">instancetype</span>)initWithCoder:(<span class="built_in">NSCoder</span> *)aDecoder <span class="built_in">NS_UNAVAILABLE</span>; <span class="comment">// (3)</span></div><div class="line">- (<span class="keyword">instancetype</span>)initWithNibName:(<span class="built_in">NSString</span> *)nibNameOrNil bundle:(<span class="built_in">NSBundle</span> *)nibBundleOrNil <span class="built_in">NS_UNAVAILABLE</span>; <span class="comment">// (4)</span></div><div class="line"></div><div class="line">- (<span class="keyword">instancetype</span>)initWithUserID:(<span class="built_in">NSString</span> *)userID gender:(<span class="built_in">NSUInteger</span>)gender <span class="built_in">NS_DESIGNATED_INITIALIZER</span>; <span class="comment">// (5)</span></div><div class="line">- (<span class="keyword">instancetype</span>)initWithUserID:(<span class="built_in">NSString</span> *)userID; <span class="comment">// (6)</span></div></pre></td></tr></table></figure><p>ä»ä¸Šå¾€ä¸‹çœ‹ï¼Œ(1) ~ (4) éƒ½æ˜¯ä»çˆ¶ç±»ä¸­ç»§æ‰¿æ¥çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œè™½ç„¶æˆ‘ä»¬çš„ç±»èƒ½å¤Ÿä½¿ç”¨è¿™äº›æ–¹æ³•åˆå§‹åŒ–ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›è°ƒç”¨è€…ä½¿ç”¨è¿™äº›æ–¹æ³•ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´ <code>userID</code> æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼Œé€»è¾‘å°±ä¼šä¸æ­£ç¡®äº†ï¼Œä½œä¸ºä¸€ä¸ªæœ‰èŠ‚æ“çš„ programmerï¼ŒæŠŠè¿™äº›æ–¹æ³•æ ‡è®°ä¸º <code>NS_UNAVAILABLE</code>ï¼Œå‘Šè¯‰è°ƒç”¨è€…ï¼Œä¸è¦ä½¿ç”¨è¿™äº›æ–¹æ³•åˆå§‹åŒ–ï¼ŒXcode ä¹Ÿä¼šæœ‰è°ƒç”¨è¿™äº›æ–¹æ³•çš„åœ°æ–¹æŠ›å‡ºé”™è¯¯ã€‚</p><p>(5) ä¼šåˆå§‹åŒ–æ‰æ‰€æœ‰ç›¸å…³çš„å±æ€§ï¼Œæ‰€ä»¥å®ƒæ˜¯ä½œä¸º Designated Initializer çš„å­˜åœ¨ï¼ŒåŒæ ·ä½œä¸ºä¸€ä¸ªæœ‰èŠ‚æ“çš„ programmerï¼Œæˆ‘ä»¬æŠŠå®ƒæ ‡è®°ä¸º <code>NS_DESIGNATED_INITIALIZER</code>ï¼Œè¿™ä¸ªæ ‡è®°ä¼šåšä»¥ä¸‹å‡ ä»¶äº‹æƒ…ï¼Œ</p><ul><li>åœ¨å®ç°è¿™ä¸ªæŒ‡å®šåˆå§‹åŒ–æ–¹æ³•æ—¶ï¼Œå¦‚æœæ²¡æœ‰è°ƒç”¨çˆ¶ç±»çš„ Designated Initializerï¼ŒXcode ä¼šæŠ›å‡ºè­¦å‘Šã€‚</li><li>Xcode ä¼šæŠŠå…¶å®ƒæ²¡æœ‰è¿™ä¸ªæ ‡è®°çš„åˆå§‹åŒ–æ–¹æ³•è‡ªåŠ¨è®¤ä¸ºæ˜¯ Convenience Initializerï¼ŒåŒ…æ‹¬ä»çˆ¶ç±»ç»§æ‰¿æ¥çš„ Designated Initializerï¼Œå¹¶åœ¨å®ç°çš„æ—¶å€™æ£€æŸ¥å‡½æ•°å†…æœ‰æ²¡æœ‰è°ƒç”¨åŒç±»ä¸­çš„å…¶å®ƒåˆå§‹åŒ–æ–¹æ³• (Convenience å’Œ Designated éƒ½å¯ä»¥)ã€‚</li></ul><p>æ‰€ä»¥è¿™ä¸ªæ ‡è®°æ˜¯éå¸¸æœ‰ç”¨çš„ï¼Œå¦‚æœä½ åœ¨é€‚å½“çš„åˆå§‹åŒ–æ–¹æ³•å‰é¢åŠ äº†è¿™ä¸ªæ ‡è®°ï¼Œè€Œä¸”å®ç°ç±»ä¸­çš„æ‰€æœ‰åˆå§‹åŒ–æ–¹æ³•åè¿˜æ²¡æœ‰è­¦å‘Šï¼Œé‚£ä¹ˆå‡ºé”™å‡ ä¹æ˜¯ä¸å¯èƒ½çš„ã€‚æ‰€ä»¥åœ¨å®ç°æ–°ç±»åˆå§‹åŒ–æ–¹æ³•çš„æ—¶å€™éƒ½åº”è¯¥æ·»åŠ è¿™ä¸ªæ ‡è®°ï¼Œè®©ç¼–è¯‘å™¨æé†’ä½ åˆ°åº•åº”è¯¥åšä»€ä¹ˆäº‹æƒ…ï¼Œå‡å°‘çŠ¯é”™è¯¯çš„å¯èƒ½ã€‚</p><p>(6) æ˜¯ä¸€ä¸ª Convenience Initializerã€‚</p><p>çœ‹åˆ°è¿™é‡Œï¼Œå®ç°ä¸Šé¢ç±»ä¸­çš„ä¸¤ä¸ªåˆå§‹åŒ–æ–¹æ³•åº”è¯¥å¾ˆå®¹æ˜“äº†å§ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">instancetype</span>)initWithUserID:(<span class="built_in">NSString</span> *)userID &#123;</div><div class="line">    <span class="keyword">return</span> [<span class="keyword">self</span> initWithUserID:userID gender:<span class="string">@"1"</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">instancetype</span>)initWithUserID:(<span class="built_in">NSString</span> *)userID gender:(<span class="built_in">NSString</span> *)gender &#123;</div><div class="line">    <span class="keyword">if</span> (<span class="keyword">self</span> = [<span class="keyword">super</span> initWithNibName:<span class="string">@""</span> bundle:<span class="literal">nil</span>]) &#123;</div><div class="line">        _userID = userID;</div><div class="line">        _gender = gender;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>ä¸€å¥è¯æ€»ç»“ï¼Œå­ç±»çš„æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•å¿…é¡»è°ƒçˆ¶ç±»çš„æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ï¼›å­ç±»çš„ä¾¿æ·åˆå§‹åŒ–æ–¹æ³•å¿…é¡»è°ƒç”¨åŒç±»çš„å…¶å®ƒåˆå§‹åŒ–æ–¹æ³•ã€‚</p><h2 id="Swift"><a href="#Swift" class="headerlink" title="Swift"></a>Swift</h2><p>Swift è·Ÿ Objective-C ä¸å¤ªä¸€æ ·ï¼Œä¸ä¼šé»˜è®¤è¦æ±‚ä½ é‡å†™çˆ¶ç±»çš„æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ã€‚å¦‚æœè¦†å†™äº†çˆ¶ç±»ä¸­çš„æŒ‡å®šåˆå§‹åŒ–æ–¹æ³•ï¼Œä¸€å®šè¦åŠ ä¸Š <code>override</code> å…³é”®å­—ã€‚</p><p>åŠ äº† <code>convience</code> å…³é”®å­—çš„å°±æ˜¯ Convenience Initializerï¼Œè§„åˆ™ä¸ Objective-C çš„ç›¸åŒã€‚</p><p>å¯¹äºåˆå§‹åŒ–æ–¹æ³•å‰é¢æ²¡æœ‰ <code>convience</code> å…³é”®å­—çš„ï¼Œç¼–è¯‘å™¨éƒ½ä¼šæŠŠå®ƒå½“ä½œ Designated Initializerï¼Œè·Ÿ Objective-C åˆå§‹åŒ–æ–¹æ³•å‰é¢åŠ  <code>NS_DESIGNATED_INITIALIZER</code> æ˜¯ä¸€æ ·çš„ã€‚åœ¨å®ç°è¿™äº›æ–¹æ³•æ—¶ï¼Œå¯ä»¥å‚è€ƒä¸Šé¢çš„è§„åˆ™ã€‚</p><p>å¯¹äºå¯èƒ½å¤±è´¥çš„åˆå§‹åŒ–æ–¹æ³•ï¼Œéœ€è¦æŠŠ <code>init</code> å…³é”®å­—æ¢æˆ <code>init?</code>ï¼Œè°ƒç”¨æ­¤ç±»åˆå§‹åŒ–æ–¹æ³•æ—¶ï¼Œè¿”å›å€¼ä¹Ÿä¼šä»ç¡®è®¤æœ‰å€¼ï¼Œå˜æˆä¸€ä¸ª optionalã€‚</p><p>æ‰€ä»¥ä¸€ä¸ª Swift çš„ UIViewController å­ç±»å¤§æ¦‚éœ€è¦è¿™æ ·å†™ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ProfileViewController</span>: <span class="title">UIViewController</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">let</span> userID: <span class="type">String</span></div><div class="line">    <span class="keyword">let</span> gender: <span class="type">String</span></div><div class="line"></div><div class="line">    <span class="keyword">init</span>(userID: <span class="type">String</span>, gender: <span class="type">String</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.userID = userID</div><div class="line">        <span class="keyword">self</span>.gender = gender</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>(nibName: <span class="literal">nil</span>, bundle: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>(nibName nibNameOrNil: <span class="type">String</span>?, bundle nibBundleOrNil: <span class="type">Bundle</span>?) &#123;</div><div class="line">    <span class="comment">// Swift æ²¡æœ‰ç±»ä¼¼äº Objective-C çš„ NS_UNAVAILABLE æ ‡è®°ï¼Œæ‰€ä»¥ä¸å¸Œæœ›è¢«è°ƒåˆ°çš„åˆå§‹åŒ–æ–¹æ³• fatalError å°±å¥½ã€‚</span></div><div class="line">        <span class="comment">// æ®æˆ‘è§‚å¯Ÿï¼Œåªè¦åˆå§‹åŒ–æ–¹æ³•ä¸­å†™äº† `fatalError`ï¼Œç¼–è¯‘å™¨ä¸ä¼šå¯¹æ­¤æ–¹æ³•æ˜¯å¦è°ƒç”¨å…¶å®ƒåˆå§‹åŒ–æ–¹æ³•åšä»»ä½•æ£€æŸ¥</span></div><div class="line">        <span class="built_in">fatalError</span>()</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="built_in">fatalError</span>(<span class="string">"init(coder:) has not been implemented"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><h2 id="Q-amp-A"><a href="#Q-amp-A" class="headerlink" title="Q&amp;A"></a>Q&amp;A</h2><p>Q: ä¸ºå•¥å†™ä¸ªåˆå§‹åŒ–æ–¹æ³•è¿˜æœ‰è¿™ä¹ˆå¤šè®²ç©¶ï¼Ÿ<br>A: ä¿è¯è°ƒç”¨åˆå§‹åŒ–æ–¹æ³•åï¼Œç”±è¿™ä¸ªç±»å¼•å…¥çš„ property éƒ½æ­£ç¡®åœ°è¢«åˆå§‹åŒ–ï¼Œä»è€Œç¡®ä¿é€»è¾‘æ­£ç¡®ã€‚</p><p>Q: Convenience Initializer åˆ°åº•æœ‰å•¥ç”¨ï¼Ÿ<br>A: å°±æ˜¯ç»™è°ƒç”¨è€…å›¾ä¸ªæ–¹ä¾¿å˜›ã€‚æ¯”å¦‚ Texture ä¸­çš„ ASDisplayNode å°±æä¾›äº† 4 ä¸ª Convenience Initializerï¼Œä¸éœ€è¦åˆå§‹åŒ–ä¹‹åå† <code>node.xxxBlock = ^() {};</code> ï¼Œè€Œæ˜¯æŠŠå¸¸ç”¨çš„ block property åœ¨åˆå§‹åŒ–çš„æ—¶å€™å°±ç»™ä½ äº†ï¼Œå°±æ˜¯ä¸ºäº†æ–¹ä¾¿ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">instancetype</span>)init <span class="built_in">NS_DESIGNATED_INITIALIZER</span>;</div><div class="line">- (<span class="keyword">instancetype</span>)initWithViewBlock:(ASDisplayNodeViewBlock)viewBlock;</div><div class="line">- (<span class="keyword">instancetype</span>)initWithViewBlock:(ASDisplayNodeViewBlock)viewBlock didLoadBlock:(<span class="keyword">nullable</span> ASDisplayNodeDidLoadBlock)didLoadBlock;</div><div class="line">- (<span class="keyword">instancetype</span>)initWithLayerBlock:(ASDisplayNodeLayerBlock)layerBlock;</div><div class="line">- (<span class="keyword">instancetype</span>)initWithLayerBlock:(ASDisplayNodeLayerBlock)layerBlock didLoadBlock:(<span class="keyword">nullable</span> ASDisplayNodeDidLoadBlock)didLoadBlock;</div></pre></td></tr></table></figure><p>Q: çˆ¶ç±»ä¸­çš„ Designated Initializer åœ¨å­ç±»ä¸­è¿˜æ˜¯ Designated Initializer å—ï¼Ÿ<br>A: çˆ¶ç±»ä¸­çš„ Designated Initializer åœ¨å­ç±»ä¸­ä¸ä¸€å®šå¿…é¡»æ˜¯ Designated Initializerã€‚å¦‚æœåœ¨å¤´æ–‡ä»¶ä¸­æ²¡å¯¹æ–¹æ³•è¿›è¡Œä»»ä½•æ ‡è®°ï¼Œé‚£ä¹ˆçˆ¶ç±»ä¸­çš„ Designated Initializer åœ¨å­ç±»ä¸­ä¾æ—§æ˜¯ Designated Initializerï¼Œå¦‚æœåœ¨å­ç±»æ²¡æœ‰è¦†å†™è¿™ä¸ªæ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¼šç»™å‡ºè­¦å‘Šï¼›ä½†å¦‚æœåœ¨å­ç±»ä¸­å¯¹çˆ¶ç±»çš„ Designated Initializer æ ‡è®°ä¸º <code>NS_UNAVAILABLE</code>ï¼Œé‚£ä¹ˆçˆ¶ç±»ä¸­çš„è¿™ä¸ªæ–¹æ³•åœ¨å­ç±»ä¸­ä¸å†æ˜¯ Designated Initializerï¼Œå³ä½¿ä¸è¦†å†™ï¼Œç¼–è¯‘å™¨ä¹Ÿä¸ä¼šæœ‰ä»»ä½•è­¦å‘Šã€‚</p><p>Q: Objective-C ä¸­çš„åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œå¼•ç”¨ propery çš„æ—¶å€™ï¼Œåˆ°åº•è¯¥ä½¿ç”¨ä¸‹åˆ’çº¿çš„æ–¹å¼è¿˜æ˜¯ <code>self.</code> çš„æ–¹å¼ï¼Ÿ<br>A: Prefer <code>_userID</code> to  <code>self.userID</code>ã€‚</p><p>Q: ä¸ºä½•åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­ï¼Œ Swift ç±»çš„å˜é‡éœ€è¦åœ¨è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–æ–¹æ³•ä¹‹å‰åˆå§‹åŒ–ï¼Ÿ<br>A:<br>æ ¹æ®æ–‡æ¡£ï¼Œ</p><blockquote><p>Class initialization in Swift is a two-phase process. In the first phase, each stored property is assigned an initial value by the class that introduced it. Once the initial state for every stored property has been determined, the second phase begins, and each class is given the opportunity to customize its stored properties further before the new instance is considered ready for use.</p></blockquote><p>æ ¹ Objective-C åˆå§‹åŒ–ä¸åŒçš„åœ°æ–¹åœ¨ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯æŠŠæ­¤ç±»åŠ å…¥çš„ property éƒ½åˆå§‹åŒ–æ‰ã€‚å› ä¸º Swift å¹¶ä¸ä¼šåƒ Objective-C ä¸€æ ·ï¼Œåœ¨æ²¡æœ‰æ˜¾å¼åˆå§‹åŒ–è¿™äº› property çš„æ—¶å€™ï¼Œè‡ªåŠ¨æŠŠå®ƒä»¬è®¾ä¸º <code>nil</code> æˆ– <code>0</code>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­è§£é‡Šä¸‹ä¸Šé¢çš„æƒ…å†µã€‚æ–°æ‰‹å†™ Swift é€šå¸¸ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œ</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170716161322_RSMqFj_Screenshot.png" alt=""></p><p>ç¼–è¯‘å™¨æŠ±æ€¨ <code>userID</code> éœ€è¦åœ¨ <code>super.init</code> ä¹‹å‰è¢«åˆå§‹åŒ–ï¼Œå°±æ˜¯å› ä¸º <code>userID</code> æ²¡æœ‰é»˜è®¤å€¼ï¼Œå¦‚æœåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¿˜æ²¡ç»™å®ƒæä¾›å€¼ï¼Œé‚£å°±ä¼šäº§ç”Ÿé—®é¢˜äº†(ä»ç¼–è¯‘å™¨çš„è§’åº¦æ¥çœ‹ï¼Œåˆå§‹åŒ–çš„æ—¶å€™éœ€è¦ç¡®ä¿æ‰€æœ‰ property éƒ½ç¡®è®¤æœ‰å€¼(nil ä¹Ÿç®—ç¡®è®¤æœ‰å€¼)ã€‚ä½†ä½ ç°åœ¨å¹¶æ²¡æœ‰å‘Šè¯‰æˆ‘å®ƒçš„å€¼æ˜¯ä»€ä¹ˆã€‚ )å¯æ˜¯ç¼–è¯‘å™¨ä¸ºä½•æ²¡æœ‰æŠ±æ€¨ <code>gender</code> å’Œ <code>age</code> å‘¢ï¼Ÿå› ä¸ºå®ƒä»¬éƒ½æœ‰é»˜è®¤å€¼ï¼ˆoptional åœ¨é»˜è®¤çš„æƒ…å†µä¸‹ä¸º nilï¼‰ã€‚</p><p>Q: ä¸ºä»€ä¹ˆæ¯æ¬¡åˆ›å»º Swift UIViewController å­ç±»ï¼Œåªè¦æ·»åŠ äº†ä»»ä½•ä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³•ï¼ŒXcode éƒ½ä¼šæé†’è¦æ·»åŠ  <code>required init?(coder:)</code> æ–¹æ³•ï¼Ÿ<br>A: å› ä¸º UIViewController ç¬¦åˆäº† <code>NSCoding</code> åè®®ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªæ–¹æ³•æ˜¯ Designated Initializerï¼Œå­ç±»å¿…é¡»è¦å®ç°è¿™ä¸ªåè®®çš„åˆå§‹åŒ–æ–¹æ³•ã€‚</p><p>Q: ä¸€ä¸ªç±»å¯èƒ½ä¼šæœ‰å¤šä¸ª Designated Initializer å—ï¼Ÿ<br>A: å¯èƒ½ã€‚æ¯”å¦‚ <code>NSArray</code> å°±æœ‰ä¸‰ä¸ªã€‚ä½†ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯åªæœ‰ä¸€ä¸ªã€‚</p><p>ä¸Šé¢åªæ˜¯ä¸€äº›æˆ‘è‡ªå·±çš„å›°æƒ‘ï¼Œå¦‚æœä½ ä¹Ÿæœ‰å›°æƒ‘ï¼Œæ¬¢è¿ç•™è¨€ã€‚</p><p>è¿™ä¸‹åº”è¯¥å¯ä»¥å¼€å¼€å¿ƒå¿ƒåœ°å†™ Initializer äº†å§ :]</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå†™ Initializer åº”è¯¥æ˜¯æ—¥å¸¸ã€‚ä¼šå†™çš„å¯ä»¥ç›´æ¥ä¸çœ‹ã€‚å¦‚æœæ²¡æœ‰å¥½å¥½äº†è§£è¿‡å¦‚ä½•å†™ Initializerï¼Œæ¯æ¬¡éƒ½å‡­ç€æ„Ÿè§‰å†™è€Œä¸”è¿˜æ²¡æœ‰ä»»ä½•é—®é¢˜ï¼Œè¯´æ˜å…¶ä¸­çš„ã€Œç„æœºã€ä½ å·²ç»æŒæ¡äº†ï¼Œå¯ä»¥å¤§æ¦‚æ‰«ä¸€æ‰«ã€‚ä½†æ˜¯æ¯æ¬¡å†™ Initializer éƒ½è¦æŸ¥ Googleï¼Œé‚£è¿™ç¯‡æ–‡ç« 
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Objective-C" scheme="http://zhaoxinyu.me/tags/Objective-C/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Kickstarter-iOS æºç ä¸­å­¦åˆ°çš„ï¼ˆäºŒï¼‰ - ä»£ç </title>
    <link href="http://zhaoxinyu.me/2017-07-09-ios-oss-2/"/>
    <id>http://zhaoxinyu.me/2017-07-09-ios-oss-2/</id>
    <published>2017-07-09T02:19:33.000Z</published>
    <updated>2017-11-14T05:33:57.906Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸Šä¸€æ¬¡æˆ‘ä»¬ç®€å•ä»‹ç»äº†ä¸€ä¸‹ Kickstarter-iOS é¡¹ç›®å·¥ç¨‹æ–¹é¢çš„é—ªå…‰ç‚¹ï¼Œè¿™æ¬¡æˆ‘ä»¬æ¢ç©¶ä¸€ä¸‹ï¼Œçœ‹çœ‹åˆ°åº•æ˜¯å“ªäº›è®¾è®¡ä¸ç»†èŠ‚è®©æˆ‘æ¨èå¤§å®¶éƒ½æ¥é˜…è¯»è¿™ä»½ä»£ç ã€‚</p><h3 id="Environment"><a href="#Environment" class="headerlink" title="Environment"></a>Environment</h3><blockquote><p><a href="https://github.com/kickstarter/ios-oss/blob/master/Library/Environment.swift" target="_blank" rel="external">Environment.swift</a></p></blockquote><p><code>Environment</code> è¿™ä¸ª <code>sruct</code> è¿™ä½œä¸ºä¸€ä¸ªå­˜å‚¨æ•´ä¸ªåº”ç”¨çŠ¶æ€çš„å­˜åœ¨ã€‚é‚£è¿™ä¸ªåº”ç”¨å¯ä»¥éšæ—¶è·å–çš„å…¨å±€çŠ¶æ€éƒ½æœ‰ä»€ä¹ˆå‘¢ï¼Ÿ</p><ul><li>API ç¯å¢ƒ<ul><li><code>apiService</code>ï¼ŒåŒ…æ‹¬äº† <code>appID</code>ï¼Œ<code>apiBaseUrl</code> ç­‰ç­‰ã€‚è¿™é‡Œä¹‹æ‰€ä»¥æŠŠå®ƒç®—è¿› <code>Environment</code> æ˜¯å› ä¸ºåœ¨æµ‹è¯•ç¯å¢ƒä¸­ï¼Œ<code>apiService</code> å¯èƒ½ä¼šå‘ç”Ÿæ”¹å˜ã€‚</li></ul></li><li>ç¼“å­˜<ul><li><code>cache</code>ï¼Œä¸€ä¸ª <code>NSCache</code> ç¼“å­˜ä¸€äº›ä¸´æ—¶çš„æ•°æ®</li><li><code>ubiquitousStore</code>ï¼ŒèƒŒåæ˜¯ä¸€ä¸ª <code>NSUbiquitousKeyValueStore.default</code>ï¼Œç”¨äºæ”¾ä¸€äº›æœ‰æ²¡æœ‰å‡ºç°å¼•å¯¼ç›¸å…³çš„ flagï¼Œæ˜¯ iCloud åŒæ­¥çš„</li><li><code>userDefaults</code>ï¼Œå…¶å®å°±æ˜¯ UserDefaultsï¼Œç”¨äºæŒä¹…åŒ–æ•°æ®</li></ul></li><li>è®¾å¤‡<ul><li><code>devie</code>ï¼Œè®¾å¤‡å‹å·ã€ç³»ç»Ÿç‰ˆæœ¬ç­‰ç­‰</li><li><code>countryCode</code>, <code>language</code>, <code>locale</code>,  ä¸€äº›è®¾å¤‡å›½é™…åŒ–çš„ä¿¡æ¯</li><li><code>reachability</code>ï¼Œå½“å‰è®¾å¤‡çš„ç½‘ç»œç¯å¢ƒ</li></ul></li><li>å½“å‰ç™»å½•ç”¨æˆ·<ul><li><code>currentUser</code></li></ul></li></ul><p>â€¦ ç­‰ç­‰</p><p>é‚£æ˜¯ä¸æ˜¯åªè¦ <code>AppDelegate</code> æŒæœ‰ä¸€ä¸ª <code>Environment</code> çš„å®ä¾‹å°±å¯ä»¥å®Œæˆä»»åŠ¡äº†å‘¢ï¼Ÿ</p><p>æ˜¯ä¹Ÿä¸æ˜¯ã€‚</p><p>å…¶å®ä½œä¸ºä¸€ä¸ªåº”ç”¨æ¥è¯´ï¼Œä¸€ä»½ <code>Environment</code> å°±è¶³ä»¥å®Œæˆä»»åŠ¡äº†ï¼Œä½† Kickstarter ä¸ºäº†æ–¹ä¾¿ testï¼Œæå‡ºäº†ä¸€ä¸ª <code>AppEnvironment</code>ã€‚</p><h4 id="AppEnvironment"><a href="#AppEnvironment" class="headerlink" title="AppEnvironment"></a>AppEnvironment</h4><blockquote><p><a href="https://github.com/kickstarter/ios-oss/blob/master/Library/AppEnvironment.swift" target="_blank" rel="external">AppEnvironment.swift</a></p></blockquote><div style="width:60%"><img src="http://oo8znht6g.bkt.clouddn.com/20170713223902_VZc8mv_Screenshot.png" alt=""></div><p>å¦‚å›¾ï¼Œ<code>AppEnvironment</code> æŒæœ‰äº†ä¸€ä¸ª <code>stack: [Environment]</code>ï¼Œå…¶å®åŒæ—¶å­˜è¿™ä¹ˆå¤š <code>Environment</code> æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚å¯¹äºåŒä¸€ä¸ªåº”ç”¨æ¥è¯´ï¼Œä¸€ä¸ª <code>Environment</code> å°±å¤Ÿäº†ï¼Œé‚£ä¸ºä»€ä¹ˆå®ƒè¿˜è¦æè¿™ä¹ˆå¤šå‡ºæ¥å‘¢ï¼Ÿ</p><p>æœç´¢ä¸€ä¸‹ <code>AppEnvironment</code> ä¸­ <code>pushEnvironment</code> å’Œ <code>popEnvironment</code> æ–¹æ³•çš„è°ƒç”¨ï¼Œå‡ ä¹éƒ½ä¼šå‡ºç°åœ¨ <code>*Test.swift</code> ä¸­ã€‚ä¸»è¦ä½œç”¨æ˜¯æµ‹è¯• <code>Environment</code> å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä¿ç•™æ—§çš„ <code>Environment</code> åšä¸€äº› state çš„åˆ¤æ–­ã€‚</p><p>è¿™ä¸ª struct è¿˜æä¾›äº†ä¸€ä¸ªä¾¿æ·çš„ <code>replaceCurrentEnvironment</code> æ–¹æ³•ï¼Œæ ¹æ®ä½ æä¾›çš„æƒ³è¦æ›´æ”¹çš„å€¼ï¼Œupdate ä¸€ä¸‹ current çš„ environmentï¼ˆå…¶å® <code>push</code> ä¹Ÿæ˜¯åŒç†ï¼ŒæŠŠ current å…ˆ copy ä¸€ä»½ï¼Œå†æ”¹éœ€è¦æ›´æ–°çš„éƒ¨åˆ†ï¼‰ã€‚è¿™ä¸ªæ–¹æ³•å°±æ¯”è¾ƒæœ‰ä»·å€¼äº†ã€‚æ¯”å¦‚åœ¨ debug çš„æ—¶å€™ï¼Œå¯ä»¥æŠŠ <code>apiService</code> æ¢æˆ <code>mockService</code>ï¼Œæµ‹è¯•çš„æ—¶å€™ï¼Œç›´æ¥æ›´æ–° <code>user</code> ä¸ºä¸€ä¸ª fake userï¼Œå°±ç›´æ¥ç™»å½•æˆåŠŸäº†ï¼Œéå¸¸æ–¹ä¾¿ã€‚</p><p>å…³äº Environment çš„è®¾è®¡ï¼Œæˆ‘æ˜¯æ¯”è¾ƒè®¤å¯çš„ã€‚ç›¸æ¯”äºå…¨å±€çš„ <code>state</code> æ»¡å¤©é£ï¼Œè¿™ç§å°è£…ä¼šè®©ç¨‹åºå¹²å‡€ä¸å°‘ã€‚AppEnvironment ä¸­çš„ stack å¦‚æœåªæ˜¯ç”¨æ¥æµ‹è¯•çš„è¯å…¶å®å®Œå…¨æ²¡æœ‰å¿…è¦å­˜åœ¨ï¼Œç¬¬ä¸€çœ¼çœ‹ä¸Šå»æœ‰å¤šä¸ª <code>environment</code> çœ‹ä¸Šå»æœ‰äº› confusingï¼Œä¸è¿‡å®ƒæ˜¯ <code>fileprivate</code>ï¼Œå…¶å®ä¹Ÿæ²¡å•¥ï¼Œæ˜¯å§ï¼Ÿ</p><h3 id="Deep-Linking"><a href="#Deep-Linking" class="headerlink" title="Deep Linking"></a>Deep Linking</h3><blockquote><p><a href="https://github.com/kickstarter/ios-oss/blob/master/Library/Navigation.swift" target="_blank" rel="external">Navigation.swift</a></p></blockquote><p>iOS ä¸­çš„ deep linking å°±æ˜¯é€šè¿‡ URL Schemeã€Universal Linkã€3D touch æˆ–è€… notification ç­‰ URL çš„æ–¹å¼è·³è½¬åŸç”Ÿé¡µé¢çš„æ–¹å¼ã€‚</p><p>objc.io é‡Œä¹Ÿæœ‰ä¸€æœŸå…³äº Kickstarter æ˜¯å¦‚ä½•åš deep linking çš„ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥çœ‹ä¸€ä¸‹ã€‚<a href="https://talk.objc.io/episodes/S01E49-deep-linking-at-kickstarter" target="_blank" rel="external">é“¾æ¥ç‚¹æˆ‘</a></p><p>å·¥ç¨‹é‡Œçš„å®ç°è·Ÿè§†é¢‘é‡Œçš„æ–¹æ¡ˆå·®ä¸å¤šã€‚æœ‰ä¸€ä¸ª Navigation çš„ enumï¼ŒæŠŠæ‰€æœ‰æ”¯æŒé€šè¿‡ URL è·³è½¬çš„éƒ½å®šä¹‰æˆä¸€ä¸ª caseï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Navigation</span> </span>&#123;</div><div class="line">  <span class="keyword">case</span> checkout(<span class="type">Int</span>, <span class="type">Navigation</span>.<span class="type">Checkout</span>)</div><div class="line">  <span class="keyword">case</span> emailClick(qs: <span class="type">String</span>)</div><div class="line">  <span class="keyword">case</span> emailLink</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Navigation å­˜åœ¨çš„æ„ä¹‰ï¼Œæ˜¯æ˜¯æŠŠä¸€ä¸ªé€šè¿‡ deep link æ–¹å¼ä¼ å…¥çš„ URLï¼Œè§£ææˆä¸€ä¸ª Navigation çš„ case</p><p>é‚£å®ƒæ˜¯æ€ä¹ˆå®ç°è¿™ä¸ªè¿‡ç¨‹çš„å‘¢ï¼Ÿ</p><p><code>allRoutes</code> ä¸­å®šä¹‰å‡ºæ‰€æœ‰æ”¯æŒ deep linking çš„ URL æ¨¡æ¿ï¼Œä»¥åŠå®ƒä»¬å¯¹åº”çš„è§£æå‡½æ•°ï¼Œæ„æˆä¸€ä¸ª route æ¡ç›®æ•°ç»„</p><p>æš´éœ²ç»™å¤–é¢è§£æ URL çš„å…¥å£æ˜¯ <code>match(_ url: URL)</code></p><p>è¿™ä¸ªå‡½æ•°é¦–å…ˆéå† <code>allRoutes</code> ä¸­çš„æ‰€æœ‰æ¡ç›®ï¼Œå°è¯•æŠŠè¿™äº› URL ä¸ <code>allRoutes</code> ä¸­çš„ URL æ¨¡æ¿åŒ¹é… (1)</p><p>æ¨¡æ¿åŒ¹é…ä¸Šäº†ï¼Œæ ¹æ®æ¨¡æ¿ä¸­å‚æ•°çš„éƒ¨åˆ†æŠŠåŸæœ‰ URL çš„å‚æ•°å–å‡ºæ¥ï¼Œæ„æˆä¸€ä¸ªå‚æ•°åä¸º keyï¼Œå‚æ•°å€¼ä¸º value çš„ <code>[String:RouteParams]</code>(2)(3)</p><p>ç„¶åæŠŠè¿™ä¸ªå­—å…¸ä¼ å…¥ route æ¡ç›®å¯¹åº”çš„è§£æå‡½æ•°(4)ï¼Œå°±å¯ä»¥é¡ºåˆ©å¾—åˆ°æˆ‘ä»¬æƒ³è¦çš„ <code>Navigation</code> æšä¸¾äº†(5)ï¼Œæ ¹æ®è¿™äº›ç¡®å®šçš„æšä¸¾ï¼Œå°±å¯ä»¥åšå‡ºè·³è½¬äº†ã€‚</p><p>Deep link å†™å¾—ç‰¹åˆ«å‡ºå½©çš„åœ°æ–¹æ˜¯å®ƒçš„å¾ˆå¤šä»£ç éå¸¸åœ°å‡½æ•°å¼ï¼Œå…¶å®è§£æçš„ä»£ç ä¹Ÿéå¸¸é€‚åˆå†™æˆå‡½æ•°å¼åœ°ã€‚<code>map</code> <code>reduce</code> <code>zip</code> å†<br>ç»“åˆæ“ä½œç¬¦é‡è½½ï¼Œä»£ç å¯è¯»æ€§é«˜ï¼Œè€Œä¸”å¹²å‡€ï¼Œé˜…è¯»èµ·æ¥ä»¤äººæ„‰æ‚¦ã€‚</p><p>å¯ä»¥ç»“åˆå›¾çœ‹ä¸€ä¸‹ deep link çš„è¿‡ç¨‹</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170713223830_TVnt2N_Screenshot.png" alt=""><br>ç°åœ¨å†å›å¤´çœ‹çœ‹ä»£ç ï¼Œåº”è¯¥æ˜¯å¾ˆæ¸…æ™°äº†ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;ä¸Šä¸€æ¬¡æˆ‘ä»¬ç®€å•ä»‹ç»äº†ä¸€ä¸‹ Kickstarter-iOS é¡¹ç›®å·¥ç¨‹æ–¹é¢çš„é—ªå…‰ç‚¹ï¼Œè¿™æ¬¡æˆ‘ä»¬æ¢ç©¶ä¸€ä¸‹ï¼Œçœ‹çœ‹åˆ°åº•æ˜¯å“ªäº›è®¾è®¡ä¸ç»†èŠ‚è®©æˆ‘æ¨èå¤§å®¶éƒ½æ¥é˜…è¯»è¿™ä»½ä»£ç ã€‚&lt;/p&gt;
&lt;h3 id=&quot;Environment&quot;&gt;&lt;a href=&quot;#Environment&quot; class=&quot;heade
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>åœ¨ Kickstarter-iOS æºç ä¸­å­¦åˆ°çš„ï¼ˆä¸€ï¼‰ - å·¥ç¨‹ç›¸å…³</title>
    <link href="http://zhaoxinyu.me/2017-07-08-ios-oss-1/"/>
    <id>http://zhaoxinyu.me/2017-07-08-ios-oss-1/</id>
    <published>2017-07-08T02:19:33.000Z</published>
    <updated>2017-07-09T06:19:36.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…¶å®åœ¨ Kickstarter åˆšå¼€æºä»–ä»¬å®¢æˆ·ç«¯æºç çš„æ—¶å€™ï¼Œæˆ‘å°±ä» GitHub çš„ trends é‡Œçœ‹åˆ°äº†ã€‚ä½œä¸ºä¸€ä¸ªå®ç”¨ä¸»ä¹‰è€…ï¼Œæ‚„æ‚„ç‚¹äº†ä¸ª star å°±èµ°æ‰äº†ã€‚</p><p>åæ¥åœ¨ <a href="objc.io">ObjC.io</a> ä¸Šçš„è¿™ä¸ª <a href="https://talk.objc.io/episodes/S01E47-view-models-at-kickstarter" target="_blank" rel="external">talk</a> é‡Œï¼Œæˆ‘çœ‹åˆ°äº† Kickstarter çš„å·¥ç¨‹å¸ˆ <a href="https://twitter.com/mbrandonw" target="_blank" rel="external">Brandon Williams</a> ä»‹ç»äº†ä»–ä»¬åœ¨å®¢æˆ·ç«¯ä¸­å¤§é‡ä½¿ç”¨ ViewModel çš„ç»å†ï¼Œè€Œä¸”åœ¨è§†é¢‘é‡Œç”¨ ViewModel é‡æ„äº†ä¸€æ®µä»£ç ã€‚å½“æ—¶æˆ‘å¯¹ MVVM æ¯”è¾ƒè¿·ï¼Œå°±æŠ±ç€è¯•è¯•çœ‹çš„å¿ƒæ€ <code>clone</code> äº†ä¸€ä¸‹ä»–ä»¬çš„<a href="https://github.com/kickstarter/ios-oss" target="_blank" rel="external">å®¢æˆ·ç«¯æºç </a>ï¼Œçœ‹è¿‡äº†ä¹‹åæˆ‘åªæƒ³è¯´ï¼Œä¸ºä»€ä¹ˆæˆ‘æ²¡æœ‰æ—©ç‚¹çœ‹å®ƒçš„ä»£ç ï¼</p><h3 id="ä¾èµ–ç®¡ç†"><a href="#ä¾èµ–ç®¡ç†" class="headerlink" title="ä¾èµ–ç®¡ç†"></a>ä¾èµ–ç®¡ç†</h3><p>ç¬¬ä¸€çœ¼çœ‹åˆ°ä»–ä»¬çš„ä»£ç ï¼Œæ˜¯ä½¿ç”¨çš„ <code>git submodule</code> æ¥ç®¡ç†ä¾èµ–å…³ç³»çš„ã€‚å…¶å®ä¾èµ–çš„åº“å¹¶ä¸æ˜¯å¾ˆå¤šï¼Œæ‰€ä»¥è¿™ä¹ˆç®¡ç†ä¹Ÿæ²¡æœ‰ä»€ä¹ˆç—›ç‚¹ã€‚è™½ç„¶æ¯” Cocoapods ç®¡ç†èµ·æ¥éº»çƒ¦äº†ä¸€ç‚¹ï¼Œä½†æ˜¯èƒ½å¯¹äºä¾èµ–çš„ä¸œè¥¿æœ‰å®Œæ•´çš„æŠŠæ§èƒ½åŠ›ï¼Œä¹Ÿç®—æ˜¯ä¸€ä¸ªä¼˜ç‚¹å§ã€‚ä¸è¿‡ç”¨ submodule éœ€è¦å›¢é˜Ÿé‡Œçš„æˆå‘˜å¯¹ submodule éƒ½æœ‰ä¸€å®šçš„äº†è§£ï¼Œå¦åˆ™å¯èƒ½å°±ä¼šä¸€å›¢ç³Ÿäº†ã€‚</p><p>å…³äº git submodules, Cocoapods å’Œ Carthage ç®¡ç†ä¾èµ–å…³ç³»çš„ä¼˜åŠ£<a href="https://medium.com/real-life-programming/carthage-vs-cocoapods-vs-git-submodules-9dc341ec6710" target="_blank" rel="external">è¿™ç¯‡æ–‡ç« </a>é‡Œè¯´å¾—å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘å°±ä¸å†èµ˜è¿°äº†ï¼Œé€‚åˆè‡ªå·±çš„æ‰æ˜¯æœ€å¥½çš„ã€‚</p><h3 id="Makefile"><a href="#Makefile" class="headerlink" title="Makefile"></a>Makefile</h3><p>çœ‹åˆ° README ä¸­çš„ Getting Started ä¸­è®²åˆ°ï¼Œclone repo ä¹‹åï¼Œåªè¦æ‰§è¡Œ <code>make bootstrap</code> å°±å¯ä»¥å®‰è£…å·¥å…·å’Œç›¸å…³ä¾èµ–äº†ã€‚</p><p>ä¸å¾—ä¸è¯´è¿™ä¸ªæ€è·¯å¾ˆå¥½ï¼Œç”¨ make æ¥ç®¡ç†å’Œè¿è¡Œä¸é¡¹ç›®ç›¸å…³çš„ä¸€äº›æ“ä½œï¼Œå¦‚æœåŠ äº†ä¸€é¡¹ä¸å·¥ç¨‹ç›¸å…³çš„æ“ä½œæ¯”å¦‚ testã€ buildï¼Œç›´æ¥åœ¨ make é‡ŒåŠ ä¸€æ¡å¯¹åº”çš„å°±å¥½ï¼Œæ¸…æ™°åˆç›´è§‚ã€‚ç¬¬ä¸€æ¬¡æ‹¿åˆ°é¡¹ç›®çš„äººä¸€çœ¼å°±çŸ¥é“äº†æ‰€æœ‰çš„å‘½ä»¤ <del>ä¸ç”¨åƒæˆ‘å¸çš„å®¢æˆ·ç«¯ä¸€æ ·ï¼Œè„šæœ¬é£å¾—åˆ°å¤„éƒ½æ˜¯ï¼Œæƒ³è¿è¡Œå•¥éƒ½å¾—æ‰¾åŠå¤©</del></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">build: dependencies</div><div class="line">$(XCODEBUILD) $(BUILD_FLAGS) $(XCPRETTY)</div><div class="line"></div><div class="line">test-all:</div><div class="line">PLATFORM=iOS &quot;$(MAKE)&quot; test</div><div class="line">PLATFORM=iOS TARGET=Library &quot;$(MAKE)&quot; test</div><div class="line"></div><div class="line">test: bootstrap</div><div class="line">$(XCODEBUILD) test $(BUILD_FLAGS) $(XCPRETTY)</div><div class="line"></div><div class="line">clean:</div><div class="line">$(XCODEBUILD) clean $(BUILD_FLAGS) $(XCPRETTY)</div><div class="line"></div><div class="line">dependencies: submodules configs secrets opentok</div><div class="line"></div><div class="line">bootstrap: hooks dependencies</div><div class="line">brew update || brew update</div><div class="line">brew unlink swiftlint || true</div><div class="line">brew install swiftlint</div><div class="line">brew link --overwrite swiftlint</div><div class="line"></div><div class="line">submodules:</div><div class="line">git submodule sync --recursive || true</div><div class="line">git submodule update --init --recursive || true</div></pre></td></tr></table></figure><h3 id="å‡ ä¸ªæ–¹ä¾¿çš„-Swift-è„šæœ¬"><a href="#å‡ ä¸ªæ–¹ä¾¿çš„-Swift-è„šæœ¬" class="headerlink" title="å‡ ä¸ªæ–¹ä¾¿çš„ Swift è„šæœ¬"></a>å‡ ä¸ªæ–¹ä¾¿çš„ Swift è„šæœ¬</h3><p>å…¶å®å®¢æˆ·ç«¯çš„é¢œè‰²å’Œæœ¬åœ°åŒ–å­—ç¬¦ä¸²ç®¡ç†ä¸€å‘æ˜¯å¼€å‘ä¸­çš„ç—›ç‚¹ã€‚è€Œåœ¨ä»–ä»¬çš„å®¢æˆ·ç«¯ä¸­ï¼Œæˆ‘çœ‹åˆ°äº†ä¸¤ä¸ª swift æ–‡ä»¶ï¼Œå°±æ˜¯ä¸“é—¨è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚</p><p>ä»–ä»¬è‰²è¡¨æ˜¯ä¸€ä¸ª <code>Colors.json</code> æ–‡ä»¶ï¼Œæ”¾åœ¨ä¸€ä¸ª Design çš„ç›®å½•é‡Œï¼ŒDesign é‡Œé¢è¿˜æœ‰ä»–ä»¬å…¨éƒ¨è®¾è®¡çš„ Sketch æ–‡ä»¶ï¼Œä¸å¾—ä¸è¯´å¾ˆè‰¯å¿ƒã€‚æœ‰ä¸€ä¸ª <code>colors</code> çš„ Swift è„šæœ¬ï¼Œä¸“é—¨æŠŠè‰²è¡¨ parse æˆä¸€ä¸ª <code>Colors.swift</code> æ–‡ä»¶ï¼Œè°ƒç”¨è€…åªéœ€è¦ <code>UIColor.ksr_green_400</code> å°±å¯ä»¥å–åˆ°é¢œè‰²äº†ã€‚è¿™ç§è‰²è¡¨ç®¡ç†é¢œè‰²çš„æ–¹å¼åº”è¯¥å€¼å¾—æ¯ä¸€ä¸ªå®¢æˆ·ç«¯çš„å¼€å‘è€…å­¦ä¹ ã€‚è®¾è®¡å¸ˆè´Ÿè´£ç®¡ç†è‰²è¡¨ï¼Œè€Œè„šæœ¬è´Ÿè´£ç”Ÿæˆä»£ç ã€‚å’Œè¿™æ ·ç›¸æ¯”ï¼Œç›´æ¥åœ¨ä»£ç é‡Œå†™é¢œè‰²çš„ç¡®ä¸æ–¹ä¾¿å¤ªå¤šã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIColor</span> </span>&#123;</div><div class="line">  <span class="comment">/// 0x07565F</span></div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">var</span> ksr_forest_600: <span class="type">UIColor</span> &#123;</div><div class="line">    <span class="keyword">return</span> .hex(<span class="number">0x07565F</span>)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å†å°±æ˜¯ <code>localizedString</code> äº†ï¼Œåšè¿‡å›½é™…åŒ–çš„åŒå­¦ä»¬ä¸€å®šéƒ½äº†è§£ï¼ŒiOS çš„ <code>localizedString</code> å¤ªéš¾ç”¨äº†ï¼Œéš¾ç”¨åˆ°æ— æ³•ç†è§£ã€‚è€Œé¡¹ç›®é‡Œçš„ <code>strings.swift</code> å°±å®Œç¾åœ°è§£å†³äº†è¿™ä»¶äº‹æƒ…ã€‚å®ƒä¼š parse å·¥ç¨‹ä¸­çš„ <code>Localizable.strings</code> æ–‡ä»¶ï¼Œç”Ÿæˆå¯¹åº”çš„ <code>Strings.swift</code>ï¼Œé‡Œé¢å°±æœ‰æ‰€æœ‰çš„æœ¬åœ°åŒ–å­—ç¬¦ä¸²æ–¹æ³•ï¼Œè€Œä¸”è¿˜æœ‰å¯¹åº”çš„æç¤ºã€‚å†ä¹Ÿä¸æ€•æœ¬åœ°åŒ–äº†ï¼<del>å…¶å®çŸ¥ä¹ä¹Ÿåšè¿‡ç±»ä¼¼çš„ä¸œè¥¿ï¼Œåªä¸è¿‡è„šæœ¬ä¸æ˜¯ç”¨ Swift å†™çš„</del></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Strings</span> </span>&#123;</div><div class="line">  <span class="comment">/**</span></div><div class="line"><span class="comment">   "About %&#123;reward_amount&#125;"</span></div><div class="line"><span class="comment"></span></div><div class="line"><span class="comment">   - **es**: "Aprox. %&#123;reward_amount&#125;"</span></div><div class="line"><span class="comment">   - **de**: "UngefÃ¤hr %&#123;reward_amount&#125;"</span></div><div class="line"><span class="comment">   - **fr**: "Environ %&#123;reward_amount&#125;"</span></div><div class="line"><span class="comment">   - **en**: "About %&#123;reward_amount&#125;"</span></div><div class="line"><span class="comment">  */</span></div><div class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">About_reward_amount</span><span class="params">(reward_amount: String)</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">    <span class="keyword">return</span> localizedString(</div><div class="line">      key: <span class="string">"About_reward_amount"</span>,</div><div class="line">      defaultValue: <span class="string">"About %&#123;reward_amount&#125;"</span>,</div><div class="line">      <span class="built_in">count</span>: <span class="literal">nil</span>,</div><div class="line">      substitutions: [<span class="string">"reward_amount"</span>: reward_amount]</div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">  ...</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Pull-request-æµç¨‹"><a href="#Pull-request-æµç¨‹" class="headerlink" title="Pull request æµç¨‹"></a>Pull request æµç¨‹</h3><p>åœ¨ push ä»£ç ä¹‹å‰ï¼Œä¼šæœ‰ä¸€ä¸ª git hook æ¥æ‰§è¡Œ swiftlintï¼Œæ¥ä¿è¯ä»£ç ç¬¦åˆè§„èŒƒå¹¶ä¸”é¿å…ä¸€äº›ä½çº§çš„é”™è¯¯ã€‚</p><p>æœ‰ä»£ç å°±æœ‰æµ‹è¯•æ˜¯å¿…é¡»çš„ <del>è¿™ä¸€ç‚¹å¯ä»¥ç§’æ€å¤§å¤šæ•°åšå®¢æˆ·ç«¯çš„å…¬å¸äº†å§</del></p><p>åœ¨ææ¯ä¸ª pull request çš„æ—¶å€™ï¼Œä½œè€…éƒ½éœ€è¦è¯´æ˜åšäº†ä»€ä¹ˆï¼Œå¹¶ä¸”ä¸ºä»€ä¹ˆè¿™ä¹ˆåšï¼Œè¿™ä¸ª PR æ”¹äº†å“ªé‡Œï¼Œæˆªå›¾å¤§æ¦‚é•¿ä»€ä¹ˆæ ·å­ç­‰ç­‰ï¼Œå¯ä»¥å‚è€ƒä¸€ä¸‹<a href="https://github.com/kickstarter/ios-oss/pull/107" target="_blank" rel="external">è¿™ä¸ª</a>ã€‚</p><p>è€Œæ¯ä¸ª reviewer éƒ½ä¼šæå‡ºå¾ˆå¤šæ„è§ã€‚</p><h3 id="ä¸°å¯Œçš„æµ‹è¯•"><a href="#ä¸°å¯Œçš„æµ‹è¯•" class="headerlink" title="ä¸°å¯Œçš„æµ‹è¯•"></a>ä¸°å¯Œçš„æµ‹è¯•</h3><p>è¿™é‡Œçš„æµ‹è¯•ä¸å…‰æŒ‡å‡ ä¹å®Œæ•´è¦†ç›–çš„ Unit Testï¼Œè¿˜æœ‰å‡ ä¹å®Œæ•´çš„ UI Testã€‚</p><p>é¡¹ç›®ä¸­ä½¿ç”¨ <a href="https://github.com/facebook/ios-snapshot-test-case" target="_blank" rel="external">ios-snapshot-test-case</a> æ¥åš UI Testï¼Œå®ƒä¼šå°†é¡¹ç›®é‡Œå¤§éƒ¨åˆ†ç•Œé¢é…åˆ mock æ•°æ®ç”Ÿæˆæˆªå›¾ä¿å­˜åœ¨ Screenshots æ–‡ä»¶å¤¹é‡Œã€‚ æ¯æ¬¡æäº¤ PR ä¹‹å‰ï¼Œéƒ½è¦è·‘è¿™äº›æµ‹è¯•ï¼Œä¸€æ—¦å›¾ç‰‡å‘ç”Ÿå˜åŒ–ï¼ŒPR çš„ diff é‡Œå°±ä¼šæ˜¾ç¤ºè¿™äº›å˜åŒ–ï¼Œreviewer ä¸€çœ¼å°±å¯ä»¥çœ‹å¾—å‡ºä½ çš„ä»£ç åˆ°åº•æ”¹äº†å“ªé‡Œï¼ŒçœŸæ˜¯éå¸¸æ–¹ä¾¿ã€‚</p><h3 id="è§„èŒƒçš„-commit-message"><a href="#è§„èŒƒçš„-commit-message" class="headerlink" title="è§„èŒƒçš„ commit message"></a>è§„èŒƒçš„ commit message</h3><p>å‡ ä¹æ¯ä¸€æ¡ commit éƒ½ä¼šå¸¦ä¸Šä¸€ä¸ª task çš„ idï¼Œè€Œä¸”åŒä¸€ä¸ª task çš„å¤šä¸ª commit åœ¨ merge çš„æ—¶å€™ä¼š squashï¼Œéå¸¸æ•´æ´ã€‚å¦‚æœä¸çŸ¥é“æ€ä¹ˆå†™ commit message å¯ä»¥å‚è€ƒæˆ‘çš„è¿™ä¸€ç¯‡<a href="https://zhaoxinyu.me/2017-01-04-how-to-write-good-commit-message/">åšæ–‡</a></p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170708002521_8ZHaih_Screenshot.jpeg" alt=""></p><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>è¿™ç¯‡æ–‡ç« åªæ˜¯æŠ›ç –å¼•ç‰ï¼Œæˆ‘å¯èƒ½åªçœ‹åˆ°äº†è¿™ä¸ªå®¢æˆ·ç«¯æºç å·¥ç¨‹æ–¹é¢çš„å†°å±±ä¸€è§’ï¼Œè¿˜å¸Œæœ›å¤§å®¶åœ¨æœ‰ç»å†çš„æƒ…å†µä¸‹ä¹Ÿå»çœ‹çœ‹ä»–ä»¬å®¢æˆ·ç«¯çš„ä»£ç ã€‚å…¶å®å·¥ä½œç»éªŒçš„ç§¯ç´¯å®Œå…¨ä¸éœ€è¦æ¢å…¬å¸æ¥è§£å†³ã€‚å¦‚æœä½ æœ‰å¿ƒï¼ŒGitHub ä¸Šæœ‰å¤§é‡çš„å¼€æºå®¢æˆ·ç«¯æºç ï¼Œæ‹¿è¿‡æ¥å¥½å¥½çœ‹ä¸€çœ‹ï¼Œå¸æ”¶ä¸€ä¸‹ï¼Œå°±å¥½åƒå¸æ”¶äº†ä¸€å®¶å…¬å¸çš„å·¥ä½œç»éªŒï¼Œå¤šçˆ½ã€‚</p><p>åœ¨ Kickstarter çš„å¼€æºä»£ç ä¹‹å¤–ï¼Œæˆ‘è¿˜äº†è§£åˆ°ï¼Œä»–ä»¬ native ç»„çš„å·¥ç¨‹å¸ˆåŒæ—¶ç»´æŠ¤ Andriod å’Œ iOS å®¢æˆ·ç«¯çš„ä»£ç ï¼è¿™ä¹Ÿæ˜¯ä¸€èˆ¬çš„å…¬å¸éƒ½æ¯”ä¸äº†çš„å§â€¦â€¦ éšç€å¯¹ä»–ä»¬å…¬å¸äº†è§£åœ°è¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä¹Ÿè¢« Brandon åœˆç²‰ï¼Œä»–ä¸ä½†æ¨è¿›äº† ios-oss çš„å¼€æºï¼Œè®©æˆ‘çœ‹åˆ°è¿™ä¹ˆä¼˜ç§€çš„å®¢æˆ·ç«¯æºç ï¼Œè€Œä¸”ä»–çš„å¾ˆå¤šåˆ†äº«ä¹Ÿä»¤æˆ‘å°è±¡æ·±åˆ»ã€‚åªå¯æƒœæœ€è¿‘ä»–ä» Kickstarter ç¦»èŒäº†ï¼Œä¸è¿‡æœŸå¾…ä»–ç»™æˆ‘ä»¬å¸¦æ¥æ›´å¤šç²¾å½©ï¼</p><p>ä¸‹ç¯‡å…³äº Kickstart iOS çš„åˆ†æåº”è¯¥æ˜¯åœ¨å±‚æ¬¡ç»“æ„å’Œä»£ç æ–¹é¢ <del>å¸Œæœ›è‡ªå·±ä¸è¦å¤ªç›‘</del></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å…¶å®åœ¨ Kickstarter åˆšå¼€æºä»–ä»¬å®¢æˆ·ç«¯æºç çš„æ—¶å€™ï¼Œæˆ‘å°±ä» GitHub çš„ trends é‡Œçœ‹åˆ°äº†ã€‚ä½œä¸ºä¸€ä¸ªå®ç”¨ä¸»ä¹‰è€…ï¼Œæ‚„æ‚„ç‚¹äº†ä¸ª star å°±èµ°æ‰äº†ã€‚&lt;/p&gt;
&lt;p&gt;åæ¥åœ¨ &lt;a href=&quot;objc.io&quot;&gt;ObjC.io&lt;/a&gt; ä¸Šçš„è¿™ä¸ª &lt;a href=&quot;
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>ç”¨ CALayer.mask å®ç°è¾¹ç•Œçš„æ¸éšæ•ˆæœ</title>
    <link href="http://zhaoxinyu.me/2017-07-04-calayer-mask/"/>
    <id>http://zhaoxinyu.me/2017-07-04-calayer-mask/</id>
    <published>2017-07-04T15:57:20.000Z</published>
    <updated>2017-07-04T15:59:50.000Z</updated>
    
    <content type="html"><![CDATA[<p>å…ˆçœ‹çœ‹æœ€ç»ˆè¦å®ç°çš„æ•ˆæœ</p><p><img src="http://oo8znht6g.bkt.clouddn.com/20170703210237_sUBP2Y_2.gif" alt=""></p><p>ä¸€å¼€å§‹çœ‹åˆ°è¿™ç§æ•ˆæœæˆ‘æœ‰ç‚¹æ‡µï¼Œè¿™å’Œæ™®é€šçš„é˜´å½±ä¸å¤ªä¸€æ ·ï¼Œå¹¶ä¸æ˜¯å¸¦æœ‰é¢œè‰²çš„è’™å±‚ï¼Œç»å°½è„‘æ±æƒ³äº†ä¸€ä¼šï¼Œåº”è¯¥æ˜¯åœ¨ä¸Šé¢åŠ ä¸€ä¸ª <code>CAGradientLayer</code> å§ï¼Œä½†æ˜¯è¿™å±‚ <code>layer</code> çš„é¢œè‰²åˆ°åº•æ˜¯ä»€ä¹ˆæ‰å¯¹å‘¢ï¼Ÿç¿»äº†ç¿» <code>CALayer</code> çš„æ–‡æ¡£ï¼Œå‘ç°äº†è¿™æ ·ä¸€ä¸ªå±æ€§ <code>mask: CALayer?</code>ï¼Œå®ƒæ˜¯è¿™æ ·è¯´çš„ï¼Œ</p><blockquote><p>A layer whose alpha channel is used as a mask to select between the layerâ€™s background and the result of compositing the layerâ€™s contents with its filtered background. Defaults to nil. When used as a mask the layerâ€™s <code>compositingFilter</code> and <code>backgroundFilters</code> properties are ignored. When setting the mask to a new layer, the new layer must have a nil superlayer, otherwise the behavior is undefined. Nested masks (mask layers with their own masks) are unsupported.</p></blockquote><p>å¤§æ¦‚çš„è§£é‡Šå°±æ˜¯ï¼Œè¿™ä¸ª mask çš„ alpha é€šé“ä¼šä½œç”¨åœ¨å½“å‰çš„ layer ä¸Šï¼Œä½ å¯ä»¥æŠŠå®ƒæƒ³åƒæˆä¸€ä¸ª filterï¼Œlayer åé¢çš„ backgroud å¦‚æœèƒ½é€è¿‡è¿™ä¸ª alpha å±‚ï¼Œé‚£å®ƒå°±èƒ½ä¸å½“å‰ layer åœ¨ä¸€èµ·æ˜¾ç¤ºã€‚ç»è¿‡ä¸€äº›å®éªŒï¼Œè¿™ä¸ª mask å¹¶ä¸ä¼šå½±å“å®ƒåé¢å†…å®¹çš„æ˜¾ç¤ºã€‚é‚£æˆ‘ä»¬å°±å¯ä»¥ç”¨è¿™ä¸ª layer çš„ <code>mask</code> å±æ€§æä¸€äº›äº‹æƒ…å‡ºæ¥äº†ã€‚</p><p>è¦æƒ³å®ç°ä¸Šå›¾çš„æ•ˆæœå¤§æ¦‚éœ€è¦è¦åšä»¥ä¸‹å‡ ä¸ªäº‹æƒ…ï¼Œ</p><p>åˆ›å»ºä¸€ä¸ª <code>CAGradientLayer</code> ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">lazy</span> <span class="keyword">var</span> gradientLayer: <span class="type">CAGradientLayer</span> = &#123;</div><div class="line">    <span class="keyword">let</span> v = <span class="type">CAGradientLayer</span>()</div><div class="line">    <span class="comment">// è¿™é‡Œçš„é¢œè‰²æ˜¯ä»€ä¹ˆéƒ½æ— æ‰€è°“ï¼Œå› ä¸ºåªæœ‰ alpha é€šé“ä¼šèµ·ä½œç”¨</span></div><div class="line">    v.colors = [<span class="type">UIColor</span>.clear.withAlphaComponent(<span class="number">0</span>).cgColor, <span class="type">UIColor</span>.clear.withAlphaComponent(<span class="number">1</span>).cgColor]</div><div class="line">    v.locations = [<span class="number">0.0</span>, <span class="number">1</span>]</div><div class="line">    v.rasterizationScale = <span class="type">UIScreen</span>.main.scale</div><div class="line">    v.startPoint = <span class="type">CGPoint</span>(x: <span class="number">0</span>, y: <span class="number">1</span>)</div><div class="line">    v.endPoint = <span class="type">CGPoint</span>(x: <span class="number">0</span>, y: <span class="number">0.8</span>)</div><div class="line">    <span class="keyword">return</span> v</div><div class="line">&#125;()</div></pre></td></tr></table></figure><p>å› ä¸ºè¦é€è¿‡åé¢å†…å®¹çš„æ˜¾ç¤ºï¼ŒtableView çš„èƒŒæ™¯éœ€è¦æ˜¯é€æ˜çš„ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">tableView.backgroundColor = <span class="type">UIColor</span>.clear</div></pre></td></tr></table></figure><p>è€ƒè™‘åˆ°åˆ—è¡¨æ˜¯ä¼šæ»šåŠ¨çš„ï¼ŒæŠŠè¿™ä¸ª layer åŠ åˆ° tableView çš„ mask ä¸Šçš„å›ºå®šä½ç½®ï¼Œé‚£åˆ—è¡¨ä¸€æ»šåŠ¨ï¼Œæ•ˆæœå°±ä¸å¯¹äº†ï¼Œæ‰€ä»¥éœ€è¦æŠŠ tableView åŠ åˆ°ä¸€ä¸ª background ä¸Šé¢å»ï¼Œç„¶åæŠŠ <code>layer.mask</code> è®¾ç½®æˆè¿™æˆ‘ä»¬ä¹‹å‰åˆ›å»ºå¥½çš„ <code>gradientLayer</code></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">lazy</span> <span class="keyword">var</span> tableViewBackgroundView: <span class="type">UIView</span> = &#123;</div><div class="line">    <span class="keyword">let</span> v = <span class="type">UIView</span>()</div><div class="line">    v.backgroundColor = <span class="type">UIColor</span>.clear</div><div class="line">    v.layer.mask = <span class="keyword">self</span>.gradientLayer</div><div class="line">    <span class="keyword">return</span> v</div><div class="line">&#125;()</div></pre></td></tr></table></figure><p>ç”±äºæ˜¯ AutoLayout å¸ƒå±€ï¼Œè€Œ layer å´ä¸èƒ½åŠ çº¦æŸï¼Œæ‰€ä»¥æˆ‘ä»¬ç›‘å¬ backgroundView çš„ <code>bounds</code> æ‰‹åŠ¨æ›´æ–° layer çš„ frameï¼ˆè¿™é‡Œç”¨äº† RxSwiftï¼Œå…¶å®ƒæ–¹å¼ä¹Ÿéƒ½ OKï¼‰</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">tableViewBackgroundView.rx.observe(<span class="type">CGRect</span>.<span class="keyword">self</span>, <span class="string">"bounds"</span>)</div><div class="line">  .subscribe(onNext: &#123; [<span class="keyword">weak</span> <span class="keyword">self</span>] bounds <span class="keyword">in</span></div><div class="line">      <span class="keyword">guard</span> <span class="keyword">let</span> bounds = bounds <span class="keyword">else</span> &#123; <span class="keyword">return</span> &#125;</div><div class="line">      <span class="keyword">self</span>?.gradientLayer.frame = bounds</div><div class="line">  &#125;).addDisposableTo(bag)</div></pre></td></tr></table></figure><p>Boomï¼Œå¸¦æœ‰è¾¹ç•Œæ¸éšæ•ˆæœçš„åˆ—è¡¨å°± OK äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿æ</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;å…ˆçœ‹çœ‹æœ€ç»ˆè¦å®ç°çš„æ•ˆæœ&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;http://oo8znht6g.bkt.clouddn.com/20170703210237_sUBP2Y_2.gif&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;ä¸€å¼€å§‹çœ‹åˆ°è¿™ç§æ•ˆæœæˆ‘æœ‰ç‚¹æ‡µï¼Œè¿™å’Œæ™®é€šçš„é˜´å½±ä¸å¤ªä¸€æ ·ï¼Œå¹¶ä¸æ˜¯å¸¦æœ‰
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
  </entry>
  
  <entry>
    <title>è®°ä¸€æ¬¡å›¢é˜Ÿçš„å†…éƒ¨åˆ†äº« - FRP in Swift</title>
    <link href="http://zhaoxinyu.me/2017-05-25-frp-in-swift-basic/"/>
    <id>http://zhaoxinyu.me/2017-05-25-frp-in-swift-basic/</id>
    <published>2017-05-26T15:24:00.000Z</published>
    <updated>2017-05-26T15:33:30.000Z</updated>
    
    <content type="html"><![CDATA[<blockquote><p>è¿™æ˜¯ 2017/05/26 æˆ‘åœ¨çŸ¥ä¹ iOS å›¢é˜Ÿå†…éƒ¨åšçš„ä¸€æ¬¡åˆ†äº«</p></blockquote><p>ç¬¬ä¸€æ¬¡åšæŠ€æœ¯åˆ†äº«ï¼Œæœ€å¤§çš„é—®é¢˜è¿˜æ˜¯å‡ºåœ¨å‡†å¤‡ä¸Šã€‚ç¡®å®šäº†åˆ†äº«çš„æ—¶é—´ï¼Œä½†æ˜¯åˆ°åº•è¦è®²äº›ä»€ä¹ˆå†…å®¹å†…å¿ƒå´ä¸€ç›´æ²¡æœ‰ä¸€ä¸ªå‡†ç¡®çš„èŒƒå›´ï¼Œç»“æœå°±æ˜¯åˆ°äº†å‰ä¸€å¤©è¿˜æ˜¯å¾€é‡Œé¢åŠ ä¸œè¥¿ï¼Œå‰ä¸€åˆ»è¿˜åœ¨ä¿®æ”¹ Kyenoteã€‚åˆ†äº«çš„æ—¶å€™å› ä¸ºæœ‰å¾ˆå¤šå†™ä»£ç çš„ç¯èŠ‚ï¼Œæ‰€ä»¥ä¸€å¼€å§‹æœ‰äº›å°ç´§å¼ ï¼Œæ‰‹è¿˜å‘æŠ–ï¼Œä¸è¿‡åˆ°åæ¥æ…¢æ…¢å¥½èµ·æ¥äº†ã€‚æœ¬æ¥æƒ³æŠŠå®å†µå½•å±å…¨ç¨‹è®°å½•ä¸‹æ¥çš„ï¼Œä½†æ˜¯å› ä¸º Ariplay çš„å½•å±è²Œä¼¼æœ‰äº›å°é—®é¢˜ï¼Œä¸ºäº†ä¸è€½è¯¯å¤§å®¶æ—¶é—´ï¼Œæˆ‘å°±ç›´æ¥æ”¾å¼ƒäº†ï¼Œè¿˜æ˜¯æœ‰äº›å°é—æ†¾ã€‚</p><p>ä»¥ä¸‹æ˜¯ Keynote å’Œåˆ†äº«çš„ä¸»è¦å†…å®¹</p><script async class="speakerdeck-embed" data-slide="1" data-id="69a9cff70bc74577a78194958fe41a33" data-ratio="1.77777777777778" src="//speakerdeck.com/assets/embed.js"></script><h1 id="Functional-Reactive-Programming-in-Swift"><a href="#Functional-Reactive-Programming-in-Swift" class="headerlink" title="Functional Reactive Programming in Swift"></a>Functional Reactive Programming in Swift</h1><h2 id="What"><a href="#What" class="headerlink" title="What?"></a>What?</h2><h3 id="Functional-Programming"><a href="#Functional-Programming" class="headerlink" title="Functional Programming"></a>Functional Programming</h3><h4 id="First-class-function"><a href="#First-class-function" class="headerlink" title="First-class function"></a>First-class function</h4><p>Treats functions as first-class citizens</p><h4 id="Higher-order-function"><a href="#Higher-order-function" class="headerlink" title="Higher-order function"></a>Higher-order function</h4><p>A function that does at least one of the following:</p><ul><li>takes one or more functions as arguments </li><li>returns a function as its result</li></ul><h4 id="Pure-function"><a href="#Pure-function" class="headerlink" title="Pure function"></a>Pure function</h4><p>Function which has no side-effects</p><h4 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// pure function</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">addTen</span><span class="params">(<span class="number">_</span> a: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> a + <span class="number">10</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// higher order function</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">twice</span><span class="params">(<span class="number">_</span> f: @escaping <span class="params">(Int)</span></span></span> -&gt; (<span class="type">Int</span>)) -&gt; (<span class="type">Int</span>) -&gt; (<span class="type">Int</span>) &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        f(f($<span class="number">0</span>))</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// first-class citizen</span></div><div class="line"><span class="keyword">let</span> addTenTwice = twice(addTen)</div><div class="line">addTenTwice(<span class="number">10</span>) <span class="comment">//30</span></div><div class="line"><span class="keyword">let</span> addTenFourTimes = twice(addTenTwice)</div><div class="line">addTenFourTimes(<span class="number">10</span>) <span class="comment">//50</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// a little more harder</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">multiplyBySelf</span><span class="params">(<span class="number">_</span> a: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> a * a</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> g = twice(multiplyBySelf)</div><div class="line">g(<span class="number">3</span>) <span class="comment">// 81</span></div><div class="line">twice(g)(<span class="number">3</span>) <span class="comment">// 43046721</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> a = <span class="number">3</span> * <span class="number">3</span> <span class="comment">//9</span></div><div class="line"><span class="keyword">let</span> b = a * a <span class="comment">//81</span></div><div class="line"><span class="keyword">let</span> <span class="built_in">c</span> = b * b <span class="comment">//6561</span></div><div class="line"><span class="keyword">let</span> d = <span class="built_in">c</span> * <span class="built_in">c</span> <span class="comment">//43046721</span></div></pre></td></tr></table></figure><h3 id="Reactive-Programming"><a href="#Reactive-Programming" class="headerlink" title="Reactive Programming"></a>Reactive Programming</h3><h4 id="Asynchronous-Data-Streams"><a href="#Asynchronous-Data-Streams" class="headerlink" title="Asynchronous Data Streams"></a>Asynchronous Data Streams</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">--a---b-c---d---X---|-&gt;</div></pre></td></tr></table></figure><ul><li>A stream is a sequence of ongoing events ordered in time</li><li>Everything can be a stream<ul><li>touch event</li><li>KVO</li><li>Notification</li><li>callback</li><li>Network response</li><li>timer</li><li>â€¦</li></ul></li></ul><h3 id="Functional-Reactive"><a href="#Functional-Reactive" class="headerlink" title="Functional + Reactive"></a>Functional + Reactive</h3><h4 id="Stream"><a href="#Stream" class="headerlink" title="Stream"></a>Stream</h4><ul><li>Like an Array, it can hold anything</li><li>Unlike an Array, you canâ€™t access it anytime you want, instread, you get notified when itâ€™s value get changed</li><li>Like a pipe, if you missed the thing through it, itâ€™s gone forever</li></ul><h4 id="Transformation"><a href="#Transformation" class="headerlink" title="Transformation"></a>Transformation</h4><ul><li>Change a stream to another stream, just like change a sequence to another</li><li>Higher-order functions, map, filter, reduce, flatMap, etc</li></ul><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> reviewers = [<span class="string">"kimi"</span>, <span class="string">"qfu"</span>, <span class="string">"dhc"</span>, <span class="string">"x"</span>, <span class="string">"gaoji"</span>]</div><div class="line"></div><div class="line"><span class="comment">// implement our own trnasformation functions</span></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Array</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">xy_map</span>&lt;T&gt;<span class="params">(<span class="number">_</span> transform: <span class="params">(Element)</span></span></span> -&gt; <span class="type">T</span>) -&gt; [<span class="type">T</span>] &#123;</div><div class="line">        <span class="keyword">var</span> result: [<span class="type">T</span>] = []</div><div class="line"></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">self</span> &#123;</div><div class="line">            result.append(transform(i))</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> result</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">xy_filter</span><span class="params">(<span class="number">_</span> condition: <span class="params">(Element)</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; [<span class="type">Element</span>] &#123;</div><div class="line">        <span class="keyword">var</span> result: [<span class="type">Element</span>] = []</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">self</span> &#123;</div><div class="line">            <span class="keyword">if</span> condition(i) &#123;</div><div class="line">                result.append(i)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> result</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">xy_reduce</span>&lt;T&gt;<span class="params">(<span class="number">_</span> initialValue: T, <span class="number">_</span> combine: <span class="params">(T, Element)</span></span></span> -&gt; <span class="type">T</span>) -&gt; <span class="type">T</span> &#123;</div><div class="line">        <span class="keyword">var</span> value = initialValue</div><div class="line">        </div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="keyword">self</span> &#123;</div><div class="line">            value = combine(value, i)</div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">return</span> value</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">reviewers.xy_map &#123;</div><div class="line">    $<span class="number">0</span>.uppercased()</div><div class="line">&#125;</div><div class="line"></div><div class="line">reviewers.xy_filter &#123;</div><div class="line">    $<span class="number">0</span>.characters.<span class="built_in">count</span> &gt; <span class="number">3</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// chain transformations</span></div><div class="line">reviewers</div><div class="line">    .xy_filter &#123; $<span class="number">0</span>.characters.<span class="built_in">count</span> &gt; <span class="number">3</span> &#125;</div><div class="line">    .xy_reduce(<span class="string">""</span>) &#123; <span class="keyword">return</span> $<span class="number">0</span> + <span class="string">"<span class="subst">\($<span class="number">1</span>)</span> review my code please~\n"</span> &#125;</div><div class="line"></div><div class="line"><span class="comment">// the original value hasn't been changed</span></div><div class="line">reviewers</div><div class="line"></div><div class="line"><span class="comment">// a little bit about flatMap</span></div><div class="line"><span class="keyword">let</span> xxs = [[<span class="number">1</span>, <span class="number">2</span>], [<span class="number">3</span>, <span class="number">4</span>], [<span class="number">5</span>, <span class="number">6</span>]]</div><div class="line"><span class="keyword">let</span> xso = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">nil</span>, <span class="number">5</span>]</div><div class="line"><span class="comment">// flatMap has 2 signature</span></div><div class="line">xxs.flatMap &#123; arr <span class="keyword">in</span></div><div class="line">    arr.<span class="built_in">map</span> &#123;$<span class="number">0</span>&#125;</div><div class="line">&#125; <span class="comment">// [1, 2, 3, 4, 5, 6]</span></div><div class="line">xso.flatMap &#123;</div><div class="line">    $<span class="number">0</span></div><div class="line">&#125; <span class="comment">// [1, 2, 3, 5]</span></div></pre></td></tr></table></figure><h4 id="Binding"><a href="#Binding" class="headerlink" title="Binding"></a>Binding</h4><p>Binding makes program more reactive</p><h3 id="in-Swift"><a href="#in-Swift" class="headerlink" title="in Swift!"></a>in Swift!</h3><ul><li>Functional language</li><li>Compiler &amp; strong typed</li></ul><p>Functional + Reactive + Swift, write awesome program!</p><h2 id="Why"><a href="#Why" class="headerlink" title="Why"></a>Why</h2><h3 id="Good"><a href="#Good" class="headerlink" title="Good"></a>Good</h3><ul><li>Improve productivity</li><li>Less and more centralised code</li><li>Easy to maintain</li><li>Avoid complexity with mutable state growing over time</li><li>Change the way you think when coding</li></ul><h3 id="Bad"><a href="#Bad" class="headerlink" title="Bad"></a>Bad</h3><ul><li>Learning curve is steep, but not that steep</li><li>Hard to debug</li></ul><p>The benefits it brings are worth we give it a try</p><h2 id="How"><a href="#How" class="headerlink" title="How"></a>How</h2><h3 id="Unserstand-the-basic-reactive-unit"><a href="#Unserstand-the-basic-reactive-unit" class="headerlink" title="Unserstand the basic reactive unit"></a>Unserstand the basic reactive unit</h3><h4 id="Observable"><a href="#Observable" class="headerlink" title="Observable"></a>Observable</h4><p>It send messages</p><h4 id="Subscriber"><a href="#Subscriber" class="headerlink" title="Subscriber"></a>Subscriber</h4><p>It consume messages</p><p>Observables are like <code>Sequence</code>,</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Observables are like Sequence</span></div><div class="line"><span class="keyword">let</span> xs = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"></div><div class="line"><span class="comment">// iterate a sequence</span></div><div class="line"><span class="keyword">for</span> x <span class="keyword">in</span> xs &#123;</div><div class="line">    <span class="built_in">print</span>(x)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// the operation above equals</span></div><div class="line"><span class="keyword">var</span> xsIte = xs.makeIterator()</div><div class="line"><span class="keyword">while</span> <span class="keyword">let</span> x = xsIte.next() &#123;</div><div class="line">    <span class="built_in">print</span>(x)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// we can use Sequence feature to make a CountDown</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">CountDown</span>: <span class="title">Sequence</span>, <span class="title">IteratorProtocol</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> num: <span class="type">Int</span></div><div class="line">    </div><div class="line">    <span class="keyword">var</span> notify: (<span class="type">Int</span>?) -&gt; ()</div><div class="line"></div><div class="line">    <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">next</span><span class="params">()</span></span> -&gt; <span class="type">Int</span>? &#123;</div><div class="line">        notify(num)</div><div class="line">        <span class="keyword">if</span> num == <span class="number">0</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">defer</span> &#123;</div><div class="line">            num -= <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> num</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> ite = <span class="type">CountDown</span>(num: <span class="number">10</span>) &#123;</div><div class="line">        <span class="comment">// as a subscriber, we are consuming messages</span></div><div class="line">        <span class="built_in">print</span>($<span class="number">0</span>)</div><div class="line">    &#125;.makeIterator()</div><div class="line"></div><div class="line"><span class="comment">// now it's kind like a stream</span></div><div class="line"><span class="comment">// once next() called, it'll print the latest value, it's reactive now</span></div><div class="line">ite.next() <span class="comment">//10</span></div><div class="line">ite.next() <span class="comment">//9</span></div><div class="line">ite.next() <span class="comment">//8</span></div></pre></td></tr></table></figure><p>How can we make our own Observable/Subscriber pattern?</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">KeyValueObserver</span>&lt;<span class="title">A</span>&gt;: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> block: (<span class="type">A</span>) -&gt; ()</div><div class="line">    <span class="keyword">let</span> keyPath: <span class="type">String</span></div><div class="line">    <span class="keyword">let</span> object: <span class="type">NSObject</span></div><div class="line">    <span class="keyword">init</span>(object: <span class="type">NSObject</span>, keyPath: <span class="type">String</span>, <span class="number">_</span> block: @escaping (<span class="type">A</span>) -&gt; ()) &#123;</div><div class="line">        <span class="keyword">self</span>.block = block</div><div class="line">        <span class="keyword">self</span>.keyPath = keyPath</div><div class="line">        <span class="keyword">self</span>.object = object</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</div><div class="line">        object.addObserver(<span class="keyword">self</span>, forKeyPath: keyPath, options: .new, context: <span class="literal">nil</span>)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">deinit</span> &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"deinit"</span>)</div><div class="line">        object.removeObserver(<span class="keyword">self</span>, forKeyPath: keyPath)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">observeValue</span><span class="params">(forKeyPath keyPath: String?, of object: Any?, change: [NSKeyValueChangeKey : Any]?, context: UnsafeMutableRawPointer?)</span></span> &#123;</div><div class="line">        block(change![.newKey] <span class="keyword">as</span>! <span class="type">A</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observable</span>&lt;<span class="title">A</span>&gt; </span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> callbacks: [(<span class="type">A</span>) -&gt; ()] = []</div><div class="line">    <span class="keyword">var</span> objects: [<span class="type">Any</span>] = []</div><div class="line">    </div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">pipe</span><span class="params">()</span></span> -&gt; ((<span class="type">A</span>) -&gt; (), <span class="type">Observable</span>&lt;<span class="type">A</span>&gt;) &#123;</div><div class="line">        <span class="keyword">let</span> observable = <span class="type">Observable</span>&lt;<span class="type">A</span>&gt;()</div><div class="line">        <span class="keyword">return</span> (&#123; [<span class="keyword">weak</span> observable] value <span class="keyword">in</span></div><div class="line">            observable?.send(value)&#125;, observable</div><div class="line">        )</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">send</span><span class="params">(<span class="number">_</span> value: A)</span></span> &#123;</div><div class="line">        <span class="keyword">for</span> callback <span class="keyword">in</span> callbacks &#123;</div><div class="line">            callback(value)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">subscribe</span><span class="params">(callback: @escaping <span class="params">(A)</span></span></span> -&gt; ()) &#123;</div><div class="line">        callbacks.append(callback)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UITextField</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">observable</span><span class="params">()</span></span> -&gt; <span class="type">Observable</span>&lt;<span class="type">String</span>&gt; &#123;</div><div class="line">        <span class="keyword">let</span> (sink, observable) = <span class="type">Observable</span>&lt;<span class="type">String</span>&gt;.pipe()</div><div class="line">        <span class="keyword">let</span> observer = <span class="type">KeyValueObserver</span>(object: <span class="keyword">self</span>, keyPath: #keyPath(text)) &#123;</div><div class="line">            sink($<span class="number">0</span>)</div><div class="line">        &#125;</div><div class="line">        observable.objects.append(observer)</div><div class="line">        <span class="keyword">return</span> observable</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> textField: <span class="type">UITextField</span>? = <span class="type">UITextField</span>()</div><div class="line"></div><div class="line">textField?.text = <span class="string">"asd"</span></div><div class="line"><span class="keyword">var</span> observable = textField?.observable()</div><div class="line">    </div><div class="line">observable!.subscribe &#123;</div><div class="line">    <span class="built_in">print</span>($<span class="number">0</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line">textField?.text = <span class="string">"asdjlas"</span></div><div class="line">textField?.text = <span class="string">"asdjk"</span></div><div class="line">textField = <span class="literal">nil</span></div><div class="line">observable = <span class="literal">nil</span></div></pre></td></tr></table></figure><h3 id="Integrate-a-reactive-programming-library"><a href="#Integrate-a-reactive-programming-library" class="headerlink" title="Integrate a reactive programming library"></a>Integrate a reactive programming library</h3><ul><li>ReactiveSwift</li><li>ReactiveKit</li><li>RxSwift</li></ul><p>Neither can goes wrong, but I prefer RxSwift because,</p><ul><li>Itâ€™s a <a href="http://reactivex.io/" target="_blank" rel="external">ReactiveX</a> official Swift implementation which means<ul><li>Developer wonâ€™t give it up (Maybe?)</li><li>You can easily switch to other platform</li></ul></li><li>It has a greate <a href="https://github.com/RxSwiftCommunity" target="_blank" rel="external">community</a></li></ul><h2 id="Credits"><a href="#Credits" class="headerlink" title="Credits"></a>Credits</h2><ul><li><a href="https://en.wikipedia.org/wiki/Higher-order_function#Swift" target="_blank" rel="external">wiki/Higher-order function</a></li><li><a href="https://news.realm.io/news/altconf-ash-furrow-functional-reactive-swift/" target="_blank" rel="external">Functional Reactive Awesomeness with Swift</a></li><li><a href="https://gist.github.com/staltz/868e7e9bc2a7b8c1f754" target="_blank" rel="external">The introduction to Reactive Programming youâ€™ve been missing</a></li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;blockquote&gt;
&lt;p&gt;è¿™æ˜¯ 2017/05/26 æˆ‘åœ¨çŸ¥ä¹ iOS å›¢é˜Ÿå†…éƒ¨åšçš„ä¸€æ¬¡åˆ†äº«&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;ç¬¬ä¸€æ¬¡åšæŠ€æœ¯åˆ†äº«ï¼Œæœ€å¤§çš„é—®é¢˜è¿˜æ˜¯å‡ºåœ¨å‡†å¤‡ä¸Šã€‚ç¡®å®šäº†åˆ†äº«çš„æ—¶é—´ï¼Œä½†æ˜¯åˆ°åº•è¦è®²äº›ä»€ä¹ˆå†…å®¹å†…å¿ƒå´ä¸€ç›´æ²¡æœ‰ä¸€ä¸ªå‡†ç¡®çš„èŒƒå›´ï¼Œç»“æœå°±æ˜¯åˆ°äº†å‰ä¸€å¤©è¿˜æ˜¯å¾€
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Swift" scheme="http://zhaoxinyu.me/tags/Swift/"/>
    
      <category term="FRP" scheme="http://zhaoxinyu.me/tags/FRP/"/>
    
  </entry>
  
  <entry>
    <title>&lt;è¯‘&gt; Swift ä»£ç å°æŠ„</title>
    <link href="http://zhaoxinyu.me/2017-04-14-swift-syntax-cheat-code/"/>
    <id>http://zhaoxinyu.me/2017-04-14-swift-syntax-cheat-code/</id>
    <published>2017-04-14T12:20:00.000Z</published>
    <updated>2017-05-17T16:11:27.000Z</updated>
    
    <content type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥=<a href="https://medium.com/swift-programming/swift-syntax-cheat-codes-9ce4ab4bc82e#.qrmtczdec" target="_blank" rel="external">https://medium.com/swift-programming/swift-syntax-cheat-codes-9ce4ab4bc82e#.qrmtczdec</a><br>ä½œè€…=Andyy Hope<br>è¯‘è€…=X140yu</p><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><h1 id="Swift-ä»£ç å°æŠ„"><a href="#Swift-ä»£ç å°æŠ„" class="headerlink" title="Swift ä»£ç å°æŠ„"></a>Swift ä»£ç å°æŠ„</h1><blockquote><p>â†‘ â†‘ â†“ â†“ â† â†’ â† â†’ B A</p></blockquote><p>æ— è®ºæ˜¯ä½ å­¦ä¹ çš„ç¬¬ä¸€é—¨è¯­è¨€æ˜¯ Swift è¿˜æ˜¯ä¹‹å‰å­¦è¿‡ Objective-Cï¼Œåœ¨å­¦ä¹  Swift çš„è¿‡ç¨‹ä¸­ï¼Œä¸€å®šä¼šæ„Ÿå¹å®ƒ<em>çœŸçš„</em>æ˜¯ä¸€é—¨è¶…èµçš„è¯­è¨€ã€‚ä½†å¦‚æœä½ ä¸ç†Ÿæ‚‰å®ƒçš„æŸäº›è¯­æ³•ï¼Œå°±å¯èƒ½ä¼šè¢«æŸäº›å†™æ³•å“åˆ°ã€‚åœ¨è¿™é‡Œæˆ‘ä¼šä»‹ç»ä¸€äº›åœ¨å†™ Swift è¿‡ç¨‹ä¸­å¸¸è§è¯­æ³•ï¼Œå¸Œæœ›ä½ ä»¬èƒ½ç”¨ Swift å†™å‡ºæ›´ç®€æ´çš„ä»£ç ã€‚</p><h4 id="Closuresï¼ˆé—­åŒ…ï¼‰"><a href="#Closuresï¼ˆé—­åŒ…ï¼‰" class="headerlink" title="Closuresï¼ˆé—­åŒ…ï¼‰"></a>Closuresï¼ˆé—­åŒ…ï¼‰</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">() -&gt; Void</div></pre></td></tr></table></figure><p>Closure åœ¨ C æˆ– Objective-C ä¸­ä¹Ÿè¢«ç§°ä¸º â€œunnamed functionâ€ï¼ˆåŒ¿åå‡½æ•°ï¼‰ æˆ–è€… â€œblockâ€ï¼ˆä»£ç å—ï¼‰ã€‚ä½ å¯ä»¥æŠŠé—­åŒ…å½“æˆä¸€ä¸ªå€¼ï¼Œä¼ æ¥ä¼ å»ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æŠŠå®ƒå½“æˆå‡½æ•°çš„å‚æ•°ã€‚</p><p>å¦‚æœä½ ä¹‹å‰æœ‰è¿‡ iOS å¼€å‘ç»éªŒï¼Œé‚£ä¹ˆå¾ˆæœ‰å¯èƒ½è°ƒç”¨è¿‡è¿™ä¸ª UIView çš„åŠ¨ç”» API:</p><p>class func animate(withDuration duration: NSTimeInterval, animations: @escaping <strong>() -&gt; Void</strong>)</p><p>å¯ä»¥åœ¨ <code>animations:</code> å‚æ•°ä¸­ä¼ å…¥æ‰§è¡ŒåŠ¨ç”»çš„ä»£ç ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="type">UIView</span>.animate(withDuration: <span class="number">10.0</span>, animations: &#123;</div><div class="line">    button.alpha = <span class="number">0</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure><p>è¿™ä¸ª<code>animationWithDuration:</code> å‡½æ•°ä¼šä½¿ç”¨æˆ‘ä»¬é—­åŒ…ä¸­çš„ä»£ç ï¼Œæ‚„æ‚„åœ°åšä¸€äº›ç¥å¥‡çš„äº‹æƒ…ï¼ŒæŠŠ <code>button</code> çš„é€æ˜è°ƒæ•´åˆ° 0ï¼ˆä¸å¯è§ï¼‰ã€‚</p><h4 id="Trailing-closuresï¼ˆå°¾éšé—­åŒ…ï¼‰"><a href="#Trailing-closuresï¼ˆå°¾éšé—­åŒ…ï¼‰" class="headerlink" title="Trailing closuresï¼ˆå°¾éšé—­åŒ…ï¼‰"></a>Trailing closuresï¼ˆå°¾éšé—­åŒ…ï¼‰</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="type">UIView</span>.animate(withDuration: <span class="number">10.0</span>) &#123;</div><div class="line">    button.alpha = <span class="number">0</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Swift ä½¿ç”¨è¿™ç§æ–¹å¼æ¥å‡å°‘ä¸å¿…è¦çš„è¯­æ³•ã€‚å¦‚æœä½ ä»”ç»†çœ‹ä¸Šé¢çš„ä»£ç å°±ä¼šå‘ç°ï¼Œè¿™å’Œä¹‹å‰åœ¨ closure ä¸­ä¸¾çš„ä¾‹å­ä½¿ç”¨çš„æ˜¯ç›¸åŒçš„ APIï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯å®ƒçš„è¯­æ³•è¢«ç®€åŒ–äº†ã€‚</p><p>å› ä¸º <code>animate</code> å‡½æ•°çš„æœ€åä¸€ä¸ªå‚æ•°æ˜¯é—­åŒ…ï¼Œæ‰€ä»¥å®ƒå¾—å<em>å°¾éšé—­åŒ…</em>ã€‚å°¾éšé—­åŒ…å¯ä»¥çœç•¥æœ€åä¸€ä¸ªå‚æ•°çš„åå­—ï¼Œå¹¶ä¸”å¯ä»¥å®Œå…¨æŠŠå®ƒç§»å‡ºå‡½æ•°å‚æ•°åˆ—è¡¨åœ†æ‹¬å·çš„å¤–é¢ï¼Œè¿™å°±å¸¦æ¥äº†æ›´ä¼˜é›…å’Œå‡†ç¡®çš„ä»£ç ã€‚ä¸‹é¢çš„å‡½æ•°éƒ½æ˜¯ç›¸åŒçš„ï¼Œä¸è¿‡åé¢çš„ä½¿ç”¨äº†å°¾éšé—­åŒ…è¯­æ³•ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">say</span><span class="params">(<span class="number">_</span> message: String, completion: @escaping <span class="params">()</span></span></span> -&gt; <span class="type">Void</span>) &#123;</div><div class="line">    <span class="built_in">print</span>(message)</div><div class="line">    completion()</div><div class="line">&#125;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">say(<span class="string">"Hello"</span>, completion: &#123;</div><div class="line">    <span class="comment">// prints: "Hello"</span></div><div class="line">    <span class="comment">// Do some other stuff</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line">say(<span class="string">"Hello"</span>) &#123;</div><div class="line">    <span class="comment">// prints: "Hello"</span></div><div class="line">    <span class="comment">// Do some other stuff</span></div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="Type-Aliasï¼ˆç±»å‹åˆ«åï¼‰"><a href="#Type-Aliasï¼ˆç±»å‹åˆ«åï¼‰" class="headerlink" title="Type Aliasï¼ˆç±»å‹åˆ«åï¼‰"></a>Type Aliasï¼ˆç±»å‹åˆ«åï¼‰</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typealias</span></div></pre></td></tr></table></figure><p>Typealias æ˜¯ä¸€ä¸ªèƒ½è®©æˆ‘ä»¬çš„å†™ä»£ç çš„æ—¶å€™é¿å…ä¸€ç›´é‡å¤çš„å®ç”¨å°å·¥å…·ã€‚æœ‰è¿™æ ·ä¸€ä¸ªå‡½æ•°ï¼Œå‚æ•°æ˜¯ä¸€ä¸ªé—­åŒ…ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">dance</span><span class="params">(<span class="keyword">do</span>: <span class="params">(Int, String, Double)</span></span></span> -&gt; (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Double</span>)) &#123; &#125;</div></pre></td></tr></table></figure><p>èµ·åˆè¿™è¿˜æŒºç›´æ¥å®¹æ˜“ç†è§£çš„ï¼Œä½†å¦‚æœæŠŠè¿™ä¸ªé—­åŒ…ä¼ åˆ°å…¶å®ƒå‡½æ•°ä¸­å»å‘¢ï¼Ÿæˆ‘ä»¬è¿˜è¦è®°ä½è¿™ä¸ªé—­åŒ…çš„ç­¾åï¼Œè€Œä¸”åœ¨æ¯ä¸€ä¸ªå®ƒå‡ºç°çš„åœ°æ–¹éƒ½è¦ç¡®ä¿å®ƒçš„ç­¾åæ˜¯æ­£ç¡®çš„ã€‚å¦‚æœæœ‰çš„åœ°æ–¹å†™é”™äº†ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">dance</span><span class="params">(<span class="keyword">do</span>: <span class="params">(Int, String, Double)</span></span></span> -&gt; (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Double</span>)) &#123; &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">sing</span><span class="params">(<span class="keyword">do</span>: <span class="params">(Int, String, Double)</span></span></span> -&gt; (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Double</span>)) &#123; &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">act</span><span class="params">(<span class="keyword">do</span>: <span class="params">(Int, String, Double)</span></span></span> -&gt; (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Double</span>)) &#123; &#125;</div></pre></td></tr></table></figure><p>å¦‚æœæˆ‘ä»¬ä¿®æ”¹äº†è¿™ä¸ªé—­åŒ…çš„ç­¾åï¼Œé—®é¢˜å°±å‡ºç°äº†ã€‚æ¯”å¦‚äº¤æ¢äº†å…¶ä¸­å‚æ•°æˆ–è€…è¿”å›å€¼çš„é¡ºåºã€‚æˆ‘ä»¬å°±å¾—æŠŠæ¯ä¸€ä¸ªç”¨åˆ°çš„åœ°æ–¹éƒ½æ”¹ä¸€ä¸‹ã€‚è¿™ä¸ªæ—¶å€™ <code>typealias</code> å°±ä¼šæ¯”è¾ƒæœ‰å¸®åŠ©äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typealias</span> <span class="type">TripleThreat</span> = (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Double</span>) -&gt; (<span class="type">Int</span>, <span class="type">String</span>, <span class="type">Double</span>)</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">dance</span><span class="params">(dance: TripleThreat)</span></span> &#123; &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">act</span><span class="params">(act: TripleThreat)</span></span> &#123; &#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">sing</span><span class="params">(sing: TripleThreat)</span></span> &#123; &#125;</div></pre></td></tr></table></figure><p>è¿™æ ·å°±å¥½å¤šäº†ï¼Œç”¨ <code>typealias</code> æ›¿ä»£äº†å¾ˆå¤šé‡å¤çš„ä»£ç ï¼Œè€Œä¸”å¦‚æœæƒ³æ›´æ”¹é—­åŒ…å®šä¹‰çš„è¯ï¼Œç›´æ¥æ”¹ <code>typealias</code> å°±å¯ä»¥äº†ã€‚</p><p><strong>æ¯”è¾ƒã€Œæœ‰åçš„ã€typealias</strong></p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">typealias</span> <span class="type">Void</span> = ()</div><div class="line"></div><div class="line"><span class="keyword">typealias</span> <span class="type">NSTimeInterval</span> = <span class="type">Double</span></div></pre></td></tr></table></figure><h3 id="ç®€å†™å‚æ•°å"><a href="#ç®€å†™å‚æ•°å" class="headerlink" title="ç®€å†™å‚æ•°å"></a>ç®€å†™å‚æ•°å</h3><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">$<span class="number">0</span>, $<span class="number">1</span>, $<span class="number">2</span>...</div></pre></td></tr></table></figure><p>å¦‚æœä¸€ä¸ªé—­åŒ…æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå‚æ•°ï¼ŒSwift å…è®¸æˆ‘ä»¬ç»™å®ƒä»¬å®šä¹‰å˜é‡åï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">say</span><span class="params">(<span class="number">_</span> message: String, completion: <span class="params">(<span class="number">_</span> goodbye: String)</span></span></span> -&gt; <span class="type">Void</span>) &#123;</div><div class="line">    <span class="built_in">print</span>(message)</div><div class="line">    completion(<span class="string">"Goodbye"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line">say(<span class="string">"Hi"</span>) &#123; (goodbye: <span class="type">String</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">    <span class="built_in">print</span>(goodbye)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// prints: "Hi"</span></div><div class="line"><span class="comment">// prints: "Goodbye"</span></div></pre></td></tr></table></figure><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œå°¾éšé—­åŒ…æœ‰ä¸€ä¸ªåä¸º <code>goodbype</code> ç±»å‹æ˜¯ <code>String</code> çš„å‚æ•°ï¼ŒXcode ä¼šè‡ªåŠ¨æŠŠå®ƒæ”¾åœ¨ä¸€ä¸ªå…ƒç»„é‡Œï¼Œæ¥ç€æ˜¯ <code>-&gt;</code> ã€è¿”å›å€¼ã€è¿˜æœ‰ <code>in</code>ï¼Œæˆ‘ä»¬çš„ä»£ç åœ¨ä¸‹ä¸€è¡Œã€‚ä½†æ˜¯è¿™ä¸ªé—­åŒ…å¾ˆå°ï¼Œå†™è¿™ä¹ˆå¤šä»£ç æ˜¯æ²¡æœ‰å¿…è¦çš„ã€‚æ¥åˆ†æä¸€ä¸‹ï¼Œå¦‚ä½•æ‰èƒ½å†™æ›´å°‘çš„ä»£ç ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">(goodbye: <span class="type">String</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div></pre></td></tr></table></figure><p>ä¸Šé¢çš„å…¶å®éƒ½æ²¡æœ‰ä»€ä¹ˆå­˜åœ¨çš„å¿…è¦æ€§ï¼Œå› ä¸ºå¯ä»¥ä½¿ç”¨ç®€åŒ–çš„å‚æ•°åï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">say(<span class="string">"Hi"</span>) &#123; <span class="built_in">print</span>($<span class="number">0</span>) &#125;</div><div class="line"></div><div class="line"><span class="comment">// prints: "Hi"</span></div><div class="line"><span class="comment">// prints: "Goodbye"</span></div></pre></td></tr></table></figure><p>å¯ä»¥çœ‹åˆ°ï¼Œçœç•¥äº† <code>goodbye:</code> å‚æ•°åï¼Œ<code>Void</code> è¿”å›ç±»å‹çš„å®šä¹‰ï¼Œè¿˜æœ‰è·Ÿåœ¨åé¢çš„ <code>in</code>ã€‚æ¯ä¸€ä¸ªå‚æ•°ä¾æ®å®ƒä»¬åœ¨é—­åŒ…ä¸­å®šä¹‰çš„é¡ºåºè€Œå‘½åã€‚å› ä¸ºè¯­æ³•å¤ªç®€ç•¥äº†ï¼Œç”šè‡³èƒ½æŠŠæ‰€æœ‰çš„ä»£ç æ”¾åˆ°ä¸€è¡Œã€‚</p><p>å¦‚æœé—­åŒ…çš„å‚æ•°å¤šäºä¸€ä¸ªï¼Œå¯¹äºæ¯ä¸€ä¸ªåé¢çš„å‚æ•°ï¼Œå¢åŠ ç®€å†™å‚æ•°çš„æ•°å­—å°±å¯ä»¥äº†ã€‚</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">(goodbye: <span class="type">String</span>, name: <span class="type">String</span>, age: <span class="type">Int</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line"></div><div class="line"><span class="comment">// $0: goodbye</span></div><div class="line"><span class="comment">// $1: name</span></div><div class="line"><span class="comment">// $2: age</span></div></pre></td></tr></table></figure><h4 id="è¿”å›-Self"><a href="#è¿”å›-Self" class="headerlink" title="è¿”å› Self"></a>è¿”å› <code>Self</code></h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">-&gt; <span class="type">Self</span></div></pre></td></tr></table></figure><p>Swift 2.0 å‘å¸ƒçš„æ—¶å€™ï¼Œæ–°å¢äº†ä¸€äº›æ–¹æ³•ï¼Œæ¯”å¦‚ <code>map</code> å’Œ <code>flatMap</code>ï¼Œæ›´é…·çš„æ˜¯ï¼Œå¯ä»¥é€šè¿‡ç‚¹è¯­æ³•æŠŠè¿™äº›æ–¹æ³•ä¸²èµ·æ¥ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">[<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="literal">nil</span>, <span class="number">5</span>]</div><div class="line">    .flatMap &#123; $<span class="number">0</span> &#125;     <span class="comment">// æ¸…é™¤ nil</span></div><div class="line">    .<span class="built_in">filter</span> &#123; $<span class="number">0</span> &lt; <span class="number">3</span> &#125;  <span class="comment">// é€‰å‡ºå°äº 3 çš„å€¼</span></div><div class="line">    .<span class="built_in">map</span> &#123; $<span class="number">0</span> * <span class="number">100</span> &#125;   <span class="comment">// æ¯ä¸ªå€¼ä¹˜ 100</span></div><div class="line"><span class="comment">// [100, 200]</span></div></pre></td></tr></table></figure><p>æ˜¯ä¸æ˜¯å¾ˆé…·ï¼è¿™ç§è¯­æ³•<em>éå¸¸</em>ä¼˜é›…ï¼Œå¾ˆå®¹æ˜“é˜…è¯»å’Œç†è§£ï¼Œæˆ‘ä»¬åº”è¯¥å°½å¯èƒ½å¤šåœ°ä½¿ç”¨å®ƒä»¬ã€‚</p><p>å¦‚æœå­˜åœ¨ä¸€ä¸ª <code>String</code> çš„ extensionï¼Œåœ¨æ­¤æ–¹æ³•é‡Œé¢æˆ‘ä»¬åšäº†ä¸€äº›å¯¹äºè¿™ä¸ª <code>String</code> æœ¬èº«çš„æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™å‡½æ•°ä¸è¦è¿”å› <code>Void</code>ï¼Œè€Œè¿”å› <code>Self</code>ï¼Œ</p><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// extension UIView</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">with</span><span class="params">(backgroundColor: UIColor)</span></span> -&gt; <span class="type">Self</span> &#123;</div><div class="line">    backgroundColor = color</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">with</span><span class="params">(cornerRadius: CGFloat)</span></span> -&gt; <span class="type">Self</span> &#123;</div><div class="line">    layer.cornerRadius = <span class="number">3</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span></div><div class="line">&#125;</div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="keyword">let</span> view = <span class="type">UIView</span>(frame: <span class="type">CGRect</span>(x: <span class="number">0</span>, y: <span class="number">0</span>, width: <span class="number">10</span>, height: <span class="number">10</span>))</div><div class="line">          .with(backgroundColor: .black)</div><div class="line">          .with(cornerRadius: <span class="number">3</span>)</div></pre></td></tr></table></figure><h4 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h4><p>ä¸ç®¡ä½ æ˜¯åœ¨å†™æ–°çš„ä»£ç è¿˜æ˜¯åœ¨é˜…è¯»æ—§çš„ä»£ç ï¼Œä½ å¯èƒ½ä¼šå‘ç°åœ¨è¿™é‡Œå­¦ä¹ åˆ°çš„å¯ä»¥åº”ç”¨åˆ°ä½ çš„éƒ¨åˆ†ä»£ç é‡Œã€‚Xcode è‡ªåŠ¨è¡¥å…¨çš„ä»£ç å’Œä½ è‡ªå·±å†™çš„ä»£ç ä¸ä¸€å®šæ˜¯æ­£ç¡®çš„ï¼Œæ‰€ä»¥åº”å½“ä¸€ç›´ä¿æŒè´¨ç–‘ã€‚</p><p><em>ç¤ºä¾‹ä»£ç å¯ä»¥åœ¨ GitHub ä¸Šæ‰¾åˆ°</em> <a href="https://github.com/andyyhope/Blog_SyntaxCheatCodes" target="_blank" rel="external"><em>playground</em></a>ï¼Œ <a href="https://gist.github.com/andyyhope/7ed96045d3560e8050994662cb97db87" target="_blank" rel="external"><em>Gist</em></a>ã€‚</p><p><em>æ¬¢è¿é˜…è¯»æˆ‘çš„</em><a href="https://medium.com/@AndyyHope" target="_blank" rel="external"><em>å…¨éƒ¨æ–‡ç« </em></a>ï¼Œ <em>ä½ ä¹Ÿå¯ä»¥åœ¨</em> <a href="https://twitter.com/AndyyHope" target="_blank" rel="external"><em>Twitter</em></a> <em>ä¸Šæ‰¾åˆ°æˆ‘ã€‚æˆ‘åœ¨æ¾³å¤§åˆ©äºšåˆ›åŠäº†</em> <a href="http://www.playgroundscon.com/" target="_blank" rel="external"><em>Playgrounds Conference</em></a> <em>æœŸå¾…åœ¨ä¸‹æ¬¡æ´»åŠ¨ä¸­çœ‹åˆ°ä½ çš„èº«å½±ã€‚</em></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŸæ–‡é“¾æ¥=&lt;a href=&quot;https://medium.com/swift-programming/swift-syntax-cheat-codes-9ce4ab4bc82e#.qrmtczdec&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https
      
    
    </summary>
    
    
      <category term="ç¿»è¯‘" scheme="http://zhaoxinyu.me/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>è¯» Apple Sample Code ä¹‹ Simple Ping</title>
    <link href="http://zhaoxinyu.me/2017-04-12-simple-ping/"/>
    <id>http://zhaoxinyu.me/2017-04-12-simple-ping/</id>
    <published>2017-04-13T14:59:00.000Z</published>
    <updated>2017-05-14T08:03:55.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨ç¿» <a href="https://developer.apple.com/library/content/navigation/" target="_blank" rel="external">Apple Developer Guides and Sample Code</a> çš„æ—¶å€™ï¼Œé¡ºç€ Network é‚£ä¸€æ å¾€ä¸‹ç¿»ï¼Œçœ‹åˆ°äº†ä¸€ä¸ª <a href="https://en.wikipedia.org/wiki/Ping_(networking_utility" target="_blank" rel="external">ping</a>) çš„<a href="https://developer.apple.com/library/content/samplecode/SimplePing/Introduction/Intro.html#//apple_ref/doc/uid/DTS10000716" target="_blank" rel="external">å°è£…å®ç°</a>ã€‚ping æ˜¯ä¸€ä¸ªéå¸¸å¸¸ç”¨çš„å‘½ä»¤ï¼Œç›¸ä¿¡å¤§å®¶æˆ–å¤šæˆ–å°‘éƒ½æœ‰ç”¨è¿‡ã€‚</p><p>è¿™ä¸ªç¤ºä¾‹çš„å°è£…å®ç°äº†æœ€åŸºæœ¬çš„ ping åŠŸèƒ½ï¼Œå…¶ä¸­åŒ…æ‹¬ resolve hostï¼Œcreate socket(send &amp; recv data), è§£æ ICMP åŒ…éªŒè¯ checksum ç­‰ã€‚åŒæ—¶æ”¯æŒ iPv4 å’Œ iPv6ã€‚å…¶å®å°±æ˜¯å¯¹ Core Foundation ä¸­ç½‘ç»œç›¸å…³çš„ C å‡½æ•°çš„å°è£…ã€‚</p><h2 id="ping"><a href="#ping" class="headerlink" title="ping"></a>ping</h2><p>ping æ˜¯é€šè¿‡ç½‘ç»œå±‚çš„ IP åè®®å‘é€ ICMP åè®®çš„æ•°æ®åŒ…ï¼Œç„¶åç­‰å¾…ç›®æ ‡å›ä¼  ICMP æ•°æ®åŒ…ï¼Œé€šè¿‡æ—¶é—´å’ŒæˆåŠŸå“åº”çš„æ¬¡æ•°ä¼°ç®—ä¸¢åŒ…ç‡å’Œç½‘ç»œæ—¶å»¶ã€‚</p><p>å…¶å® ping å¹¶ä¸èƒ½å®Œå…¨ä»£è¡¨ä½ èƒ½ä¸èƒ½è¿æ¥ä¸Šé‚£ä¸ª hostï¼Œåƒ zhihu.com å°±å°æ‰äº† ICMPï¼ˆping å°±æ²¡åŠæ³•å·¥ä½œäº†ï¼Œä¸€ç›´æç¤ºè¶…æ—¶ï¼‰ï¼Œä½†æ˜¯é€šè¿‡æµè§ˆå™¨ï¼ˆHTTPï¼‰è¿˜æ˜¯èƒ½æ‰“å¼€çŸ¥ä¹çš„ã€‚</p><h2 id="Demo-ä¸­-SimplePing-çš„ä½¿ç”¨"><a href="#Demo-ä¸­-SimplePing-çš„ä½¿ç”¨" class="headerlink" title="Demo ä¸­ SimplePing çš„ä½¿ç”¨"></a>Demo ä¸­ SimplePing çš„ä½¿ç”¨</h2><p>ä¸‹è½½å¥½æºç ï¼Œå‘ç° demo æ˜¯ç”¨ Swift å†™çš„ï¼å¯æƒœå®ƒä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯ 2.3ï¼ˆç›®å‰çš„ Swift ç‰ˆæœ¬æ˜¯ 3.1ï¼‰ï¼Œçœ‹æ¥ Apple çš„è¿™äº› Sample Code æ›´æ–°çš„ä¸æ˜¯å¾ˆåŠæ—¶ã€‚ä¸è¿‡è¿˜å¥½ä»£ç é‡æ¯”è¾ƒå°‘ï¼ŒXcode å¸®å¿™å‡çº§ï¼Œè‡ªå·±å† fix ä¸€ä¸¤å¤„ï¼Œé¡¹ç›®å°±å¯ä»¥ run èµ·æ¥äº†ã€‚</p><p>Demo ä¸­ä½¿ç”¨ SimplePing çš„åŸºæœ¬æµç¨‹å¦‚ä¸‹ï¼Œ</p><p><img src="media/2017-04-15-simple-ping-01.png" alt=""></p><p>å…¶å®ä¸»è¦çš„æµç¨‹ä¹Ÿå°±ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼Œ</p><ul><li>åˆå§‹åŒ–ã€‚åŒ…æ‹¬åˆ›å»º pinger å¯¹è±¡ï¼Œè®¾ç½®æƒ³è¦ iPv4 è¿˜æ˜¯ iPv6 çš„åœ°å€ï¼Œè®¾ç½® delegate</li><li>è°ƒç”¨ <code>start()</code> æ–¹æ³•ï¼Œå¼€å¯ ping çš„æµç¨‹ã€‚pinger ä¼šæŠŠå¯¹åº”çš„ host è§£ææˆ IP åœ°å€</li><li>åœ¨éœ€è¦çš„æƒ…å†µä¸‹è°ƒç”¨ <code>send</code> æ–¹æ³•ã€‚æ¢æµ‹å¯¹åº”çš„ hostï¼Œdelegate ä¸­çš„å›è°ƒå°±ä¼šå¾—åˆ°å¯¹åº”çš„å›åº”äº†ã€‚ </li></ul><h2 id="SimplePing-çš„å®ç°åŸç†"><a href="#SimplePing-çš„å®ç°åŸç†" class="headerlink" title="SimplePing çš„å®ç°åŸç†"></a>SimplePing çš„å®ç°åŸç†</h2><p>ping çš„å®ç°è¿‡ç¨‹å¹¶ä¸å¤æ‚ï¼Œä¸€å…±ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼Œ</p><ul><li>è§£æä¼ å…¥çš„ hostï¼Œè·å–ç¬¬ä¸€ä¸ªå¯ç”¨ IP åœ°å€</li><li>åˆ›å»ºä¼ è¾“/æ¥æ”¶æ•°æ®çš„ socket</li><li>å‘é€æ•°æ®ï¼Œå°è£…ä¸€ä¸ª ICMP åŒ… </li><li>è§£æç›®æ ‡ IP ä¼ å›çš„ ICMP åŒ…</li></ul><p>ä¸è¦è§‰å¾— ICMP åŒ…ä¹‹ç±»æ˜¯ä»€ä¹ˆé«˜æ·±é«˜éš¾çš„è¯è¯­ï¼Œå…¶å®å®ƒå°±æ˜¯ä¸€ä¸ªåè®®ã€‚åŒæ–¹è§„å®šå¥½ä¸€ä¸ªæ•°æ®åŒ…çš„å‰å‡ ä¸ªå­—èŠ‚æ˜¯ä»€ä¹ˆï¼Œåå‡ ä¸ªå­—èŠ‚æ˜¯ä»€ä¹ˆï¼ŒåŒæ–¹æŒ‰ç…§æ­£ç¡®çš„æ ¼å¼å°è£…åŒ…çš„æ•°æ®å‘é€æˆ–è€…è§£æå°±å¯ä»¥äº†ã€‚</p><p><img src="media/2017-04-15-simple-ping-02.png" alt=""></p><p>ICMP æ˜¯ä½äºç½‘ç»œå±‚çš„ä¸€ä¸ªåè®®ï¼Œå®ƒä¾é  IP æ¥å®Œæˆå·¥ä½œã€‚å¦‚ä¸Šå›¾æ‰€ç¤ºï¼ŒICMP çš„åŒ…ä¼šæœ‰ IP çš„ headerï¼Œä½†è¿™ä¸ª header å¯¹äºæˆ‘ä»¬å®ç° ping æ˜¯æ²¡æœ‰ä»€ä¹ˆå¿…è¦æ€§çš„ï¼Œå¯ä»¥çœ‹åˆ°ä»£ç ä¹Ÿæœ‰ä¸€ä¸ªæ–¹æ³• <code>icmpHeaderOffsetInIPv4Packet:</code> è®¡ç®— IP header çš„ offset ä»è€Œç›´æ¥è·³è¿‡ IP å¤´ã€‚</p><p>Simple Ping ä¹Ÿå¯¹ ICMPHeader ä¹Ÿåšå‡ºäº†å®šä¹‰ï¼Œ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ICMPHeader</span> &#123;</span></div><div class="line">    <span class="comment">// iPv4 or iPv6</span></div><div class="line">    <span class="keyword">uint8_t</span>     type;</div><div class="line">    <span class="comment">// 0</span></div><div class="line">    <span class="keyword">uint8_t</span>     code;</div><div class="line">    <span class="comment">// 0</span></div><div class="line">    <span class="keyword">uint16_t</span>    checksum;</div><div class="line">    <span class="comment">// åˆå§‹åŒ– host çš„æ—¶å€™éšæœºç”Ÿæˆçš„ id</span></div><div class="line">    <span class="keyword">uint16_t</span>    identifier;</div><div class="line">    <span class="comment">// ç±»å†…éƒ¨ç»´æŠ¤çš„ï¼Œå‘é€ ping æ•°æ®çš„åºå·</span></div><div class="line">    <span class="keyword">uint16_t</span>    sequenceNumber;</div><div class="line">    <span class="comment">// data...</span></div><div class="line">&#125;;</div><div class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">ICMPHeader</span> <span class="title">ICMPHeader</span>;</span></div></pre></td></tr></table></figure><p>å‘é€ ping æ•°æ®çš„æ—¶å€™ï¼Œä¼šå¯¹ä¸€ä¸ª ICMPHeader ç»“æ„ä½“è¿›è¡Œåˆå§‹åŒ–ï¼Œé™¤äº†ä¸Šè¿°çš„å‡ ä¸ªå­—æ®µï¼Œç»“åˆä¸Šé¢çš„é‚£å¼ å›¾çœ‹åˆ°ï¼Œè¿˜æœ‰ payloadï¼Œå¦‚æœè°ƒç”¨è€…æ²¡æœ‰æŒ‡å®šå‘é€çš„ payloadï¼Œæ–¹æ³•å†…éƒ¨ä¼šæ·»åŠ é»˜è®¤çš„ payloadã€‚</p><p>æ¥æ”¶å›åº”çš„æ—¶å€™ï¼Œä¼šå¯¹ ICMP åŒ…è¿›è¡Œæ ¡éªŒï¼Œä¹Ÿä¼šè·³è¿‡ IP å¤´ï¼Œå…¶ä¸­ä¸»è¦éªŒè¯çš„å­—æ®µæ˜¯ checksum å’Œ sequenceNumberï¼ˆiPv6 åªéœ€è¦éªŒè¯ sequenceNumberï¼‰ã€‚checksum çš„è®¡ç®—æ ¹æ®çš„æ˜¯æ ‡å‡†çš„ BSD checksum ç”Ÿæˆå‡½æ•°ï¼Œä¸»è¦ä¾æ®æ˜¯ ICMP åŒ…ï¼Œè®¡ç®—è§„åˆ™æ²¡ç»†çœ‹ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ç§æ ‡å‡†å˜›ï¼ˆæƒ³çœ‹çš„åŒå­¦å¯ä»¥çœ‹è¿™é‡Œ <a href="https://en.wikipedia.org/wiki/IPv4_header_checksum" target="_blank" rel="external">IPv4 header checksum</a>ï¼‰ã€‚</p><p>è‡³æ­¤ï¼Œä¸€æ¬¡ ping çš„å®Œæ•´æµç¨‹å°±ç»“æŸäº†ã€‚</p><h2 id="å…³äº-Core-Foundation"><a href="#å…³äº-Core-Foundation" class="headerlink" title="å…³äº Core Foundation"></a>å…³äº Core Foundation</h2><p>ä¸Šæ¬¡çœ‹äº† Reachabilityï¼Œè¿™æ¬¡çœ‹äº† Simple Pingï¼Œå…¶å®éƒ½æ˜¯å¯¹ Core Foundation ä¸­çš„ C å‡½æ•°è¿›è¡Œå°è£…ã€‚å…¶ä¸­è®©æˆ‘è§‰å¾—æ¯”è¾ƒå…³é”®çš„ç‚¹å°±æ˜¯å¯¹ Core Foundation ä¸­å¼‚æ­¥å‡½æ•°çš„è°ƒç”¨å’Œå†…å­˜ç®¡ç†é—®é¢˜ã€‚</p><h3 id="å¼‚æ­¥å‡½æ•°çš„è°ƒç”¨"><a href="#å¼‚æ­¥å‡½æ•°çš„è°ƒç”¨" class="headerlink" title="å¼‚æ­¥å‡½æ•°çš„è°ƒç”¨"></a>å¼‚æ­¥å‡½æ•°çš„è°ƒç”¨</h3><p>Core Foundation ä¸­çš„å¼‚æ­¥æ–¹æ³•è®¾ç½®ä¸€èˆ¬éœ€è¦ä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)start &#123;</div><div class="line">    Boolean             success;</div><div class="line">    <span class="built_in">CFHostClientContext</span> context = &#123;<span class="number">0</span>, (__bridge <span class="keyword">void</span> *)(<span class="keyword">self</span>), <span class="literal">NULL</span>, <span class="literal">NULL</span>, <span class="literal">NULL</span>&#125;;</div><div class="line">    <span class="built_in">CFStreamError</span>       streamError;</div><div class="line"></div><div class="line">    <span class="comment">// 1. åˆ›å»ºç›¸å…³çš„ contextï¼Œä¸€èˆ¬éƒ½æ˜¯æŠŠ self å­˜åˆ° info å­—æ®µä¸­ï¼Œæ–¹ä¾¿ä» callback ä¸­æå–å‡ºå¯¹è±¡ç„¶åè°ƒç”¨å¤„ç†çš„ Objective-C æ–¹æ³•</span></div><div class="line">    <span class="keyword">self</span>.host = (<span class="built_in">CFHostRef</span>) <span class="built_in">CFAutorelease</span>( <span class="built_in">CFHostCreateWithName</span>(<span class="literal">NULL</span>, (__bridge <span class="built_in">CFStringRef</span>) <span class="keyword">self</span>.hostName) );</div><div class="line">    <span class="comment">// 2. åˆ›å»ºä¸€ä¸ªä¸ callback å‡½æ•°æŒ‡é’ˆç›¸åŒç­¾åçš„é™æ€å‡½æ•°ï¼Œå¤„ç†å¼‚æ­¥æ–¹æ³•å›è°ƒåçš„é€»è¾‘ï¼Œè®¾ç½® context ç­‰ç›¸å…³å‚æ•°  </span></div><div class="line">    <span class="built_in">CFHostSetClient</span>(<span class="keyword">self</span>.host, HostResolveCallback, &amp;context);</div><div class="line">    <span class="comment">// 3. è®¾ç½®å‡½æ•°éœ€è¦æ‰§è¡Œçš„ runloop åŠ runloop mode</span></div><div class="line">    <span class="built_in">CFHostScheduleWithRunLoop</span>(<span class="keyword">self</span>.host, <span class="built_in">CFRunLoopGetCurrent</span>(), kCFRunLoopDefaultMode);</div><div class="line">    <span class="comment">// 4. å¼€å§‹æ‰§è¡Œï¼Œå¦‚æœæˆåŠŸï¼Œé‚£æˆ‘ä»¬çš„ callback å°±ä¼šè¢«è°ƒç”¨ï¼Œå¤±è´¥ä¼šç«‹å³è¿”å› nil</span></div><div class="line">    success = <span class="built_in">CFHostStartInfoResolution</span>(<span class="keyword">self</span>.host, kCFHostAddresses, &amp;streamError);</div><div class="line">    <span class="keyword">if</span> (!success) &#123;</div><div class="line">        <span class="comment">// handle error</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// åœ¨ callback ä¸­ï¼Œå°±å¯ä»¥å–å‡ºæˆ‘ä»¬ä¹‹å‰ä¼ å…¥çš„ info ç­‰å­—æ®µï¼ˆä¹Ÿå°±æ˜¯æ³¨å†Œå›è°ƒçš„ SimplePing å¯¹è±¡ï¼‰</span></div><div class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">HostResolveCallback</span><span class="params">(CFHostRef theHost, CFHostInfoType typeInfo, <span class="keyword">const</span> CFStreamError *error, <span class="keyword">void</span> *info)</span> </span>&#123;</div><div class="line">    <span class="comment">/// ä» info ä¸­å°±å¯ä»¥å–å‡º Objective-C ä¸­çš„ object</span></div><div class="line">    SimplePing *obj = (__bridge SimplePing *) info;</div><div class="line">    <span class="comment">/// .... </span></div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æœ¬è´¨ä¸Šå°±æ˜¯ä» C çš„é™æ€æ–¹æ³•åˆ°è°ƒç”¨ Objective-C å¯¹è±¡æ–¹æ³•çš„è¿‡ç¨‹ï¼Œå¤šæ•°çš„å¼‚æ­¥å‡½æ•°éƒ½æ˜¯è¿™ç§è°ƒç”¨æ–¹å¼ï¼ŒåŸºæœ¬éƒ½æ˜¯å¥—è·¯åŒ–çš„ï¼ŒåŒæ—¶ä¹Ÿæ¯”è¾ƒåŸå§‹ï¼Œéœ€è¦å†™å¾ˆå¤šä»£ç ã€‚</p><h3 id="å†…å­˜ç®¡ç†"><a href="#å†…å­˜ç®¡ç†" class="headerlink" title="å†…å­˜ç®¡ç†"></a>å†…å­˜ç®¡ç†</h3><p>Core Foundation å¹¶ä¸æ”¯æŒ ARCï¼Œå®ƒé‡Œé¢çš„å¯¹è±¡éƒ½æ˜¯éœ€è¦æ‰‹åŠ¨ç®¡ç†å†…å­˜çš„ã€‚</p><p>æ ¹æ® Apple çš„<a href="https://developer.apple.com/library/content/documentation/CoreFoundation/Conceptual/CFDesignConcepts/Articles/tollFreeBridgedTypes.html" target="_blank" rel="external">æ–‡æ¡£</a>ï¼Œ</p><blockquote><p>The compiler does not automatically manage the lifetimes of Core Foundation objects. You tell the compiler about the ownership semantics of objects using either a cast (defined in objc/runtime.h) or a Core Foundation-style macro (defined in NSObject.h):</p><ul><li><code>__bridge</code> transfers a pointer between Objective-C and Core Foundation with no transfer of ownership.</li><li><code>__bridge_retained</code> or <code>CFBridgingRetain</code> casts an Objective-C pointer to a Core Foundation pointer and also transfers ownership to you.<br>You are responsible for calling CFRelease or a related function to relinquish ownership of the object.</li><li><code>__bridge_transfer</code> or <code>CFBridgingRelease</code> moves a non-Objective-C pointer to Objective-C and also transfers ownership to ARC.<br>ARC is responsible for relinquishing ownership of the object.</li></ul></blockquote><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œ</p><ul><li>åˆ©ç”¨ Core Foundation API åˆ›å»ºå‡ºæ¥çš„å¯¹è±¡ï¼ˆä¸€èˆ¬æ˜¯æŒ‡é’ˆç±»å‹çš„ï¼‰ï¼Œæœ€åéƒ½éœ€è¦æˆ‘ä»¬è‡ªå·±é‡Šæ”¾ï¼ˆCFReleaseï¼‰</li><li>é€šè¿‡ <code>__bridge</code> è½¬æ¢ OC å’Œ CF å¯¹è±¡åªæ¶‰åŠç±»å‹çš„å˜åŒ–ï¼Œå†…å­˜ç®¡ç†æƒå¹¶ä¸å‘ç”Ÿæ”¹å˜</li><li>é€šè¿‡ <code>__bridge_retained</code> æˆ– <code>CFBridgingRetain</code> æŠŠ OC -&gt; CF å¯¹è±¡ï¼Œæ­¤æ—¶è¿™ä¸ªå¯¹è±¡çš„å†…å­˜éœ€è¦ä½ æ‰‹åŠ¨ç®¡ç†</li><li>é€šè¿‡ <code>__bridge_transfer</code> æˆ– <code>CFBridgingRelease</code> æŠŠ CF -&gt; OC å¯¹è±¡ï¼Œå®ƒä¹‹åçš„å†…å­˜å°±äº¤ç»™ ARC æ¥ç®¡ç†ï¼Œä½ å°±ä¸éœ€è¦è´Ÿè´£å®ƒçš„å†…å­˜å¤„ç†äº†</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨ç¿» &lt;a href=&quot;https://developer.apple.com/library/content/navigation/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;Apple Developer Guides and Sample Cod
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Objective-C" scheme="http://zhaoxinyu.me/tags/Objective-C/"/>
    
  </entry>
  
  <entry>
    <title>è¯» AFNetworking æºç ä¹‹ Reachability</title>
    <link href="http://zhaoxinyu.me/2017-04-11-Reachability/"/>
    <id>http://zhaoxinyu.me/2017-04-11-Reachability/</id>
    <published>2017-04-11T02:59:00.000Z</published>
    <updated>2017-04-11T16:46:47.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Reachability-æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#Reachability-æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="Reachability æ˜¯ä»€ä¹ˆï¼Ÿ"></a>Reachability æ˜¯ä»€ä¹ˆï¼Ÿ</h2><p>æ ¹æ® Mac è‡ªå¸¦çš„è¯å…¸ï¼Œè¿™ä¸ªå•è¯çš„è‹±è‹±è§£é‡Šæ˜¯ <code>able to be contacted</code>ï¼Œé€šä¿—ä¸€ç‚¹å°±æ˜¯è¿æ¥çš„èƒ½åŠ›ã€‚è€Œæ”¾åˆ° App ä¸­å°±æ˜¯æœ‰æ²¡æœ‰è¿æ¥ç½‘ç»œçš„èƒ½åŠ›ã€‚</p><p>ç›¸ä¿¡å¤§å®¶åœ¨æ—¥å¸¸ä½¿ç”¨åº”ç”¨çš„æ—¶å€™éƒ½çœ‹åˆ°è¿‡ã€‚åœ¨ä¸åŒçš„ç½‘ç»œæ¡ä»¶ä¸‹ï¼ŒApp çš„æŸäº›è¡Œä¸ºä¼šæœ‰æ‰€ä¸åŒã€‚æ¯”å¦‚å¯¹äºå¤šåª’ä½“ç´ ææ¥è¯´ï¼Œç§»åŠ¨ç½‘ç»œä¸‹é€šå¸¸ä¼šè¯·æ±‚ä½è´¨é‡ç‰ˆæœ¬ï¼Œè€Œ Wi-Fi ä¸‹ä¼šå°½é‡ä¸‹è½½å¤§å°ºå¯¸ç”šè‡³åŸå°ºå¯¸ã€‚è¿˜æœ‰ï¼Œåœ¨ Wi-Fi æ¡ä»¶ä¸‹æ’­æ”¾è§†é¢‘çš„æ—¶å€™ï¼Œå¦‚æœç”¨æˆ·çš„ Wi-Fi çªç„¶æ–­æ‰äº†ï¼Œé‚£ App åº”è¯¥è‡ªåŠ¨æš‚åœè§†é¢‘æ’­æ”¾åŠé¢„å–ç¼“å­˜ï¼Œå¹¶å¼¹çª—æç¤ºç”¨æˆ·ã€‚</p><p>æ€»ç»“ä¸€ä¸‹ï¼Œå½“ä½ æƒ³çŸ¥é“å½“å‰çš„è®¾å¤‡æ˜¯è¿ç€ Wi-Fi è¿˜æ˜¯è¿ç€ 4Gï¼Œæˆ–è€…ä½ æƒ³åœ¨ç”¨æˆ·è®¾å¤‡ç½‘ç»œæ¡ä»¶å‘ç”Ÿå˜åŒ–çš„æ—¶å€™å¾—åˆ°é€šçŸ¥ï¼Œé‚£ä½ å°±è¯¥ä½¿ç”¨ Reachability äº†ã€‚</p><h2 id="Reachability-çš„å‡ ä¸ªå®ç°"><a href="#Reachability-çš„å‡ ä¸ªå®ç°" class="headerlink" title="Reachability çš„å‡ ä¸ªå®ç°"></a>Reachability çš„å‡ ä¸ªå®ç°</h2><p>ç›®å‰ç½‘ç»œä¸Šå¤§æ¦‚æœ‰ä¸‰ç§å®ç°</p><ul><li><a href="https://developer.apple.com/library/content/samplecode/Reachability/Introduction/Intro.html" target="_blank" rel="external">Apple Sample Code - Reachability</a></li><li><a href="https://github.com/AFNetworking/AFNetworking/blob/master/AFNetworking/AFNetworkReachabilityManager.h" target="_blank" rel="external">AFNetworking - AFNetworkReachabilityManager</a></li><li><a href="https://github.com/tonymillion/Reachability" target="_blank" rel="external">tonymillion/Reachability</a></li></ul><p>è€Œå®ƒä»¬æœ¬è´¨ä¸Šéƒ½æ˜¯å¯¹ SystemConfiguration Framework ä¸­ <code>SCNetworkReachability.h</code> ç›¸å…³çš„ C API è¿›è¡Œå°è£…ï¼Œä»¥å®ç°ç›¸åŒçš„æ•ˆæœã€‚</p><h2 id="AFNetworkReachabilityManager"><a href="#AFNetworkReachabilityManager" class="headerlink" title="AFNetworkReachabilityManager"></a>AFNetworkReachabilityManager</h2><p>ç”±äºä¸‰ä¸ªå°è£…çš„åŸç†ä»¥åŠå®ç°çš„åŠŸèƒ½éƒ½å¤§åŒå°å¼‚ï¼Œä½†åœ¨è¿™é‡Œä¼šè¯¦ç»†ä»‹ç»ä¸€ä¸‹ AFNetworkingï¼ˆç”¨ Objective-C å¼€å‘çš„åŒå­¦ï¼Œé¡¹ç›®é‡Œåº”è¯¥ 95% ä»¥ä¸Šéƒ½ä¼šä¾èµ– AFNetworking å§ï¼‰ç‰ˆæœ¬çš„ä½¿ç”¨ä»¥åŠå®ç°ã€‚</p><h3 id="ä½¿ç”¨åŠæ³¨æ„äº‹é¡¹"><a href="#ä½¿ç”¨åŠæ³¨æ„äº‹é¡¹" class="headerlink" title="ä½¿ç”¨åŠæ³¨æ„äº‹é¡¹"></a>ä½¿ç”¨åŠæ³¨æ„äº‹é¡¹</h3><h4 id="1-åˆå§‹åŒ–å¯¹è±¡"><a href="#1-åˆå§‹åŒ–å¯¹è±¡" class="headerlink" title="1. åˆå§‹åŒ–å¯¹è±¡"></a>1. åˆå§‹åŒ–å¯¹è±¡</h4><p>AFNetworkReachabilityManager æ¯”è¾ƒå¸¸ç”¨çš„å‡ ä¸ªåˆå§‹åŒ–æ–¹æ³•å¦‚ä¸‹ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// è·å–å…¨å±€å”¯ä¸€å•ä¾‹</span></div><div class="line">+ (<span class="keyword">instancetype</span>)sharedManager;</div><div class="line"><span class="comment">/// å®ä¾‹åŒ–ä¸€ä¸ªç›‘å¬é»˜è®¤åœ°å€ï¼ˆ0.0.0.0ï¼‰çš„ manager</span></div><div class="line">+ (<span class="keyword">instancetype</span>)manager;</div><div class="line"><span class="comment">/// å®ä¾‹åŒ–ä¸€ä¸ªç›‘å¬ç»™å®š domain çš„ manager</span></div><div class="line">+ (<span class="keyword">instancetype</span>)managerForDomain:(<span class="built_in">NSString</span> *)domain;</div></pre></td></tr></table></figure><blockquote><p>Note: Reachability cannot tell your application if you can connect to a particular host, only that an interface is available that might allow a connection, and whether that interface is the WWAN.</p></blockquote><p>é¦–å…ˆè¦æ¾„æ¸…ä¸€ä¸ªæ¦‚å¿µï¼Œæ ¹æ® Apple çš„æ–‡æ¡£ï¼ŒReachability å¹¶ä¸èƒ½åƒ <code>ping</code> ä¸€æ ·ï¼Œæ‰€ä»¥åœ¨å¤©æœä¸è¦çœ‹åˆ° Reachability èƒ½å¤Ÿé€šè¿‡ Wi-Fi è¿æ¥åˆ° <code>www.youtube.com</code> å°±å¦„æƒ³ä½ å¯ä»¥ä¸Š YouTube äº†ï¼Œä½ åªæ˜¯<strong>å¯èƒ½</strong>é€šè¿‡ Wi-Fi è¿æ¥åˆ°é‚£ä¸ª hostï¼Œè€Œä¸æ˜¯<strong>ä¸€å®š</strong>å¯ä»¥è¿æ¥ä¸Šã€‚</p><p>è¿™é‡Œæ¯”è¾ƒå»ºè®®è°ƒç”¨ <code>+ (instancetype)manager</code> åˆ›å»ºå±äºè‡ªå·±çš„ managerï¼Œå¥½å¤„æˆ‘ä»¬åé¢è®²ã€‚</p><h4 id="2-å¼€å¯ç›‘å¬"><a href="#2-å¼€å¯ç›‘å¬" class="headerlink" title="2. å¼€å¯ç›‘å¬"></a>2. å¼€å¯ç›‘å¬</h4><p>é¦–å…ˆéœ€è¦è°ƒç”¨å¼€å¯ç›‘å¬çš„æ–¹æ³•ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// è¿™æ˜¯å¾ˆå®¹æ˜“è¢«å¿½è§†çš„æ–¹æ³•ï¼Œä¸æ˜¯åˆå§‹åŒ–äº† manager å°±é»˜è®¤å¼€å§‹ç›‘å¬çš„</span></div><div class="line">- (<span class="keyword">void</span>)startMonitoring;</div></pre></td></tr></table></figure><p>å¦‚æœä½ åªæƒ³çŸ¥é“å½“å‰çš„ç½‘ç»œæ¡ä»¶æ˜¯ä»€ä¹ˆï¼Œé€šè¿‡ manager çš„ä¸‹é¢ä¸‰ä¸ªå±æ€§å°±å¯ä»¥äº†è§£äº†ï¼Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">BOOL reachable;         // æœ‰æ— ç½‘ç»œè¿æ¥</div><div class="line">BOOL reachableViaWWAN   // å½“å‰æ˜¯ç§»åŠ¨ç½‘ç»œ</div><div class="line">BOOL reachableViaWiFi   // å½“å‰æ˜¯ Wi-Fi</div></pre></td></tr></table></figure><h4 id="3-æ¥æ”¶é€šçŸ¥"><a href="#3-æ¥æ”¶é€šçŸ¥" class="headerlink" title="3. æ¥æ”¶é€šçŸ¥"></a>3. æ¥æ”¶é€šçŸ¥</h4><p>AFNetworking çš„ Reachability Manager æä¾›äº†ä¸¤ç§è·å–ç½‘ç»œæ¡ä»¶å‘ç”Ÿå˜åŒ–çš„æ–¹å¼ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// é€šè¿‡è®¾ç½® manager çš„ statusChangeBlockï¼Œç›‘å¬å˜åŒ–</span></div><div class="line">- (<span class="keyword">void</span>)setReachabilityStatusChangeBlock:(<span class="keyword">nullable</span> <span class="keyword">void</span> (^)(AFNetworkReachabilityStatus status))block;</div><div class="line"></div><div class="line"><span class="comment">/// é€šè¿‡ç›‘å¬ä¸€ä¸ª manager å‘å‡ºçš„ notificationï¼Œuserinfo ä¸­çš„</span></div><div class="line"><span class="comment">/// `AFNetworkingReachabilityNotificationStatusItem` key å°±æ˜¯å½“å‰çš„ status</span></div><div class="line">FOUNDATION_EXPORT <span class="built_in">NSString</span> * <span class="keyword">const</span> AFNetworkingReachabilityDidChangeNotification;</div></pre></td></tr></table></figure><p>è¿™é‡Œå°±è¦è§£é‡Šä¸€ä¸‹ä¸Šæ–‡ä¸­æåˆ°é—®é¢˜ï¼Œä¸ºä»€ä¹ˆä¸å»ºè®®ä½¿ç”¨ <code>+ (instancetype)sharedManager;</code> è·å¾—å•ä¾‹</p><p>å› ä¸º <code>setReachabilityStatusChangeBlock</code> çš„å›è°ƒé€šçŸ¥çš„æ–¹å¼åªä¼šå¯¹æœ€æ–°è°ƒç”¨çš„åœ°æ–¹æ‰ä¼šç”Ÿæ•ˆï¼Œå¦‚æœå¤§å®¶éƒ½ç”¨ <code>sharedManager</code> è·å– managerï¼Œç„¶ååœ¨è‡ªå·±çš„ä¸šåŠ¡é‡Œè®¾ç½®å›è°ƒçš„ blockï¼Œå¦‚æœæ­¤æ—¶å¤šä¸ªä¸šåŠ¡éƒ½è·‘ç€ï¼Œé‚£åœ¨ç½‘ç»œæ¡ä»¶å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œé‚£ä¹Ÿåªæœ‰åœ¨æœ€åè¢«æ‰§è¡Œåˆ°çš„ä»£ç æ‰ä¼šè·å¾—é€šçŸ¥ï¼Œä¹‹å‰æ‰€æœ‰è®¾ç½® block çš„åœ°æ–¹éƒ½ä¼šå¤±æ•ˆï¼Œä¸ºäº†é¿å…è¿™ç§å°æ¦‚ç‡çš„äº‹æƒ…å‘ç”Ÿï¼Œè¿˜æ˜¯åº”è¯¥åœ¨è‡ªå·±çš„ä¸šåŠ¡é‡Œåˆ›å»ºè‡ªå·±çš„ managerã€‚</p><h4 id="4-åœæ­¢ç›‘å¬"><a href="#4-åœæ­¢ç›‘å¬" class="headerlink" title="4. åœæ­¢ç›‘å¬"></a>4. åœæ­¢ç›‘å¬</h4><p>ä¸éœ€è¦ç›‘å¬ç½‘ç»œæ¡ä»¶å‘ç”Ÿå˜åŒ–çš„æ—¶å€™è°ƒç”¨æ­¤æ–¹æ³•ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)stopMonitoring;</div></pre></td></tr></table></figure><h3 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h3><p>å…ˆæ¥åˆ†æä¸€ä¸‹ manager çš„åˆå§‹åŒ–ã€‚å®ƒæœ‰ä¸€ä¸ª designated initializerï¼Œä¹Ÿå°±æ˜¯æ‰€æœ‰çš„åˆå§‹åŒ–æ–¹æ³•éƒ½ä¼šæœ€ç»ˆè°ƒç”¨è¿™ä¸ªæ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼ˆé¡ºä¾¿å¸®æˆ‘ä»¬å¤ä¹ äº†ä¸€æŠŠåˆå§‹åŒ–æ–¹æ³•çš„è®¾è®¡ï¼‰ï¼Œ</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">instancetype</span>)initWithReachability:(<span class="built_in">SCNetworkReachabilityRef</span>)reachability &#123;</div><div class="line">    <span class="keyword">self</span> = [<span class="keyword">super</span> init];</div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    _networkReachability = <span class="built_in">CFRetain</span>(reachability);</div><div class="line">    <span class="keyword">self</span>.networkReachabilityStatus = AFNetworkReachabilityStatusUnknown;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å®ƒæ¥å—ä¸€ä¸ªè¢«å®šä¹‰åœ¨ <code>SystemConfiguration/SystemConfiguration.h</code> ä¸­ <code>SCNetworkReachabilityRef</code> çš„ç»“æ„ä½“æŒ‡é’ˆä¸ºå‚æ•°ã€‚</p><p>çœ‹åˆ°ä»¥ Ref ç»“å°¾çš„å¯¹è±¡ï¼Œå°±è¦æƒ³åˆ°å®ƒæ˜¯ Core Foundation ä¸­çš„å¯¹è±¡ç±»å‹ï¼Œè¿™äº›å¯¹è±¡åŸºæœ¬ä¸Šæ˜¯ C çš„æŒ‡é’ˆï¼Œç¼–è¯‘å™¨ä¸ä¼šå¸®ä½ è¿›è¡Œå†…å­˜ç®¡ç†ï¼Œæ‰€ä»¥éœ€è¦è°ƒç”¨ CF å¼€å¤´çš„ç›¸å…³ API è‡ªå·±æ‰‹åŠ¨è¿›è¡Œå†…å­˜ç®¡ç†ã€‚</p><p>ç”±äº manager æŒæœ‰ä¸€ä¸ª <code>SCNetworkReachabilityRef</code> çš„å¯¹è±¡ï¼Œæ‰€ä»¥åœ¨è¿™ä¸ªåˆå§‹åŒ–æ–¹æ³•é‡Œï¼Œå®ƒå¯¹è¿™ä¸ªå‚æ•°è¿›è¡Œäº† retain æ“ä½œï¼ŒåŒæ ·åœ°ï¼Œåœ¨ <code>dealloc</code> ä¸­è°ƒç”¨äº† release æ–¹æ³•å¯¹èµ„æºè¿›è¡Œé‡Šæ”¾ã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)dealloc &#123;</div><div class="line">    [<span class="keyword">self</span> stopMonitoring];</div><div class="line">    </div><div class="line">    <span class="comment">// æ³¨æ„ï¼Œ C å¯¹è±¡çš„åˆ¤ç©ºè¦å’Œ NULL æ¯”è¾ƒ</span></div><div class="line">    <span class="keyword">if</span> (_networkReachability != <span class="literal">NULL</span>) &#123;</div><div class="line">        <span class="built_in">CFRelease</span>(_networkReachability);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å…¶å®ƒçš„å‡ ä¸ª convenience initializers å°±æ˜¯é’ˆå¯¹ä¸åŒçš„éœ€æ±‚åˆ›å»ºä¸åŒçš„ <code>SCNetworkReachabilityRef</code> æŒ‡é’ˆã€‚</p><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)startMonitoring &#123;</div><div class="line">    <span class="comment">/// åœ¨å¯ç”¨æŸä¸ªåŠ¨ä½œä¹‹å‰å…ˆå…³é—­è¿™ä¸ªåŠ¨ä½œæ˜¯ä¸€ç§éå¸¸å¥½çš„ç¼–ç¨‹ä¹ æƒ¯</span></div><div class="line">    <span class="comment">/// é˜²æ­¢å¤šæ¬¡è°ƒç”¨æŸä¸ªæ–¹æ³•ä¼šå‘ç”Ÿå‰¯ä½œç”¨</span></div><div class="line">    [<span class="keyword">self</span> stopMonitoring];</div><div class="line"></div><div class="line">    <span class="keyword">if</span> (!<span class="keyword">self</span>.networkReachability) &#123;</div><div class="line">        <span class="keyword">return</span>;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    __<span class="keyword">weak</span> __<span class="keyword">typeof</span>(<span class="keyword">self</span>)weakSelf = <span class="keyword">self</span>;</div><div class="line">    AFNetworkReachabilityStatusBlock callback = ^(AFNetworkReachabilityStatus status) &#123;</div><div class="line">        __<span class="keyword">strong</span> __<span class="keyword">typeof</span>(weakSelf)strongSelf = weakSelf;</div><div class="line">        <span class="comment">/// é€šçŸ¥ block çš„æŒæœ‰è€…ï¼Œå½“å‰çš„ç½‘ç»œçŠ¶æ€</span></div><div class="line">        strongSelf.networkReachabilityStatus = status;</div><div class="line">        <span class="keyword">if</span> (strongSelf.networkReachabilityStatusBlock) &#123;</div><div class="line">            strongSelf.networkReachabilityStatusBlock(status);</div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;;</div><div class="line"></div><div class="line">    <span class="comment">/// åˆ›å»ºéœ€è¦çš„ contextï¼Œè¿™ä¸ªç»“æ„ä½“åŒ…å«äº†ç”¨æˆ·æŒ‡å®šçš„ä¿¡æ¯ä»¥åŠ callback</span></div><div class="line">    <span class="built_in">SCNetworkReachabilityContext</span> context = &#123;<span class="number">0</span>, (__bridge <span class="keyword">void</span> *)callback, AFNetworkReachabilityRetainCallback, AFNetworkReachabilityReleaseCallback, <span class="literal">NULL</span>&#125;;</div><div class="line">    <span class="comment">/// å½“ self.networkReachability çš„çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå°†ä¼šè°ƒç”¨ AFNetworkReachabilityCallback å‡½æ•°æŒ‡é’ˆ</span></div><div class="line">    <span class="comment">/// AFNetworkReachabilityCallback çš„ç¬¬ä¸‰ä¸ªå‚æ•°å°†ä¼šè¢«ä¼ å…¥ä¸Šé¢åˆ›å»ºçš„ context ç»“æ„ä½“ä¸­çš„ callback ä¿¡æ¯</span></div><div class="line">    <span class="built_in">SCNetworkReachabilitySetCallback</span>(<span class="keyword">self</span>.networkReachability, AFNetworkReachabilityCallback, &amp;context);</div><div class="line">    <span class="comment">/// å¼€å§‹ç›‘å¬ self.networkReachabilityï¼Œéœ€è¦æŒ‡å®š runloop å’Œ runloop mode</span></div><div class="line">    <span class="comment">/// Apple ä½¿ç”¨çš„æ˜¯ kCFRunLoopDefaultMode</span></div><div class="line">    <span class="built_in">SCNetworkReachabilityScheduleWithRunLoop</span>(<span class="keyword">self</span>.networkReachability, <span class="built_in">CFRunLoopGetMain</span>(), kCFRunLoopCommonModes);</div><div class="line"></div><div class="line">    <span class="comment">/// ä½¿ç”¨åå°çº¿ç¨‹è·å–å½“å‰æŒæœ‰çš„ SCNetworkReachabilityRef çš„ç½‘ç»œæ¡ä»¶</span></div><div class="line">    <span class="comment">/// æ›´æ–°å½“å‰ manager çš„ status</span></div><div class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_global_queue(DISPATCH_QUEUE_PRIORITY_BACKGROUND, <span class="number">0</span>),^&#123;</div><div class="line">        <span class="built_in">SCNetworkReachabilityFlags</span> flags;</div><div class="line">        <span class="keyword">if</span> (<span class="built_in">SCNetworkReachabilityGetFlags</span>(<span class="keyword">self</span>.networkReachability, &amp;flags)) &#123;</div><div class="line">            AFPostReachabilityStatusChange(flags, callback);</div><div class="line">        &#125;</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><figure class="highlight objc"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/// åœ¨ `SCNetworkReachabilitySetCallback(self.networkReachability, AFNetworkReachabilityCallback, &amp;context);` çš„æ—¶å€™è®¾ç½®ä¸Šäº†ç³»ç»Ÿå›è°ƒçš„å‡½æ•°æŒ‡é’ˆ</span></div><div class="line"><span class="comment">/// ç½‘ç»œæ¡ä»¶å‘ç”Ÿå˜åŒ–æ—¶ï¼Œæ­¤å‡½æ•°è¢«è°ƒç”¨ï¼ŒåŒæ—¶è·å–åˆ°äº†é‚£ä¸ªæŒæœ‰ SCNetworkReachabilityRef çš„ manager çš„ block</span></div><div class="line"><span class="keyword">static</span> <span class="keyword">void</span> AFNetworkReachabilityCallback(<span class="built_in">SCNetworkReachabilityRef</span> __unused target, <span class="built_in">SCNetworkReachabilityFlags</span> flags, <span class="keyword">void</span> *info) &#123;</div><div class="line">    AFPostReachabilityStatusChange(flags, (__bridge AFNetworkReachabilityStatusBlock)info);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">static</span> <span class="keyword">void</span> AFPostReachabilityStatusChange(<span class="built_in">SCNetworkReachabilityFlags</span> flags, AFNetworkReachabilityStatusBlock block) &#123;</div><div class="line">    AFNetworkReachabilityStatus status = AFNetworkReachabilityStatusForFlags(flags);</div><div class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">        <span class="keyword">if</span> (block) &#123;</div><div class="line">            <span class="comment">/// è°ƒç”¨é‚£ä¸ª manager çš„ blockï¼Œå®ç°é€šçŸ¥</span></div><div class="line">            block(status);</div><div class="line">        &#125;</div><div class="line">        <span class="comment">/// é€šçŸ¥ notification ç›‘å¬è€…</span></div><div class="line">        <span class="built_in">NSNotificationCenter</span> *notificationCenter = [<span class="built_in">NSNotificationCenter</span> defaultCenter];</div><div class="line">        <span class="built_in">NSDictionary</span> *userInfo = @&#123; AFNetworkingReachabilityNotificationStatusItem: @(status) &#125;;</div><div class="line">        [notificationCenter postNotificationName:AFNetworkingReachabilityDidChangeNotification object:<span class="literal">nil</span> userInfo:userInfo];</div><div class="line">    &#125;);</div><div class="line">&#125;</div></pre></td></tr></table></figure><h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><p>AFNetworking çš„ Reachability å°è£…çš„æ¯” Apple å¥½çš„åœ°æ–¹åœ¨äºï¼Œå®ƒä¸å…‰å®ç°äº†é€šè¿‡ notification çš„æ–¹å¼é€šçŸ¥ç½‘ç»œå˜åŒ–ï¼Œè¿˜å®ç°äº† block çš„æ–¹å¼ï¼Œä»£ç å¹²å‡€ï¼Œæ–‡æ¡£ä¸°å¯Œã€‚ä¸€ä¸ª iOS å±Šæœ€çŸ¥åçš„å¼€æºåº“ç»éæµªå¾—è™šåã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Reachability-æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;a href=&quot;#Reachability-æ˜¯ä»€ä¹ˆï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;Reachability æ˜¯ä»€ä¹ˆï¼Ÿ&quot;&gt;&lt;/a&gt;Reachability æ˜¯ä»€ä¹ˆï¼Ÿ&lt;/h2&gt;&lt;p&gt;æ ¹æ® Mac è‡ªå¸¦çš„
      
    
    </summary>
    
    
      <category term="iOS" scheme="http://zhaoxinyu.me/tags/iOS/"/>
    
      <category term="Objective-C" scheme="http://zhaoxinyu.me/tags/Objective-C/"/>
    
  </entry>
  
  <entry>
    <title>Express çš„ API ç‰ˆæœ¬æ§åˆ¶</title>
    <link href="http://zhaoxinyu.me/2017-02-01-express-api-versioning/"/>
    <id>http://zhaoxinyu.me/2017-02-01-express-api-versioning/</id>
    <published>2017-02-01T14:00:00.000Z</published>
    <updated>2017-02-01T14:39:31.000Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨<a href="http://x140yu.com/2017-02-01-api-versioning/" target="_blank" rel="external">ä¸Šä¸€ç¯‡åšæ–‡</a>ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸‹åç«¯åš API ç‰ˆæœ¬æ§åˆ¶çš„å‡ ç§æ–¹æ³•ã€‚</p><p>æœ€è¿‘åœ¨ç”¨ Node.js åšä¸€ä¸ªå°é¡¹ç›® <a href="https://github.com/DayCache/DayCache" target="_blank" rel="external">DayCache</a>ï¼Œå…¶ä¸­å°±æ¶‰åŠåˆ°äº†ç»™å®¢æˆ·ç«¯æä¾› API è°ƒç”¨è¿™ä¸€å—,å½“ç„¶å°±ä¹Ÿéœ€è¦ API çš„ç‰ˆæœ¬æ§åˆ¶äº†ã€‚</p><h2 id="api-v1-post-id"><a href="#api-v1-post-id" class="headerlink" title="/api/v1/post/:id"></a><code>/api/v1/post/:id</code></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// Version 1</div><div class="line">@GET /api/v1/post/:id</div><div class="line"></div><div class="line">// Version 2</div><div class="line">@GET /api/v2/post/:id</div></pre></td></tr></table></figure><p>å¯¹äºè¿™ç§æ–¹å¼çš„ API ç‰ˆæœ¬æ§åˆ¶æˆ‘ä»¬åº”è¯¥æ€ä¹ˆå®ç°å‘¢ï¼Ÿ</p><p>é¦–å…ˆï¼ŒæŠŠç›®å½•ç»“æ„ç»„ç»‡å¦‚ä¸‹ï¼Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">â”œâ”€â”€ api</div><div class="line">â”‚Â Â  â””â”€â”€ v1</div><div class="line">â”‚Â Â      â””â”€â”€ index.js</div><div class="line">â”‚Â Â      â””â”€â”€ signin.js</div><div class="line">â”‚Â Â      â””â”€â”€ signup.js</div><div class="line">â””â”€â”€ index.js</div></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"></div><div class="line">...</div><div class="line"></div><div class="line"><span class="comment">/*</span></div><div class="line"><span class="comment">  // API</span></div><div class="line"><span class="comment">  å¦‚æœéœ€è¦æ–°å¢åŠ ä¸€ä¸ª API çš„ç‰ˆæœ¬</span></div><div class="line"><span class="comment">  1. æŠŠ ./api/v1 ç›®å½•å¤åˆ¶ä¸€ä»½ï¼Œæ”¹åä¸º v2</span></div><div class="line"><span class="comment">  2. åœ¨ä¸‹é¢çš„ API_VERSIONS å­—å…¸ä¸­åŠ å…¥ä¸€å¯¹ kvï¼Œå¦‚ `'Version 2': '/v2'`</span></div><div class="line"><span class="comment">*/</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> API_VERSIONS = &#123;</div><div class="line">  <span class="string">'Version 1'</span>: <span class="string">'/v1'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">for</span> (<span class="keyword">var</span> v <span class="keyword">in</span> API_VERSIONS) &#123;</div><div class="line">  <span class="keyword">var</span> api = <span class="built_in">require</span>(<span class="string">'./api'</span> + API_VERSIONS[v]);</div><div class="line">  api(app);</div><div class="line">&#125;</div><div class="line"></div><div class="line">...</div></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// api/v1/index.js</span></div><div class="line"><span class="comment">// å¦‚æœéœ€è¦åŠ å…¥æ–°çš„è¯·æ±‚è·¯å¾„ï¼Œåªéœ€è¦åœ¨ä¸‹é¢åŠ å…¥è·¯å¾„</span></div><div class="line"><span class="comment">// ç„¶ååœ¨ `api/v1` ä¸‹å»ºç«‹åŒåæ–‡ä»¶å³å¯</span></div><div class="line"><span class="keyword">let</span> ROUTE_PATHS = [</div><div class="line">  <span class="string">'/signin'</span>,</div><div class="line">  <span class="string">'/signup'</span>,</div><div class="line">];</div><div class="line"></div><div class="line"><span class="built_in">module</span>.exports = <span class="function"><span class="keyword">function</span> (<span class="params">app</span>) </span>&#123;</div><div class="line"></div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> i <span class="keyword">in</span> ROUTE_PATHS) &#123;</div><div class="line">    <span class="keyword">let</span> path = ROUTE_PATHS[i];</div><div class="line">    <span class="built_in">console</span>.log(path);</div><div class="line">    app.use(<span class="string">'/api/v1'</span> + path, <span class="built_in">require</span>(<span class="string">'.'</span> + path));</div><div class="line">  &#125;</div><div class="line"></div><div class="line">&#125;;</div></pre></td></tr></table></figure><p>è¿™æ ·ï¼ŒAPI ç‰ˆæœ¬åŒ–çš„å·¥ä½œå°±å·²ç»å®Œæˆäº†ï¼Œè€Œä¸”ä¸åŒç‰ˆæœ¬çš„ API æ‹†åˆ†åœ°æ¯”è¾ƒå¹²å‡€ï¼ŒåŒä¸€ä¸ªç‰ˆæœ¬ä¸åŒè·¯å¾„çš„è¯·æ±‚ä¹Ÿéƒ½åœ¨ä¸åŒçš„æ–‡ä»¶ä¸­ã€‚</p><h2 id="Accept-Version-1-0"><a href="#Accept-Version-1-0" class="headerlink" title="Accept-Version: 1.0"></a><code>Accept-Version: 1.0</code></h2><p>å¯¹äºè¿™ç§è¯·æ±‚çš„ API ç‰ˆæœ¬æ”¾åˆ° header ä¸­çš„ï¼Œä¹Ÿæ¯”è¾ƒå¥½å¤„ç†ï¼Œå¯ä»¥çœ‹ä¸€ä¸‹ <a href="https://github.com/Prasanna-sr/express-routes-versioning" target="_blank" rel="external">express-routes-versioning</a> è¿™ä¸ªä¸­é—´ä»¶ï¼ˆæ¯•ç«Ÿ Express.jsï¼Œä¸­é—´ä»¶å°±æ˜¯å¤šï¼‰ï¼Œå®ƒå°±æ˜¯æ¯”è¾ƒä¼˜é›…åœ°å¤„ç†äº†è¿™ä¸ªé—®é¢˜ï¼š</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="keyword">var</span> app = <span class="built_in">require</span>(<span class="string">'express'</span>)();</div><div class="line"><span class="keyword">var</span> routesVersioning = <span class="built_in">require</span>(<span class="string">'express-routes-versioning'</span>)();</div><div class="line"></div><div class="line">app.get(<span class="string">'/test'</span>, routesVersioning(&#123;</div><div class="line">   <span class="string">"1.0.0"</span>: respondV1,</div><div class="line">   <span class="string">"~2.2.1"</span>: respondV2</div><div class="line">&#125;));</div><div class="line"></div><div class="line"><span class="comment">// curl -s -H 'accept-version: 1.0.0' localhost:3000/test</span></div><div class="line"><span class="comment">// version 1.0.0 or 1.0 or 1 !</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">respondV1</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">   res.status(<span class="number">200</span>).send(<span class="string">'ok v1'</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//curl -s -H 'accept-version: 2.2.0' localhost:3000/test</span></div><div class="line"><span class="comment">//Anything from 2.2.0 to 2.2.9</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">respondV2</span>(<span class="params">req, res, next</span>) </span>&#123;</div><div class="line">   res.status(<span class="number">200</span>).send(<span class="string">'ok v2'</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>æŠŠè¯·æ±‚ header ä¸­ <code>Accept-Version</code> ä¸åŒçš„ API ç‰ˆæœ¬æŒ‚åœ¨åˆ°ä¸åŒçš„ handler ä¸­ï¼Œè€Œä¸”è¿˜å¯ä»¥ä½¿ç”¨ç±»ä¼¼äº <code>~2.2.1</code> çš„æ–¹å¼æŒ‡å®šç‰ˆæœ¬å·ã€‚<br>è¿™ä¸ªä¸­é—´ä»¶çš„ä»£ç æ²¡æœ‰å¤šå°‘ï¼Œå¯ä»¥æ ¹æ®ä½ çš„éœ€è¦å®šåˆ¶ä¸€ä¸ªï¼Œæ¯”å¦‚ custom header å•¦ï¼Œç‰ˆæœ¬å·çš„åŒ¹é…è§„åˆ™å•¦ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åœ¨&lt;a href=&quot;http://x140yu.com/2017-02-01-api-versioning/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;ä¸Šä¸€ç¯‡åšæ–‡&lt;/a&gt;ä¸­ï¼Œæˆ‘ä»¬ä»‹ç»äº†ä¸€ä¸‹åç«¯åš API ç‰ˆæœ¬æ§åˆ¶çš„å‡ ç§æ–¹æ³•ã€‚&lt;/p&gt;
&lt;p&gt;æœ€è¿‘åœ¨ç”¨ N
      
    
    </summary>
    
    
      <category term="Nodejs" scheme="http://zhaoxinyu.me/tags/Nodejs/"/>
    
  </entry>
  
  <entry>
    <title>æœåŠ¡å™¨ç«¯çš„ API ç‰ˆæœ¬æ§åˆ¶</title>
    <link href="http://zhaoxinyu.me/2017-02-01-api-versioning/"/>
    <id>http://zhaoxinyu.me/2017-02-01-api-versioning/</id>
    <published>2017-02-01T02:13:00.000Z</published>
    <updated>2017-02-01T13:29:13.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="Why"><a href="#Why" class="headerlink" title="Why?"></a>Why?</h2><p>å‘å¸ƒå‡ºå»çš„ API å°±åƒæ³¼å‡ºå»çš„æ°´ï¼Œä¸è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹æŸäº›è°ƒç”¨è€…æ¥è¯´ä¸€å®šä¼šæ˜¯ç¾éš¾æ€§çš„ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ã€‚æ¯”å¦‚ä½ åœ¨ä¸€å®¶å…¬å¸è´Ÿè´£åç«¯ API çš„å¼€å‘ï¼ŒåŒæ—¶ç»™å…¬å¸çš„ Android å’Œ iOS å®¢æˆ·ç«¯æä¾›æ¥å£ã€‚<br>åœ¨ 1 æœˆä»½çš„æ—¶å€™ï¼Œä½ å¼€å‘äº†ä¸€ä¸ªæ¥å£ï¼Œç”¨äºè·å–æ–‡ç« çš„è¯¦æƒ…</p><figure class="highlight json"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">@GET /post/:id</div><div class="line">//response</div><div class="line">&#123;</div><div class="line">   <span class="attr">"title"</span>: <span class="string">"xxx"</span>,</div><div class="line">   <span class="attr">"content"</span>: <span class="string">"xxx"</span>,</div><div class="line">   <span class="attr">"author"</span>: &#123;</div><div class="line">     <span class="attr">"id"</span>: <span class="number">123</span>,</div><div class="line">     <span class="attr">"name"</span>: <span class="string">"xxx"</span></div><div class="line">   &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>å¼€å‘å®Œæˆåï¼Œä½ å¾ˆ happy åœ°å‘Šè¯‰å®¢æˆ·ç«¯åŒå­¦ï¼Œè·å–æ–‡ç« è¯¦æƒ…å°±è°ƒæˆ‘è¿™ä¸ªæ¥å£å§ï¼Œä¸€ç‚¹é—®é¢˜éƒ½æ²¡æœ‰ã€‚å®¢æˆ·ç«¯åŒå­¦ä¹Ÿå¾ˆ happy åœ°è°ƒç”¨äº†ã€‚2 æœˆä»½ï¼Œå®¢æˆ·ç«¯å¼€å‘å®Œæˆï¼Œé¡ºåˆ©å‘å¸ƒ 1.0 ç‰ˆæœ¬ã€‚è¿™ä¸ªæ—¶å€™ï¼Œè¿˜æ²¡æœ‰é‡åˆ°ä»»ä½•é—®é¢˜ã€‚</p><p>3 æœˆä»½çš„æ—¶å€™ï¼Œè®¾è®¡å˜äº†ï¼Œæ–‡ç« æ”¯æŒäº†å¤šä½œè€…ï¼æ‰€ä»¥ç°åœ¨é‚£ä¸ªç›¸åŒçš„ API è¿”å›çš„ç»“æœå¯èƒ½æ˜¯è¿™æ ·çš„ï¼Œ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">@GET /post/:id</div><div class="line">// response</div><div class="line">&#123;</div><div class="line">   &quot;title&quot;: &quot;xxx&quot;,</div><div class="line">   &quot;content&quot;: &quot;xxx&quot;,</div><div class="line">   &quot;author&quot;: [</div><div class="line">      &#123;</div><div class="line">         &quot;id&quot;: 123,</div><div class="line">         &quot;name&quot;: &quot;xxx&quot;</div><div class="line">      &#125;,</div><div class="line">      &#123;</div><div class="line">         &quot;id&quot;: 456</div><div class="line">         &quot;name&quot;: &quot;xxx&quot;</div><div class="line">      &#125;</div><div class="line">   ]</div><div class="line">&#125;</div></pre></td></tr></table></figure><p>Boom! è¿™ä¸‹å¯ç³Ÿäº†ï¼Œå¦‚æœ API äº§ç”Ÿäº†è¿™ä¹ˆé‡å¤§çš„å˜åŒ–ï¼Œé‚£ä¹ˆå·²ç»å‘å‡ºå»çš„ 1.0 ç‰ˆæœ¬çš„å®¢æˆ·ç«¯å¯æ€ä¹ˆåŠå•Šï¼Ÿï¼ˆå¼€å‘è¿‡å®¢æˆ·ç«¯çš„åŒå­¦éƒ½çŸ¥é“ï¼ŒåŒä¸€ä¸ªæ¥å£è¿”å›è¿™ä¹ˆã€Œè„ã€çš„æ•°æ®æ˜¯ä¼š crash çš„ï¼‰ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå°±éœ€è¦ API versioningï¼ˆç‰ˆæœ¬åŒ–ï¼‰äº†ã€‚</p><h2 id="How"><a href="#How" class="headerlink" title="How?"></a>How?</h2><p>é€šå¸¸æ¥è¯´ï¼ŒAPI ç‰ˆæœ¬æ§åˆ¶æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼ï¼š</p><h3 id="api-v1-xxx"><a href="#api-v1-xxx" class="headerlink" title="/api/v1/xxx"></a><code>/api/v1/xxx</code></h3><p>ç›´æ¥æŠŠ API çš„ç‰ˆæœ¬ä¿¡æ¯æ”¾åˆ° URL é‡Œé¢ï¼Œ<a href="http://open.weibo.com/wiki/2/users/show" target="_blank" rel="external">æ–°æµª</a>æ˜¯è¿™ä¹ˆåšçš„ã€‚</p><p>ä¼˜ç‚¹ï¼šç›´è§‚<br>ç¼ºç‚¹ï¼šURL è¢«æ±¡æŸ“äº†ï¼Œå¾ˆä¸ä¼˜é›…</p><h3 id="API-VERSION-3-0"><a href="#API-VERSION-3-0" class="headerlink" title="API-VERSION: 3.0"></a><code>API-VERSION: 3.0</code></h3><p>ä½¿ç”¨è‡ªå®šä¹‰çš„ header è¯†åˆ« API çš„ç‰ˆæœ¬ï¼ŒçŸ¥ä¹ç›®å‰æ˜¯è¿™ä¹ˆåšçš„ã€‚</p><p>ä¼˜ç‚¹ï¼šURL å˜å¾—å¾ˆå¹²å‡€<br>ç¼ºç‚¹ï¼šä¸ç›´è§‚ï¼Œä»£ç ä¸å¥½ç»„ç»‡ï¼Œè€Œä¸”å®¹æ˜“äº§ç”Ÿå‘åå…¼å®¹çš„é—®é¢˜ï¼ˆè‡³å°‘çŸ¥ä¹çš„æŸäº› API æ˜¯è¿™æ ·çš„ï¼Œä¸€èˆ¬è¿™ç§å¯¹äº header çš„ä¿®æ”¹éƒ½æ˜¯å…¨å±€çš„ï¼ŒæŸäº› API è¯´å¥½äº†å¯ä»¥å‡çº§åˆ° 2.0ï¼Œä½†æ˜¯æˆ‘è°ƒç”¨ 2.0 çš„ <code>/singin</code> éƒ½ç™»å½•ä¸ä¸Šï¼‰</p><h3 id="Accept-application-vnd-xxx-v2-json"><a href="#Accept-application-vnd-xxx-v2-json" class="headerlink" title="Accept: application/vnd.xxx.v2+json"></a><code>Accept: application/vnd.xxx.v2+json</code></h3><p>ä¿®æ”¹ header ä¸­çš„ <code>Accept</code> å­—æ®µï¼Œ<a href="https://developer.github.com/v3/" target="_blank" rel="external">Github</a> æ˜¯è¿™ä¹ˆåšçš„ã€‚</p><p>ä¼˜ç¼ºç‚¹åŒä¸Š</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;h2 id=&quot;Why&quot;&gt;&lt;a href=&quot;#Why&quot; class=&quot;headerlink&quot; title=&quot;Why?&quot;&gt;&lt;/a&gt;Why?&lt;/h2&gt;&lt;p&gt;å‘å¸ƒå‡ºå»çš„ API å°±åƒæ³¼å‡ºå»çš„æ°´ï¼Œä¸è¿›è¡Œç‰ˆæœ¬æ§åˆ¶ï¼Œå¯¹æŸäº›è°ƒç”¨è€…æ¥è¯´ä¸€å®šä¼šæ˜¯ç¾éš¾æ€§çš„ã€‚&lt;/p&gt;
&lt;p&gt;ä¸¾ä¸ªä¾‹å­ã€‚æ¯”å¦‚ä½ åœ¨ä¸€å®¶å…¬å¸
      
    
    </summary>
    
    
      <category term="åç«¯" scheme="http://zhaoxinyu.me/tags/%E5%90%8E%E7%AB%AF/"/>
    
  </entry>
  
  <entry>
    <title>å®‡å¸¦é€›ä¹‹å¤©å›ç¯‡</title>
    <link href="http://zhaoxinyu.me/2017-01-14-yu-ge-dai-ni-you-tian-tan/"/>
    <id>http://zhaoxinyu.me/2017-01-14-yu-ge-dai-ni-you-tian-tan/</id>
    <published>2017-01-14T12:54:00.000Z</published>
    <updated>2017-01-14T13:12:58.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘è¿™é¢—èºåŠ¨çš„å¿ƒç»ˆäºè¢«æœ€è¿‘çš„å¥½ç©ºæ°”ç‚¹ç‡ƒäº†ã€‚ä»Šå¤©å»äº†ä¸€ç›´æƒ³å»ä½†æ²¡å»ï¼ˆå¤ªè¿œäº†â€¦â€¦ï¼‰çš„å¤©å›ã€‚<br>ç°åœ¨å±äºæ·¡å­£ï¼Œè”ç¥¨ 28 å…ƒï¼Œå»çš„è¯ï¼Œè¯·ä¸€å®šè¦ä¹°è”ç¥¨ã€‚å»äº†è¶Ÿå¤©å›å¦‚æœè¿ç¥ˆå¹´æ®¿éƒ½æ²¡çœ‹åˆ°çš„è¯ï¼Œé‚£åº”è¯¥æ˜¯ç™½å»äº†â€¦â€¦</p><h2 id=""><a href="#" class="headerlink" title=""></a><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeo3v333j21kw11oe81.jpg" alt=""></h2><p><img src="http://wx1.sinaimg.cn/large/5cc3eefely1fbqeo875c8j21kw11o1kx.jpg" alt=""><br>ä¸çŸ¥é“è¿™å«ä»€ä¹ˆæ ‘ï¼Œä½†æ˜¯ï¼Œå®ƒåœ¨å¤å¤©çš„æ ·å­ï¼Œä¸€å®šæ›´ç¾</p><hr><p><img src="http://wx2.sinaimg.cn/large/5cc3eefely1fbqeoau31fj21kw11oh9x.jpg" alt=""><br>è¿™å¸®å¤§çˆ·å¤§å¦ˆä¸€å®šæ˜¯ä¹°äº†å¹´ç¥¨è¿›æ¥ä»¥ç‰Œä¼šå‹çš„ï¼Œå£°éŸ³è¶…å¤§ï¼Œæœ‰ç‚¹åµäº†â€¦â€¦</p><hr><p><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeoepczwj21kw11o1kx.jpg" alt=""><br>é•¿å»Šï¼Œä¸è¿‡è®ºç²¾è‡´ç¨‹åº¦ï¼Œè¿˜æ˜¯é¢å’Œå›­é‡Œçš„æ›´èƒœä¸€ç­¹ï¼ˆæˆ‘éƒ½è¦çˆ±æ­»é¢å’Œå›­äº† &lt;3</p><hr><p><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeog300vj21kw11okc7.jpg" alt=""></p><p><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeoine7uj21kw11o4qp.jpg" alt=""><br><img src="http://wx2.sinaimg.cn/large/5cc3eefely1fbqeokwfcjj21kw11o7wh.jpg" alt=""><br>ç¥ˆå¹´æ®¿å°é˜¶ä¸Šçš„æµ®é›•</p><hr><p><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeooynnuj21kw2dw1ky.jpg" alt=""><br><img src="http://wx1.sinaimg.cn/large/5cc3eefely1fbqeor5sp9j21kw11o7up.jpg" alt=""><br><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeotcwdjj21kw2dw7wh.jpg" alt=""><br><img src="http://wx1.sinaimg.cn/large/5cc3eefely1fbqep0j9dcj21kw11oqky.jpg" alt=""><br><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqep8qa84j21kw11oqoj.jpg" alt=""><br>å„ä¸ªè§’åº¦çš„ç¥ˆå¹´æ®¿ï¼Œåœ¨è“å¤©çš„æ˜ è¡¬ä¸‹ç¾æäº†æœ‰æ²¡æœ‰</p><hr><p><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeov4p04j21kw11okbm.jpg" alt=""><br><img src="http://wx4.sinaimg.cn/large/5cc3eefely1fbqeoy8e4aj21kw11oh9l.jpg" alt=""><br><img src="http://wx1.sinaimg.cn/large/5cc3eefely1fbqep339cvj21kw0uyh9m.jpg" alt=""><br>å’Œé¦™ç‚‰çš„å½±å­ä¸€èµ·å–ä¸ªèŒ</p><hr><p><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqep67fwuj21kw2dwnpd.jpg" alt=""><br><img src="http://wx1.sinaimg.cn/large/5cc3eefely1fbqepbm9g2j21kw2dwe81.jpg" alt=""><br><img src="http://wx2.sinaimg.cn/large/5cc3eefely1fbqepcnzg9j21kw11owre.jpg" alt=""><br>å›éŸ³å£</p><hr><p><img src="http://wx1.sinaimg.cn/large/5cc3eefely1fbqepdazl4j21kw11oqhs.jpg" alt=""><br>èŒèŒçš„ä¸€å®¶ä¸‰å£</p><hr><p><img src="http://wx4.sinaimg.cn/large/5cc3eefely1fbqepflcfsj21kw11ob29.jpg" alt=""><br><img src="http://wx2.sinaimg.cn/large/5cc3eefely1fbqeph8cs7j21kw11o1kx.jpg" alt=""><br>å¤©å›å…¬å›­çš„ç»¿åŒ–é¢ç§¯ç‰¹åˆ«å¤§ã€‚æœ‰å¾ˆå¤šé¸Ÿç±»åœ¨è¿™é‡Œç”Ÿæ´»ã€‚è€Œä¸”è¿™é‡Œçš„å–œé¹Šéƒ½ä¸æ€•äººçš„</p><hr><p><img src="http://wx2.sinaimg.cn/large/5cc3eefely1fbqepk3mm2j21kw11okjl.jpg" alt=""><br>ä¸ƒæ˜ŸçŸ³ï¼ˆæ•°äº†æ•°ï¼Œä¸€å…±æœ‰å…«å— = =</p><hr><p><img src="http://wx2.sinaimg.cn/large/5cc3eefely1fbqepne8n9j21kw11o1kx.jpg" alt=""><br><img src="http://wx3.sinaimg.cn/large/5cc3eefely1fbqeprbgnqj21kw11oe0g.jpg" alt=""><br>é€›å®Œä»¥åï¼Œä»å¤©å›ä¸€è·¯ ofo åˆ°é¼“æ¥¼ï¼Œå¦‚æœåŒ—äº¬é›¾éœ¾æ²¡æœ‰é‚£ä¹ˆä¸¥é‡çš„è¯ï¼Œè¿™äº›å…±äº«å•è½¦çš„æ•°æ®ä¸€å®šä¼šæ›´æ¼‚äº®å§</p><hr>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æˆ‘è¿™é¢—èºåŠ¨çš„å¿ƒç»ˆäºè¢«æœ€è¿‘çš„å¥½ç©ºæ°”ç‚¹ç‡ƒäº†ã€‚ä»Šå¤©å»äº†ä¸€ç›´æƒ³å»ä½†æ²¡å»ï¼ˆå¤ªè¿œäº†â€¦â€¦ï¼‰çš„å¤©å›ã€‚&lt;br&gt;ç°åœ¨å±äºæ·¡å­£ï¼Œè”ç¥¨ 28 å…ƒï¼Œå»çš„è¯ï¼Œè¯·ä¸€å®šè¦ä¹°è”ç¥¨ã€‚å»äº†è¶Ÿå¤©å›å¦‚æœè¿ç¥ˆå¹´æ®¿éƒ½æ²¡çœ‹åˆ°çš„è¯ï¼Œé‚£åº”è¯¥æ˜¯ç™½å»äº†â€¦â€¦&lt;/p&gt;
&lt;h2 id=&quot;&quot;&gt;&lt;a href=&quot;#&quot; class=&quot;hea
      
    
    </summary>
    
    
      <category term="æ‘„å½±" scheme="http://zhaoxinyu.me/tags/%E6%91%84%E5%BD%B1/"/>
    
  </entry>
  
  <entry>
    <title>å¦‚ä½•å†™å¥½ commit messageï¼Ÿ</title>
    <link href="http://zhaoxinyu.me/2017-01-04-how-to-write-good-commit-message/"/>
    <id>http://zhaoxinyu.me/2017-01-04-how-to-write-good-commit-message/</id>
    <published>2017-01-04T15:54:00.000Z</published>
    <updated>2017-01-04T16:04:53.000Z</updated>
    
    <content type="html"><![CDATA[<p>Commit message æ˜¯æ¯ä¸ªå¼€å‘äººå‘˜æ¯å¤©éƒ½è¦å†™çš„ä¸œè¥¿ï¼Œå¯æ˜¯å¤§å¤šæ•°äººéƒ½ä¼šä»¥ä¸€ä¸ª bug fix æˆ–è€… update xxx è‰è‰äº†äº‹ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯å¥½çš„ commit message å‘¢ï¼Ÿæˆ‘çœ‹åˆ°äº†ä¸€ç¯‡<a href="http://chris.beams.io/posts/git-commit/" target="_blank" rel="external">å¥½æ–‡</a> ï¼Œé¡ºæ‰‹ç»™å¤§å®¶æ€»ç»“äº†ä¸€ä¸‹</p><p>æ¯”å¦‚ï¼Œè¿™æ˜¯ä¸€æ¡ commit messageï¼Œé¦–å…ˆæˆ‘ä»¬è¦ææ¸…æ¥š subject å’Œ bodyã€‚</p><p><img src="http://ww3.sinaimg.cn/large/5cc3eefejw1fbf1lbtx1dj20ze0l6qeq.jpg" alt=""></p><h3 id="1-Subject-å’Œ-body-ä¹‹é—´è¦ç•™ä¸€ä¸ªç©ºè¡Œ"><a href="#1-Subject-å’Œ-body-ä¹‹é—´è¦ç•™ä¸€ä¸ªç©ºè¡Œ" class="headerlink" title="1. Subject å’Œ body ä¹‹é—´è¦ç•™ä¸€ä¸ªç©ºè¡Œ"></a>1. Subject å’Œ body ä¹‹é—´è¦ç•™ä¸€ä¸ªç©ºè¡Œ</h3><ul><li>è¿™æ˜¯ <code>git commit</code> å‘½ä»¤çš„<a href="https://www.kernel.org/pub/software/scm/git/docs/git-commit.html#_discussion" target="_blank" rel="external">æ¨èåšæ³•</a></li></ul><ul><li>å¾ˆå¤š git çš„å‘½ä»¤ä¾èµ–äº subject å’Œ body ä¸­çš„ç©ºè¡Œï¼Œæ¯”å¦‚ <code>git log --oneline</code>ï¼Œ<code>git shortlog</code></li><li>PS. å¦‚æœ commit å†…å®¹è¾ƒå°‘ï¼Œæ²¡å¿…è¦å†™ body</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// good</div><div class="line">Summarize changes in around 50 characters or less</div><div class="line"></div><div class="line">More detailed explanatory text, if necessary. Wrap it to about 72</div><div class="line">characters or so. In some contexts, the first line is treated as the</div><div class="line">...</div><div class="line"></div><div class="line">// bad</div><div class="line">Summarize changes in around 50 characters or less</div><div class="line">More detailed explanatory text, if necessary. Wrap it to about 72</div><div class="line">characters or so. In some contexts, the first line is treated as the</div><div class="line">...</div></pre></td></tr></table></figure><h3 id="2-æŠŠ-subject-æ§åˆ¶åœ¨-50-ä¸ªå­—ç¬¦ä¹‹å†…"><a href="#2-æŠŠ-subject-æ§åˆ¶åœ¨-50-ä¸ªå­—ç¬¦ä¹‹å†…" class="headerlink" title="2. æŠŠ subject æ§åˆ¶åœ¨ 50 ä¸ªå­—ç¬¦ä¹‹å†…"></a>2. æŠŠ subject æ§åˆ¶åœ¨ 50 ä¸ªå­—ç¬¦ä¹‹å†…</h3><p>å¦‚å›¾ï¼Œä¸è§£é‡Šã€‚</p><p><img src="http://ww4.sinaimg.cn/large/5cc3eefejw1fbf1lb459zj21k40icn0j.jpg" alt=""></p><h3 id="3-Subject-çš„é¦–å­—æ¯å¤§å†™"><a href="#3-Subject-çš„é¦–å­—æ¯å¤§å†™" class="headerlink" title="3. Subject çš„é¦–å­—æ¯å¤§å†™"></a>3. Subject çš„é¦–å­—æ¯å¤§å†™</h3><p>ä¸è§‰å¾—å¼€å¤´å¤§å†™å¾ˆä¼˜ç¾å—ï¼Ÿ</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// good</div><div class="line">Accelerate to 88 miles per hour</div><div class="line"></div><div class="line">// bad</div><div class="line">accelerate to 88 miles per hour</div></pre></td></tr></table></figure><h3 id="4-Subject-çš„ç»“å°¾ä¸è¦åŠ æ ‡ç‚¹ç¬¦å·"><a href="#4-Subject-çš„ç»“å°¾ä¸è¦åŠ æ ‡ç‚¹ç¬¦å·" class="headerlink" title="4. Subject çš„ç»“å°¾ä¸è¦åŠ æ ‡ç‚¹ç¬¦å·"></a>4. Subject çš„ç»“å°¾ä¸è¦åŠ æ ‡ç‚¹ç¬¦å·</h3><p>Subject å°½é‡ç®€æ˜æ‰¼è¦ï¼Œæ ‡ç‚¹ç¬¦å·ä¸æ˜¯å¿…é¡»çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">// good</div><div class="line">Open the pod bay doors</div><div class="line"></div><div class="line">// bad</div><div class="line">Open the pod bay doors.</div></pre></td></tr></table></figure><h3 id="5-åœ¨-subject-ä¸­ï¼Œä½¿ç”¨-imperative-çš„è¯­å¥"><a href="#5-åœ¨-subject-ä¸­ï¼Œä½¿ç”¨-imperative-çš„è¯­å¥" class="headerlink" title="5. åœ¨ subject ä¸­ï¼Œä½¿ç”¨ imperative çš„è¯­å¥"></a>5. åœ¨ subject ä¸­ï¼Œä½¿ç”¨ imperative çš„è¯­å¥</h3><p>å…ˆæ¥çœ‹çœ‹ä»€ä¹ˆæ˜¯ imperative å’Œ indicative</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">// imperativeï¼ˆå‘½ä»¤æ€§ï¼‰ VS indicativeï¼ˆé™ˆè¿°æ€§ï¼‰</div><div class="line">Empty the bin, John. // imperative</div><div class="line">John empties the bin. // indicative</div></pre></td></tr></table></figure><p>Commit ä¸­ çš„ subject ä½¿ç”¨ imperative çš„è¯­å¥ï¼Œæ¯”å¦‚ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// good</div><div class="line">- Refactor subsystem X for readability</div><div class="line">- Update getting started documentation</div><div class="line">- Remove deprecated methods</div><div class="line">- Release version 1.0.0</div><div class="line"></div><div class="line">// bad</div><div class="line">- Fixed bug with Y</div><div class="line">- Changing behavior of X</div><div class="line">- More fixes for broken stuff</div><div class="line">- Sweet new API methods</div></pre></td></tr></table></figure><p>æœ‰ä¸€ä¸ªç®€å•çš„åšæ³•å¯ä»¥çœ‹å‡ºä½ çš„ subject æ˜¯å¦ç¬¦åˆäº†è¿™æ¡è§„å®šï¼Œå°±æ˜¯æŠŠå®ƒå¥—è¿› <code>If applied, this commit will {subject}</code>ï¼Œå¦‚æœè¯­å¥é€šé¡ºæ²¡æœ‰è¯­ç—…ï¼Œè¯´æ˜ä½ çš„ subject æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">// good</div><div class="line">- If applied, this commit will refactor subsystem X for readability</div><div class="line">- If applied, this commit will update getting started documentation</div><div class="line">- If applied, this commit will remove deprecated methods</div><div class="line">- If applied, this commit will release version 1.0.0</div><div class="line">- If applied, this commit will merge pull request #123 from user/branch</div><div class="line"></div><div class="line">// bad</div><div class="line">- If applied, this commit will fixed bug with Y</div><div class="line">- If applied, this commit will changing behavior of X</div><div class="line">- If applied, this commit will more fixes for broken stuff</div><div class="line">- If applied, this commit will sweet new API methods</div></pre></td></tr></table></figure><p>åœ¨æˆ‘çœ‹æ¥ï¼Œå…¶å®å°±æ˜¯ä»¥åŠ¨è¯åŸå‹å¼€å¤´ï¼ˆé€ƒ</p><h3 id="6-æ§åˆ¶-body-æ¯è¡Œçš„é•¿åº¦åœ¨-72-ä¸ªå­—ç¬¦"><a href="#6-æ§åˆ¶-body-æ¯è¡Œçš„é•¿åº¦åœ¨-72-ä¸ªå­—ç¬¦" class="headerlink" title="6. æ§åˆ¶ body æ¯è¡Œçš„é•¿åº¦åœ¨ 72 ä¸ªå­—ç¬¦"></a>6. æ§åˆ¶ body æ¯è¡Œçš„é•¿åº¦åœ¨ 72 ä¸ªå­—ç¬¦</h3><p>å¦‚æœä¸€è¡Œå¤ªé•¿è¯ï¼Œé‚£çœŸæ˜¯æ²¡æ³•çœ‹â€¦â€¦</p><h3 id="7-ç”¨-body-è¯´æ˜è¿™æ¬¡-commit-çš„-what-why-how"><a href="#7-ç”¨-body-è¯´æ˜è¿™æ¬¡-commit-çš„-what-why-how" class="headerlink" title="7. ç”¨ body è¯´æ˜è¿™æ¬¡ commit çš„ what, why, how"></a>7. ç”¨ body è¯´æ˜è¿™æ¬¡ commit çš„ what, why, how</h3><p>èƒ½åšåˆ°è¿™ä¸€æ­¥çš„äººçœŸçš„å¾ˆå°‘ã€‚</p><p>PS. æˆ‘è¿˜æ˜¯å»ºè®®å¤§å®¶å¤šç”¨è‹±æ–‡å†™ commit messageï¼Œå› ä¸ºé™¤äº†å†™è‹±æ–‡ä»£ç æ³¨é‡Šä»¥å¤–ï¼Œcommit message æ˜¯å”¯ä¸€èƒ½åœ¨æ¯æ—¥çš„å·¥ä½œä¸­è®­ç»ƒè‡ªå·±å†™å¥½è‹±è¯­çš„æœºä¼šäº†ã€‚å¥½çš„ commit message ä¸å…‰è‡ªå·±çœ‹ç€å¿ƒé‡Œèˆ’æœï¼Œè·Ÿä½ åä½œå¼€å‘çš„äººçœ‹ç€ä¹Ÿå¾—åŠ²ã€‚ä»è¿™ä¸€åˆ»å¼€å§‹ï¼Œå†™å¥½æ¯ä¸€æ¡ commit message å§ï¼</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;Commit message æ˜¯æ¯ä¸ªå¼€å‘äººå‘˜æ¯å¤©éƒ½è¦å†™çš„ä¸œè¥¿ï¼Œå¯æ˜¯å¤§å¤šæ•°äººéƒ½ä¼šä»¥ä¸€ä¸ª bug fix æˆ–è€… update xxx è‰è‰äº†äº‹ã€‚é‚£ä¹ˆä»€ä¹ˆæ˜¯å¥½çš„ commit message å‘¢ï¼Ÿæˆ‘çœ‹åˆ°äº†ä¸€ç¯‡&lt;a href=&quot;http://chris.beams.io/posts
      
    
    </summary>
    
    
      <category term="æŠ€æœ¯" scheme="http://zhaoxinyu.me/tags/%E6%8A%80%E6%9C%AF/"/>
    
  </entry>
  
  <entry>
    <title>&lt;è¯»&gt;ã€Œä¸‡ä¸‡æ²¡æƒ³åˆ° - ç”¨ç†å·¥ç§‘æ€ç»´ç†è§£ä¸–ç•Œã€</title>
    <link href="http://zhaoxinyu.me/2017-01-01-wwmxd/"/>
    <id>http://zhaoxinyu.me/2017-01-01-wwmxd/</id>
    <published>2017-01-01T12:17:00.000Z</published>
    <updated>2017-01-02T14:23:33.000Z</updated>
    
    <content type="html"><![CDATA[<ul><li>Start:  2016-12-31</li><li>Finish: 2017-01-01</li><li>link: <a href="https://book.douban.com/subject/25986341/" target="_blank" rel="external">https://book.douban.com/subject/25986341/</a></li></ul><hr><p>æ­£å€¼ 2016-2017 çš„è·¨å¹´ä¹‹é™…ï¼Œæœ‰äº†ä¸‰å¤©éš¾å¾—çš„å‡æœŸã€‚æœ¬æ¥æŒ‡æœ›èƒ½å‡ºå»å¥½å¥½ç©ä¸€ç©é€›ä¸€é€›ï¼Œæ²¡æˆæƒ³ï¼ŒåŒ—äº¬æŒç»­ 5 å¤©é›¾éœ¾ç»™æˆ‘äº†ä¸€ä¸ªæˆ‘ä¸€ä¸ªå¼€å¹´å¤§ç¤¼ã€‚æˆï¼Œä¸å°±æ˜¯åœ¨å®¶å‘†ç€å—ï¼Œè¿™å¯¹æˆ‘è¿™ä¸ªæ­»å®…æ¥è¯´æœ‰ä½•éš¾ã€‚</p><p>åˆ·å¾®åšçš„æ—¶å€™ï¼Œå‘ç°äº† @JailBreakHum å‘çš„ä¸€å¼ å›¾ç‰‡ï¼Œå†…å®¹æ˜¯ä¸€æœ¬ä¹¦æŸé¡µçš„æˆªå±ï¼Œè®²r æ˜¯æŸå®¶æ–°é—»ç½‘ç«™çš„æ–°é—»æ ‡é¢˜å…¶å®æ˜¯é ç½‘å‹é€‰æ‹©å‡ºæ¥çš„ã€‚å› ä¸ºåœ¨å‘å¸ƒçš„ 5 åˆ†é’Ÿå†…æ—¶å€™è¿›è¡Œäº† A/B Testï¼Œç‚¹å‡»ç‡æ¯”è¾ƒé«˜çš„æ ‡é¢˜ä¼šè¢«é€‰ä¸ºè¿™æ¡æ–°é—»çš„æ ‡é¢˜ã€‚è™½ç„¶ä½œä¸ºä¸€ä¸ªå¼€å‘äººå‘˜ï¼Œæˆ‘æ˜¯äº†è§£ A/B Test çš„ï¼Œä½†å½“æ—¶çœ‹å®Œè¿™æ¡æˆ‘è¿˜æ˜¯æœ‰ç‚¹æƒŠè®¶çš„ã€‚è¿™å¸å¼•åˆ°äº†æˆ‘ï¼Œæ°å·§è¿™æœ¬ä¹¦åœ¨ Amazon ä¸Šç‰¹ä»·ï¼Œåªéœ€ 0.1 å…ƒï¼Œäºæ˜¯æ˜¯å…¥æ‰‹å’¯ã€‚</p><p>ä¸‹åˆ°ä¹¦ä»¥åï¼Œå‘ç°è¿™å…¶å®æ˜¯ä¸€ä¸ªåšä¸»çš„åšå®¢æ–‡é›†ï¼Œä»ç›®å½•æ¥çœ‹å¤§ä½“åˆ†æˆäº†ä¸‰ä¸ªéƒ¨åˆ†ï¼Œ</p><ol><li>åå¸¸è¯†æ€ç»´ - ä¸»è¦ä»‹ç»äº†ä¸€äº›æœ‰æ‚–äºæˆ‘ä»¬å¸¸è¯†ä½†æ˜¯ç¡®å®æœ‰ç§‘å­¦ä¾æ®ä¸œè¥¿</li><li>æˆåŠŸå­¦çš„è§£è¯ - ä¸€äº›åˆ‡å®å¯è¡Œçš„æˆåŠŸå­¦æ–¹æ³•</li><li>éœé‡‘çš„ç­”æ¡ˆ - è¯´å®è¯ï¼Œå¯¹è¿™ä¸ªéƒ¨åˆ†çš„å†…å®¹ä¸å¤ªæ„Ÿå†’ï¼Œå°±è‰è‰ç•¥è¿‡äº†</li></ol><h2 id="åå¸¸è¯†æ€ç»´"><a href="#åå¸¸è¯†æ€ç»´" class="headerlink" title="åå¸¸è¯†æ€ç»´"></a>åå¸¸è¯†æ€ç»´</h2><p>è¿™ä¸€éƒ¨åˆ†ä¸»è¦æ˜¯ä½œè€…å¯¹äºç”Ÿæ´»ä¸­æŸäº›äº‹æƒ…çš„è§‚ç‚¹ï¼Œå¹¶ä»¥å¤§é‡çš„äº‹ä¾‹ä»¥åŠå®¢è§‚åˆ†æåŠ ä»¥ä½è¯ã€‚å…¶ä¸­ä½œè€…çš„å¤§éƒ¨åˆ†è§‚ç‚¹æˆ‘éƒ½æ˜¯éå¸¸è®¤åŒçš„ã€‚å…¶å®ä»–æåˆ°çš„å¾ˆå¤šé—®é¢˜éƒ½å¯ä»¥åœ¨<a href="https://zh.wikipedia.org/wiki/%E8%AA%8D%E7%9F%A5%E5%81%8F%E8%AA%A4%E5%88%97%E8%A1%A8" target="_blank" rel="external">è®¤çŸ¥åè¯¯åˆ—è¡¨</a>ä¸­æ‰¾åˆ°ç›¸å…³çš„æ¡ç›®ï¼Œæˆ‘æ˜¯éå¸¸å¸Œæœ›å¤§å®¶å¯ä»¥å¹³æ—¶æ²¡äº‹å¤šçœ‹çœ‹è¿™ä¸ªåˆ—è¡¨ï¼Œå› ä¸ºå®ƒèƒ½å¤Ÿè®©æˆ‘ä»¬å¯¹è‡ªå·±æœ‰æ›´åŠ å®¢è§‚ã€æ¸…æ™°çš„è®¤è¯†ã€‚</p><h2 id="æˆåŠŸå­¦çš„è§£è¯"><a href="#æˆåŠŸå­¦çš„è§£è¯" class="headerlink" title="æˆåŠŸå­¦çš„è§£è¯"></a>æˆåŠŸå­¦çš„è§£è¯</h2><p>è¿™éƒ¨åˆ†åº”è¯¥æ˜¯è¿™æœ¬ä¹¦çš„é‡å¤´æˆï¼Œå› ä¸ºå’Œä¸€èˆ¬çš„æˆåŠŸå­¦ä¹¦ç±ä¸å¤ªä¸€æ ·ï¼Œä½œè€…æä¾›äº†ç‰¹åˆ«å¤šçš„å¯ä»¥ç«‹å³ä¸Šæ‰‹çš„æ–¹æ¡ˆã€‚</p><h3 id="åˆ»æ„ç»ƒä¹ "><a href="#åˆ»æ„ç»ƒä¹ " class="headerlink" title="åˆ»æ„ç»ƒä¹ "></a>åˆ»æ„ç»ƒä¹ </h3><p>å¤§å®¶ä¸€å®šéƒ½å¬è¿‡ã€Œä¸€ä¸‡å°æ—¶å®šç†ã€ï¼Œä¸€ä¸ªäººè¦æƒ³åœ¨ä¸€ä¸ªé¢†åŸŸå†…æˆä¸ºé¡¶å°–é«˜æ‰‹ï¼Œåªè¦ç»ƒä¹ ä¸€ä¸‡å°æ—¶å³å¯ã€‚è¯»å®Œäº†ã€Œç»ƒä¹ ä¸€ä¸‡å°æ—¶æˆå¤©æ‰ã€è¿™ç¯‡æ–‡ç« åï¼Œæˆ‘äº†è§£äº†ï¼Œå…¶å®å¯¹äºã€Œæˆä¸ºå¤©æ‰ã€è¿™ä»¶äº‹æƒ…æ¥è¯´ï¼Œ<a href="https://en.wikipedia.org/wiki/Practice_(learning_method" target="_blank" rel="external">åˆ»æ„ç»ƒä¹ </a>#Deliberate_practice)ä¹˜ä»¥å¤©èµ‹æ‰èƒ½å†³å®šæœ€ç»ˆçš„ç»“æœã€‚ä½•ä¸ºåˆ»æ„ç»ƒä¹ ï¼Ÿä¹¦ä¸­ç»™äº†å¾ˆå¥½çš„æ€»ç»“ï¼Œ</p><ol><li>åªåœ¨ã€Œå­¦ä¹ åŒºã€å†…ç»ƒä¹ </li><li>æŠŠè®­ç»ƒå†…å®¹åˆ‡åˆ†æˆå°å—ï¼Œé‡å¤ç»ƒä¹ </li><li>éšæ—¶è·å¾—æœ‰æ•ˆåé¦ˆ</li><li>æ³¨æ„åŠ›é«˜åº¦é›†ä¸­</li></ol><p>ä½•ä¸ºã€Œå­¦ä¹ åŒºã€ï¼Ÿå¤§å®¶ä¸€å®šéƒ½å¬è¿‡ã€Œé€ƒç¦»èˆ’é€‚åŒºã€ï¼Œé‚£ä»€ä¹ˆæ˜¯ã€Œèˆ’é€‚åŒºã€ï¼Ÿèˆ’é€‚åŒºé‡Œè¾¹çš„ä¸œè¥¿å…¶å®å°±æ˜¯ä½ å·²ç»ç†Ÿç»ƒæŒæ¡çš„ï¼Œè¿™æ˜¯ç”Ÿæ´»ï¼›å­¦ä¹ åŒºçš„ä¸œè¥¿æ˜¯è¿˜ä¸ä¼šï¼Œä½†æ˜¯é€šè¿‡ä¸€å®šçš„å­¦ä¹ å°±èƒ½æŒæ¡çš„ï¼Œè¿™æ˜¯ç»ƒä¹ ï¼›ææ…ŒåŒºä¸­çš„ä¸œè¥¿æ˜¯æ€ä¹ˆçœ‹éƒ½ä¸ä¼šçš„ã€‚åˆ»æ„ç»ƒä¹ é’ˆå¯¹çš„å°±æ˜¯å­¦ä¹ åŒºå†…çš„å†…å®¹ï¼Œå¾…ç»­åšè‡ªå·±åšä¸å¥½çš„äº‹æƒ…ã€‚åªè¦ä¸åœåœ°åœ¨å­¦ä¹ åŒºå†…ç»ƒä¹ ï¼Œé‚£ä»–å°±ä¼šä¸åœåœ°è¿›æ­¥ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">|------------------|</div><div class="line">|                  |</div><div class="line">|  |------------|  |</div><div class="line">|  |            |  |</div><div class="line">|  | |--------| |  |</div><div class="line">|  | | èˆ’é€‚åŒº  | |  |</div><div class="line">|  | |--------| |  |</div><div class="line">|  |   å­¦ä¹ åŒº    |  |</div><div class="line">|  |------------|  |</div><div class="line">|      ææ…ŒåŒº       |</div><div class="line">|------------------|</div></pre></td></tr></table></figure><h3 id="é«˜æ•ˆã€Œå†²æµªã€çš„æ–¹æ³•"><a href="#é«˜æ•ˆã€Œå†²æµªã€çš„æ–¹æ³•" class="headerlink" title="é«˜æ•ˆã€Œå†²æµªã€çš„æ–¹æ³•"></a>é«˜æ•ˆã€Œå†²æµªã€çš„æ–¹æ³•</h3><p>&gt;<br>çœ‹å®Œä¸€ç¯‡å†çœ‹ä¸‹ä¸€ç¯‡ï¼Œä¸€ç¯‡ç¯‡åœ°è¯»ä¸‹å»ï¼Œé‚£æ˜¯é”™è¯¯çš„åšæ³•ã€‚</p><p>ä½œè€…æä¾›äº†å¯ä»¥å®æ–½çš„é«˜æ•ˆä¸Šç½‘æ–¹æ¡ˆï¼ˆå…¶å®æˆ‘ä¹Ÿæ˜¯ä¸€ç›´è¿™ä¹ˆåšçš„ï¼Œé€ƒï¼‰å¤§æ¦‚å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰æ­¥ï¼š</p><ol><li>éšä¾¿ç¿»ç¿» <br><br>é€‰ä¸€ä¸ªé›†ä¸­çš„æ—¶é—´æ®µï¼ŒæŠŠæƒ³è¦çœ‹çš„ç«™ç‚¹å…¨éƒ¨æ‰“å¼€ï¼Œå¯¹äºæƒ³çœ‹çš„æ–‡ç« ï¼Œåœ¨æ–°çš„ Tab ä¸­æ‰“å¼€ï¼Œè¿™ä¸ªæ—¶å€™ä¸å»è¯»è¿™äº›æ–°çš„æ ‡ç­¾é¡µã€‚</li><li>ç•¥è¯» <br><br>å¯¹äºè¿™äº›å·²ç»æ‰“å¼€çš„æ ‡ç­¾é¡µï¼Œç²—è¯»ä¸€ä¸‹ï¼ŒæŠŠå€¼å¾—è¯»çš„æ–‡ç« ä¿å­˜åˆ° Pocket ä¸­ï¼ˆæˆ–è€…æ˜¯å…¶å®ç±»ä¼¼çš„ Read Later Serviceï¼‰ã€‚</li><li>ç²¾è¯» <br><br>ä»”ç»†è¯»å®Œï¼Œå¯¹äºå¥½åˆ°ä¸è¡Œçš„æ–‡ç« å¯ä»¥æŠŠå®ƒä¿å­˜åˆ° Evernote ä¸­ï¼Œè¿›è¡Œæ‰¹æ³¨ã€‚</li></ol><p>è¿™ç§æ–¹æ³•ä¹Ÿå¼•ç”³å‡ºäº†ä¸€ä¸ªå¿ƒç†å­¦çš„æ¦‚å¿µï¼Œnarrow framing å’Œ broad framingã€‚ä¸€æ¡ä¸€æ¡æ¥ç€è¯»å°±æ˜¯ narrow framingï¼Œè€ŒæŠŠæ‰€æœ‰çš„æ–‡ç« éƒ½æ‘†åœ¨æ¡Œé¢ä¸Šé›†ä¸­é€‰æ‹©å°±æ˜¯ broad framingã€‚ä½ çš„æ—¶é—´éå¸¸æœ‰é™ï¼Œbroad framing æ˜¯ä¸€ç§å¾ˆå¥½çš„å†³ç­–æ–¹å¼ã€‚</p><h3 id="è¯»ä¹¦ç¬”è®°"><a href="#è¯»ä¹¦ç¬”è®°" class="headerlink" title="è¯»ä¹¦ç¬”è®°"></a>è¯»ä¹¦ç¬”è®°</h3><p>ä½œè€…å¯¹äºç¬”è®°çš„é‡è¦æ€§çš„è§‚ç‚¹æˆ‘ä¹Ÿæ˜¯å¾ˆèµåŒã€‚äººäººéƒ½çŸ¥é“è®°ç¬”è®°å¥½ï¼Œä½†æ˜¯æ€ä¹ˆè®°ï¼Œåº”ç”¨èµ·æ¥åˆæ˜¯å¦ä¸€å›äº‹äº†ã€‚</p><p>å…¶å®å†™è¿™ç¯‡è¯»ä¹¦ç¬”è®°æ˜¯æˆ‘çš„ç¬¬ä¸€ç¯‡ï¼Œæˆ‘ä¹Ÿæ˜¯é€šè¿‡ä½œè€…æä¾›çš„æ–¹æ³•ï¼Œä¸€æ­¥ä¸€æ­¥æ…¢æ…¢å®ç°çš„ã€‚</p><ul><li><p>è¯»ä»€ä¹ˆï¼Ÿ<br><br>èƒ½æå‡è‡ªå·±å¯¹æŸä¸€é¢†åŸŸç†è§£çš„ï¼Œèƒ½å¤Ÿæœ‰ä¸€ç§æ™ºåŠ›å¾—åˆ°æå‡çš„æ„Ÿè§‰ï¼ˆå“ªæ€•æ˜¯é”™è§‰ï¼‰çš„éå°è¯´ç±»ä¹¦ç±ã€‚</p></li><li><p>æ€ä¹ˆè¯»ï¼Ÿ <br><br>æ–°ä¹¦è¯»ä¸¤éï¼Œç¬¬ä¸€éæ­£å¸¸é€šè¯»ï¼Œä¸æ±‚å¿«ï¼Œèƒ½æ—¶ä¸æ—¶åœä¸‹æ€è€ƒæ˜¯æœ€å¥½ã€‚ç¬¬äºŒéï¼Œå¼€å§‹è®°ç¬”è®°ï¼Œä¸»è¦æ˜¯æ€æƒ³è„‰ç»œï¼Œè¯»ä¸€ç« è®°ä¸€ç« ï¼Œè¯»å®Œäº†è¿™æœ¬ä¹¦å°±å¯ä»¥æ‰”äº†ã€‚</p></li><li><p>æ€ä¹ˆè®°ç¬”è®°ï¼Ÿ <br></p><ol><li>æ¸…æ™°åœ°è¡¨ç°æ¯ä¸€ç« çš„é€»è¾‘è„‰ç»œï¼Œå¦‚æœä½ å–œæ¬¢ç”¨æ€ç»´å¯¼å›¾è®°ç¬”è®°çš„è¯ï¼Œä¹Ÿåªä¸è¿‡æ˜¯å®Œäº†å¥½çš„è¯»ä¹¦ç¬”è®°çš„ä¸€éƒ¨åˆ†ã€‚</li><li>å¸¦èµ°ä¹¦ä¸­æ‰€æœ‰çš„äº®ç‚¹ï¼ŒæŠŠæ‰€æœ‰ä½ è§‰å¾—æ˜¯äº®ç‚¹çš„éƒ½å¸¦èµ°ï¼Œé‚£è¿™æœ¬ä¹¦åœ¨è®°å®Œç¬”è®°ä¹‹åå°±çœŸçš„å¯ä»¥æ‰”æ‰æˆ–è€…é€äººäº†ã€‚</li><li>æœ‰å¤§é‡çš„çœ‹æ³•å’Œå¿ƒå¾—</li><li>æ‰¾åˆ°ä¸ä¹‹å‰è¯»è¿‡çš„ä¹¦æˆ–æ–‡ç« çš„è”ç³»</li></ol></li></ul><h1 id="ä¹¦ä¸­çš„ä¸€äº›-Shinning-Things"><a href="#ä¹¦ä¸­çš„ä¸€äº›-Shinning-Things" class="headerlink" title="ä¹¦ä¸­çš„ä¸€äº› Shinning Things"></a>ä¹¦ä¸­çš„ä¸€äº› Shinning Things</h1><p>&gt;</p><ul><li>æ¯å¤©ç»™è‡ªå·±åˆ¶å®šä¸€ä¸ªæ›´è¿œçš„ç›®æ ‡ã€‚</li><li>è’™æ´›è¿ªè¯ºè¯´ï¼Œäººåšåˆ¤æ–­çš„æ—¶å€™æœ‰ä¸¤ç§æœºåˆ¶ï¼šä¸€ç§æ˜¯ â€œç§‘å­¦å®¶æœºåˆ¶â€ï¼Œå…ˆæœ‰è¯æ®å†ä¸‹ç»“è®ºï¼›ä¸€ç§æ˜¯ â€œå¾‹å¸ˆæœºåˆ¶â€ï¼Œå…ˆæœ‰äº†ç»“è®ºå†å»æ‰¾è¯æ®ã€‚ä¸–ç•Œä¸Šç§‘å­¦å®¶å¾ˆå°‘ï¼Œä½ çŒœç»å¤§å¤šæ•°äººä½¿ç”¨ä»€ä¹ˆæœºåˆ¶æ€è€ƒï¼Ÿæ¯ä¸ªäººéƒ½çˆ±çœ‹èƒ½å°è¯è‡ªå·±å·²æœ‰è§‚å¿µçš„ä¸œè¥¿ã€‚æˆ‘ä»¬ä¸ä½†ä¸çˆ±çœ‹ï¼Œè€Œä¸”è¿˜ä¼šç›´æ¥å¿½ç•¥ï¼Œé‚£äº›ä¸ç¬¦åˆæˆ‘ä»¬å·²æœ‰è§‚å¿µçš„è¯æ®ã€‚</li><li>å¦‚æœå¾®åšä¸Šæœ‰äººå‘å‡ºè¿èƒŒæˆ‘ç†å¿µçš„è¨€è®ºæ€ä¹ˆåŠï¼Ÿæˆ‘ä¼šæœæ–­å–æ¶ˆå¯¹ä»–çš„å…³æ³¨ã€‚æˆ‘ä»¬å®Œå…¨æœ‰æƒè¿™ä¹ˆåšï¼Œéš¾é“æœ‰äººä¸Šå¾®åšæ˜¯ä¸ºäº†æ‰¾æ°”å—å—ï¼Ÿå¯æ˜¯å¦‚æœäººäººéƒ½åªæ¥æ”¶ç¬¦åˆè‡ªå·±è§‚ç‚¹çš„ä¿¡æ¯ï¼Œç”šè‡³åªè·Ÿä¸è‡ªå·±å¿—åŒé“åˆçš„äººäº¤æµï¼Œé‚£ä¹ˆå°±ä¼šå½¢æˆä¸€ä¸ªâ€œå›éŸ³å®¤æ•ˆåº”ï¼ˆechochambereffectï¼‰â€ã€‚äººä»¬çš„è§‚å¿µå°†ä¼šå˜å¾—è¶Šæ¥è¶Šæç«¯ã€‚</li><li>ç®¡ç†è€…æœ‰ä¸ªå¸¸è§çš„æ€ç»´æ¨¡å¼ï¼Œä¸€æ—¦å‡ºäº†äº‹å°±å¿…é¡»å…¨ä½“åæ€ï¼Œåˆ¶å®šç›¸å…³æ”¿ç­–ä»¥é¿å…ç±»ä¼¼äº‹æ•…å†æ¬¡å‘ç”Ÿï¼Œä½†æå°æ¦‚ç‡äº‹æ•…å…¶å®æ˜¯ä¸å€¼å¾—è¿‡åº¦ååº”çš„ã€‚å“ªæ€•æ˜¯å› ä¸ºå‘˜å·¥çŠ¯äº†é”™è€Œå¼•èµ·çš„ä¹Ÿæ²¡å¿…è¦å¦‚æ­¤ã€‚37 signalså…¬å¸çš„ä¸¤ä½åˆ›å§‹äººå¼—è±å¾·ï¼ˆJason Friedï¼‰å’Œæ±‰æ£®ï¼ˆDavid Heinemeier Hanssonï¼‰åœ¨2010å¹´å‡ºäº†ä¸€æœ¬ä¹¦ã€Šé‡æ¥ã€‹ï¼ˆReworkï¼‰ï¼Œè®²å…¬å¸åˆ›ä¸šå’Œç®¡ç†ä¹‹é“ã€‚åœ¨æˆ‘çœ‹æ¥æ­¤ä¹¦ä¸€ä¸ªäº®ç‚¹å°±æ˜¯å®ƒå¼ºè°ƒä¸è¦ä¸€çœ‹æœ‰äººçŠ¯äº†é”™å°±ä¸ºæ­¤å¤§å¼ æ——é¼“åœ°åˆ¶å®šæ”¿ç­–æ¥çº æ­£é”™è¯¯ã€‚é‚£æ ·åªä¼šæŠŠé”™è¯¯å˜æˆä¼¤ç–¤ï¼Œè€Œä¸”ä¼šè®©å…¬å¸è¶Šæ¥è¶Šå®˜åƒšä¸»ä¹‰ã€‚æ­£ç¡®çš„åŠæ³•æ˜¯å‘Šè¯‰çŠ¯é”™çš„å‘˜å·¥è¿™æ˜¯ä¸€ä¸ªé”™è¯¯ï¼Œç„¶åå°±å®Œäº†ã€‚</li><li>æœ‰äº†å„ç§åº“å‡½æ•°ï¼Œç¼–ç¨‹æ˜¯å¦‚æ­¤çš„ç®€å•ï¼Œä»¥è‡³äºé«˜ä¸­ç”Ÿä¹Ÿä¼šå†™ç¨‹åºï¼Œå¯æ˜¯æœ€å¥½çš„ç¨‹åºå‘˜ä»ç„¶å¯ä»¥æŠŠç¼–ç¨‹ä»æŠ€æœ¯ä¸Šå‡åˆ°è‰ºæœ¯çš„å¢ƒç•Œã€‚<br>-å¦‚æœèƒ½é€šè¿‡è¯»ä¹¦æ¥äº†è§£ä¸€äº›å‰è¾ˆçš„ç»éªŒï¼ŒæŒæ¡ä¸€ç‚¹åšäº‹çš„æ–¹æ³•ï¼Œç”šè‡³å“ªæ€•ä»…ä»…è·å¾—ä¸€ç§æ›´ä¹è§‚å‘ä¸Šçš„ç²¾ç¥ï¼Œå…¶å®éƒ½æ˜¯å¾ˆä¸é”™çš„æ”¶è·ã€‚è¯»ä¹¦éš¾é“ä¸å°±æ˜¯ä¸ºäº†è¿™äº›å—ï¼Ÿ</li><li>è‡ªæ§éœ€è¦æ„å¿—åŠ›ã€‚ä¸€èˆ¬äººå¯èƒ½è®¤ä¸ºæ„å¿—åŠ›æ˜¯ä¸€ç§ç¾å¾·ï¼Œåº”è¯¥é€šè¿‡æ•™è‚²çš„æ–¹å¼æå‡æ€æƒ³çš„å¢ƒç•Œæ¥åŸ¹å…»ã€‚ç„¶è€Œå®éªŒè¡¨æ˜ï¼Œæ„å¿—åŠ›å…¶å®æ˜¯ä¸€ç§ç”Ÿç†æœºèƒ½ã€‚å®ƒå°±å¥½åƒäººçš„è‚Œè‚‰ä¸€æ ·æ¯æ¬¡ä½¿ç”¨éƒ½éœ€è¦æ¶ˆè€—èƒ½é‡ï¼Œè€Œä¸”ç”¨å¤šäº†ä¼šç–²æƒ«ã€‚</li><li>äººçš„æ„å¿—åŠ›èƒ½é‡æ¥è‡ªè¡€æ¶²ä¸­çš„è‘¡è„ç³–ã€‚</li><li>ç»ƒä¹ çš„ç²¾é«“æ˜¯è¦æŒç»­åœ°åšè‡ªå·±åšä¸å¥½çš„äº‹ã€‚</li><li>åªè¦æœ‰å¿«é€Ÿåé¦ˆï¼Œå†ç»è¿‡é•¿æ—¶é—´çš„è®­ç»ƒï¼Œä½ å°±èƒ½åŸ¹å…»å‡ºä¸“å®¶çš„ç›´è§‰ï¼Œèƒ½å¤Ÿâ€œçœ¨çœ¼åˆ¤æ–­â€ã€‚å¯æ˜¯ï¼Œå¦‚æœåé¦ˆæ˜¯ä¸­é•¿æœŸçš„ï¼Œç›´è§‰å°±ä¸å¥½ä½¿äº†ã€‚æˆ‘ä»¬å¯ä»¥å†å¤šæƒ³æƒ³è¿™ä¸ªé—®é¢˜ã€‚ä¹Ÿè®¸åªæœ‰è¿™æ ·çš„â€œç¯å¢ƒå‹å¥½â€é¢†åŸŸï¼Œä¹Ÿå°±æ˜¯æœ‰å¿«é€Ÿåé¦ˆçš„é¢†åŸŸï¼Œæ‰èƒ½åŸ¹å…»å‡ºçœŸæ­£çš„ä¸“å®¶ã€‚</li><li>åœ¨æŸç§ç¨‹åº¦ä¸Šï¼Œåˆ»æ„ç»ƒä¹ æ˜¯ä»¥é”™è¯¯ä¸ºä¸­å¿ƒçš„ç»ƒä¹ ã€‚ç»ƒä¹ è€…å¿…é¡»è¦å¯¹é”™è¯¯æåº¦æ•æ„Ÿï¼Œä¸€æ—¦å‘ç°è‡ªå·±é”™äº†å°±ä¼šæ„Ÿåˆ°éå¸¸ä¸èˆ’æœï¼Œä¸€ç›´ç»ƒä¹ åˆ°æ”¹æ­£ä¸ºæ­¢ã€‚</li><li>æ¯ä¸ªäººçš„æ—¶é—´éƒ½ä¸€æ ·å¤šï¼Œå› æ­¤æ—¶é—´ä¸æ˜¯é‡‘é’±ã€‚æ—¶é—´æ˜¯å›´æ£‹ï¼šä½ èµ°ä¸€æ‰‹ï¼Œç‰›äººä¹Ÿèµ°ä¸€æ‰‹ï¼Œç‰›äººè·èƒœå¹¶ä¸æ˜¯å› ä¸ºä»–èµ°å¾—æ¯”ä½ å¤šï¼Œè€Œæ˜¯ä»–æ¯ä¸€æ‰‹éƒ½èµ°åœ¨æœ€æœ‰ä»·å€¼çš„åœ°æ–¹ã€‚æ‰§è¡Œè¿™æ ·çš„æ•ˆç‡ï¼Œéœ€è¦é’¢é“èˆ¬çš„æ„å¿—ã€‚è°èƒ½åšåˆ°ä¸çœ‹æ— èŠçš„æ–‡ç« ï¼Œè°èƒ½åšåˆ°ä¸å»åˆ·æ–°ç½‘é¡µï¼Œè°èƒ½åšåˆ°ä¸çœ‹ç”µè§†æ–°é—»ï¼Ÿç‰›äººéƒ½èƒ½åšåˆ°ã€‚</li><li>çŸ¥è¯†æ˜¯æœ‰ç­‰çº§çš„ã€‚å…«å¦æ–°é—»ã€å®æ•ˆæ€§å¼ºçš„ä¿¡æ¯ã€ç½‘å‹å¯¹æ—¶å±€çš„çœ‹æ³•ï¼Œæœ¬æ¥å°±ä¸å€¼å¾—å°åœ¨çº¸ä¸Šæµªè´¹æ ‘æœ¨ï¼Œåœ¨ç½‘ä¸Šçœ‹çœ‹æ­£å¥½ã€‚æ‰«è¯»ç½‘é¡µä¸è§å¾—æ˜¯ä»€ä¹ˆæ¯›ç—…ï¼Œç›¸åï¼Œèƒ½å¤Ÿä»¥ä¸åŒé€Ÿåº¦è¯»ä¸åŒç­‰çº§çš„å†…å®¹æ˜¯æœ€æœ‰ç”¨çš„é˜…è¯»æŠ€æœ¯ã€‚ä¸Šç½‘çš„å…³é”®æ€åº¦æ˜¯è¦æˆä¸ºç½‘ç»œçš„ä¸»äººï¼Œè€Œä¸åšå„ç§è¶…é“¾æ¥çš„å¥´éš¶ã€‚é«˜æ•ˆç‡çš„ä¸Šç½‘åº”è¯¥åƒè‡ªé—­ç—‡æ‚£è€…ä¸€æ ·å…·æœ‰å¾ˆå¼ºçš„ç›®çš„æ€§ï¼Œä»¥æˆ‘ä¸ºä¸»ï¼Œä¸è¢«æ— å…³ä¿¡æ¯å·¦å³ã€‚å°±ç®—æ˜¯çº¯ç²¹ä¸ºäº†å¨±ä¹ä¸Šç½‘ä¹Ÿæ— å¯åšéï¼Œè¿™æ—¶å€™è¯»å¾—å¿«å°±æ˜¯ä¼˜ç‚¹ã€‚ä¸€ä¸ªçœŸæ­£çš„æ™ºè€…ä¸ä¼šè®©ä¸Šç½‘å ç”¨è¯»ä¹¦æ—¶é—´ï¼Œä»–åº”è¯¥ç»å¸¸èƒ½å¤Ÿå¹³é™åœ°æ·±å…¥æ€è€ƒï¼Œåªæœ‰ç”µè¯æ¥çº¿å‘˜æ‰éšå«éšåˆ°ã€‚</li><li>å¦‚æœçµé­‚çœŸçš„å­˜åœ¨ï¼Œé‚£ä¹ˆå°±åº”è¯¥æ— å¤„ä¸åœ¨ï¼Œè€Œä¸æ˜¯éå¾—æœ‰çµå¼‚ç°è±¡æ‰èƒ½è¯æ˜çµé­‚å­˜åœ¨ã€‚ä¸€ä¸ªæœ‰çµé­‚çš„ä¸–ç•Œï¼Œæ¯ä¸ªæ–°ç”Ÿå‘½éƒ½ä¸æ˜¯å®Œå…¨â€œæ–°â€çš„ï¼Œå…¶çµé­‚å¿…ç„¶å·²ç»ç»å†è¿‡å¥½å‡ æ¬¡åˆ«çš„ç”Ÿå‘½ï¼›è€Œåœ¨ä¸€ä¸ªæ²¡æœ‰çµé­‚çš„ä¸–ç•Œï¼Œæ¯ä¸€ä¸ªæ–°ç”Ÿå‘½éƒ½æ˜¯å®Œå…¨æ–°çš„ã€‚è¿™ä¸¤ä¸ªä¸–ç•Œçš„è¡¨ç°å¦‚æœå®Œå…¨ä¸€æ ·ï¼Œé‚£ä¹ˆä¹Ÿå°±æ˜¯çµé­‚ä¸å¯æµ‹é‡ï¼Œé‚£ä¹ˆæœ‰æ²¡æœ‰çµé­‚è¿™ä¸ªé—®é¢˜å°±æ¯«æ— æ„ä¹‰ï¼Œå†ç”¨è½¬ä¸–è½®å›å­¦è¯´å»åŠäººå‘å–„ä¹Ÿæ²¡æ„ä¹‰ï¼ˆå› ä¸ºåæ­£éƒ½ä¸€æ ·ï¼‰ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å‡è®¾ï¼Œä¸€ä¸ªæœ‰çµé­‚å­˜åœ¨çš„ä¸–ç•Œï¼Œå¿…ç„¶å­˜åœ¨æŸäº›å¯è§‚æµ‹çš„é‡ï¼Œä»£è¡¨çµé­‚è½¬ä¸–å¯¹è¿™ä¸ªä¸–ç•Œçš„å½±å“ã€‚</li><li>æ‰“æ¸¸æˆå¯¹äººè„‘çš„è®¤çŸ¥èƒ½åŠ›å¯èƒ½æœ‰ç”¨ï¼Œä½†ä¹Ÿæœ‰ç ”ç©¶è®¤ä¸ºæ²¡ç”¨ã€‚ä¸ç®¡æ˜¯å¦çœŸçš„æœ‰ç”¨ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥æƒ³è§å°±ç®—æœ‰ç”¨å…¶ç”¨å¤„ä¹Ÿä¸å¤§ã€‚å¦‚æœä½ æƒ³å­¦å¥½å¾®ç§¯åˆ†ï¼Œä½ æœ€å¥½çš„åŠæ³•æ˜¯æ‰¾æœ¬å¾®ç§¯åˆ†ä¹ é¢˜é›†åšï¼Œè€Œä¸æ˜¯ç”¨å¤§è„‘è®­ç»ƒè½¯ä»¶å»è¯•å›¾æŠŠå¤§è„‘ç£¨å¿«ä¸€ç‚¹å†å­¦å¾®ç§¯åˆ†ï¼Œé‚£ç­‰äºç¼˜æœ¨æ±‚é±¼ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      
      
        &lt;ul&gt;
&lt;li&gt;Start:  2016-12-31&lt;/li&gt;
&lt;li&gt;Finish: 2017-01-01&lt;/li&gt;
&lt;li&gt;link: &lt;a href=&quot;https://book.douban.com/subject/25986341/&quot; target=&quot;_blank&quot; r
      
    
    </summary>
    
    
      <category term="è¯»ä¹¦ç¬”è®°" scheme="http://zhaoxinyu.me/tags/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/"/>
    
  </entry>
  
  <entry>
    <title>&lt;è¯‘&gt; å¦‚ä½•é˜…è¯» Swift æ ‡å‡†åº“ä¸­çš„æºç </title>
    <link href="http://zhaoxinyu.me/2016-12-04-how-to-read-the-swift-standard-libray-source/"/>
    <id>http://zhaoxinyu.me/2016-12-04-how-to-read-the-swift-standard-libray-source/</id>
    <published>2016-12-10T12:17:00.000Z</published>
    <updated>2016-12-10T12:20:08.000Z</updated>
    
    <content type="html"><![CDATA[<p>åŸæ–‡é“¾æ¥=<a href="https://oleb.net/blog/2016/10/swift-stdlib-source/" target="_blank" rel="external">https://oleb.net/blog/2016/10/swift-stdlib-source/</a><br>ä½œè€…=Ole Begemann<br>è¯‘è€…=X140Yu</p><!--æ­¤å¤„å¼€å§‹æ­£æ–‡--><p><strong>åœ¨è¿›è¡Œå®Œ GYP é¢„å¤„ç†åï¼Œé˜…è¯» Swift æ ‡å‡†åº“æºç çš„<del>æœ€ç®€å•çš„</del>ä¸€ç§æ–¹å¼æ˜¯æ‰§è¡Œä¸€æ¬¡å®Œæ•´çš„ Swift ç¼–è¯‘ã€‚ï¼ˆå¦ä¸€ç§æ˜¯å†™ä¸€å°æ®µ shell è„šæœ¬ã€‚å¯ä»¥çœ‹ä¸‹é¢çš„æ›´æ–°ï¼‰</strong></p><p>å¦‚æœä½ æƒ³è¦å¼€å§‹é˜…è¯» Swift æºç ï¼Œé‚£å®ƒçš„æ ‡å‡†åº“åº”è¯¥æ˜¯é¦–å…ˆå¼€å§‹é˜…è¯»çš„åœ°æ–¹ã€‚æ ‡å‡†åº“ä¸­çš„ä»£ç æ˜¯å’Œæ¯ä¸€ä¸ªä½¿ç”¨ Swift çš„å¼€å‘è€…éƒ½æ¯æ¯ç›¸å…³çš„ï¼Œå¦‚æœä½ ä¹Ÿæ›¾ç»å¯¹æŸä¸ª API çš„è¡¨ç°å’Œæ€§èƒ½æœ‰è¿‡æ€€ç–‘ï¼Œé‚£ä¹ˆç›´æ¥é˜…è¯»å¯¹åº”çš„æºç ä¼šæ˜¯è§£å†³é—®é¢˜æœ€å¿«çš„æ–¹å¼ã€‚</p><p>æ ‡å‡†åº“ä¹Ÿæ˜¯ Swift é¡¹ç›®ä¸­æœ€å®¹æ˜“æ¥è§¦çš„åœ°æ–¹ã€‚ä¸€ç‚¹æ˜¯å› ä¸ºï¼Œå®ƒæ˜¯ç”± Swift å†™çš„ï¼Œè€Œä¸æ˜¯ C++ã€‚å› ä¸ºä½ æ¯å¤©éƒ½ç”¨å®ƒï¼Œæ‰€ä»¥å¯¹å®ƒçš„ API ä¹Ÿä¼šéå¸¸ç†Ÿæ‚‰ã€‚è¿™å°±æ„å‘³ç€ï¼Œåœ¨æºç ä¸­æ‰¾åˆ°ä½ æƒ³è¦æ‰¾çš„é‚£éƒ¨åˆ†ä»£ç ä¸æ˜¯ç‰¹åˆ«å›°éš¾ã€‚å¦‚æœä½ åªæ˜¯æ²¡æœ‰å¸¦ç€ç›®æ ‡è€Œæ³›æ³›åœ°çœ‹ï¼Œé‚£ä¹ˆåœ¨æºç ä¸­ä½ å¯èƒ½ä¼šå‘ç°<a href="https://oleb.net/blog/2016/09/playground-print-hook/" title="_playgroundPrintHook" target="_blank" rel="external">ä¸€</a>æˆ–è€…<a href="https://oleb.net/blog/2016/10/swift-array-of-c-strings/" title="Passing an Array of Strings from Swift to C" target="_blank" rel="external">ä¸¤</a>å—é‡‘å­.</p><h1 id="åœ¨å“ªé‡Œèƒ½æ‰¾åˆ°æ ‡å‡†åº“çš„æºç ï¼Ÿ"><a href="#åœ¨å“ªé‡Œèƒ½æ‰¾åˆ°æ ‡å‡†åº“çš„æºç ï¼Ÿ" class="headerlink" title="åœ¨å“ªé‡Œèƒ½æ‰¾åˆ°æ ‡å‡†åº“çš„æºç ï¼Ÿ"></a>åœ¨å“ªé‡Œèƒ½æ‰¾åˆ°æ ‡å‡†åº“çš„æºç ï¼Ÿ</h1><p>æ ‡å‡†åº“çš„ä»£ç åœ¨ <a href="https://github.com/apple/swift/tree/master/stdlib/public/core" target="_blank" rel="external"><code>stdlib/public/core</code></a>ï¼ŒGitHub ä¸Šçš„ <a href="https://github.com/apple/swift" target="_blank" rel="external">Swift ä»“åº“ä¸­</a>ã€‚ä½ å¯ä»¥åœ¨é‡Œé¢æ‰¾åˆ°æ‰€æœ‰ public typesï¼Œprotocols å’Œ functionsã€‚ä½ å¯ä»¥åœ¨æµè§ˆå™¨ä¸­æˆ–è€…æŠŠä»£ç  clone åˆ°æœ¬åœ°çš„æœºå™¨ä¸Šé˜…è¯»ã€‚ä½†æ˜¯ï¼Œä¸€ä¸ªæ¯”è¾ƒå¤æ‚çš„åœ°æ–¹åœ¨äºï¼Œå¤§çº¦ 1/3 çš„æ–‡ä»¶éƒ½ä»¥ <code>.swift.gyb</code> ç»“å°¾ï¼Œå¦‚æœä½ æ‰“å¼€å…¶ä¸­ä¸€ä¸ªæ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š<a href="https://github.com/apple/swift/blob/master/stdlib/public/core/FixedPoint.swift.gyb" target="_blank" rel="external"><code>FixedPoint.swift.gyb</code></a>ï¼ˆInt ç±»å‹è¢«å®šä¹‰çš„åœ°æ–¹ï¼‰ï¼Œä½ ä¼šå‘ç°ä¸€ç§å’Œ Swift æ··åˆåœ¨ä¸€èµ·çš„æ¨¡ç‰ˆè¯­è¨€ï¼šGYBã€‚</p><blockquote><p>gyb ä»£è¡¨ Generate Your Boilerplateï¼ˆç”Ÿæˆä½ çš„æ ·æ¿æ–‡ä»¶ï¼‰ã€‚ å®ƒæ˜¯ä¸€ä¸ª Swift å›¢é˜Ÿå¼€å‘çš„é¢„å¤„ç†çš„ä¸€ä¸ªä¸œè¥¿ã€‚å¦‚æœä»–ä»¬éœ€è¦ç¼–è¯‘åä¸ªéå¸¸ç›¸ä¼¼çš„ <code>Int</code>ï¼Œé‚£ä»–ä»¬å°±å¾—æŠŠç›¸åŒçš„ä»£ç å¤åˆ¶ç²˜è´´åæ¬¡ã€‚å¦‚æœä½ æ‰“å¼€æŸä¸ª gyb æ–‡ä»¶ï¼Œä½ ä¼šå‘ç°å…¶ä¸­å¤§éƒ¨åˆ†éƒ½æ˜¯ Swift çš„ä»£ç ï¼Œä½†æ˜¯ä¹Ÿæœ‰ä¸€äº›è¡Œæ˜¯ç”± Python æ„æˆçš„ã€‚è¿™ä¸ª è¿™ä¸ªé¢„å¤„ç†å™¨åœ¨ Swift çš„ä»£ç ä»“åº“ä¸­çš„ <a href="https://github.com/apple/swift/blob/master/utils/gyb" target="_blank" rel="external"><code>utils/gyb</code></a>ï¼Œå°½ç®¡å¤§éƒ¨åˆ†çš„ä»£ç åœ¨ <a href="https://github.com/apple/swift/blob/master/utils/gyb.py" target="_blank" rel="external"><code>utils/gyb.py</code></a>ã€‚</p><p>â€” <a href="https://lists.swift.org/pipermail/swift-users/Week-of-Mon-20151207/000226.html" target="_blank" rel="external">Brent Royal-Gordon</a></p></blockquote><p>æˆ‘ä»¬æ›´æƒ³è¦çœ‹åˆ° <a href="https://twitter.com/gottesmang/status/787493623533215745" target="_blank" rel="external">æ›´å°‘çš„ GYB</a>ï¼Œæ›´å¤šçš„ Swiftï¼Œå› ä¸ºå®ƒ<a href="https://twitter.com/gottesmang/status/787493919072235520" target="_blank" rel="external">æ›´å…·æœ‰è¡¨è¾¾æ€§</a>ï¼Œä½†æ˜¯ç°åœ¨ï¼Œæˆ‘ä»¬ä¸å¾—ä¸çœ‹åˆ°å®ƒä»¬æ··å’Œçš„ä¸€èµ·ã€‚</p><h1 id="å¤„ç†-GYB"><a href="#å¤„ç†-GYB" class="headerlink" title="å¤„ç† GYB"></a>å¤„ç† GYB</h1><p>å¦‚æœä½ åªæƒ³è¦é˜…è¯»æºç ï¼ˆè€Œä¸æ˜¯å‘ Swift è´¡çŒ®ä»£ç ï¼‰ï¼ŒGYB å¸¦æ¥çš„åå¤„è¿œæ¯”å¥½å¤„è¦å¤šã€‚é‚£ä¹ˆæ€ä¹ˆæ¥é¢„å¤„ç†è¿™äº›æ–‡ä»¶å‘¢ï¼Ÿä½ å¯ä»¥ç›´æ¥è¿è¡Œ <code>gyb</code> è„šæœ¬ï¼Œä½†æ˜¯å®ƒä¾èµ–äºä¸€ä¸ªè¢« build è„šæœ¬åˆ›å»ºçš„ç‰¹æ®Šç¯å¢ƒã€‚æœ€å¥½çš„æ–¹å¼æ˜¯æ‰§è¡Œä¸€æ¬¡å®Œæ•´çš„ Swift buildã€‚ä¹Ÿè®¸å¯¹äºé˜…è¯»æºç æ¥è¯´ï¼Œbuild ä¸€æ¬¡å¯èƒ½ä¼šæœ‰ç‚¹è¿‡äº†ï¼Œä½†æ˜¯æˆ‘å‘ç° build ä»¥åï¼Œæºç é˜…è¯»èµ·æ¥ä¼šæ›´å®¹æ˜“ä¸€äº›ã€‚</p><p><strong>æ›´æ–°ï¼š</strong> <a href="https://twitter.com/tonisuter/status/792325666591088668" target="_blank" rel="external">Toni Suter æŒ‡å‡º</a> <code>gyb</code> çš„è„šæœ¬åªä¾èµ–äºä¸€ä¸ªä½ å¯ä»¥æ›´æ”¹çš„å˜é‡ï¼ˆ64-bit å’Œ 32-bit å·®åˆ«ï¼‰ï¼Œå¦‚æœä½ åªæƒ³è¦å¤„ç† gyb, <a href="https://gist.github.com/tonisuter/e47267a25b3dcc90fe75a24d3ed2063a" target="_blank" rel="external">è¿™ä¸ªå°è„šæœ¬</a>æ¯”å®Œæ•´ç¼–è¯‘ä¸€æ¬¡ Swift è¦å¥½å¾ˆå¤šã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">#!/bin/bash</div><div class="line">for f in `ls *.gyb`</div><div class="line">do</div><div class="line">    echo &quot;Processing $f&quot;</div><div class="line">    name=$&#123;f%.gyb&#125;</div><div class="line">    ../../../utils/gyb -D CMAKE_SIZEOF_VOID_P=8 -o $name $f --line-directive &quot;&quot;</div><div class="line">done</div></pre></td></tr></table></figure><p>å®ƒä¼šæŠŠæ‰€æœ‰çš„ <code>.gyb</code> æ–‡ä»¶å¤„ç†å®Œæ¯•åæ”¾åˆ°ç›¸åŒçš„ä½ç½®å¹¶å»é™¤ <code>.gyb</code> åç¼€ã€‚å»é™¤ <code>--line-directive &quot;&quot;</code> åœ¨å¤„ç†å®Œæ¯•çš„æ–‡ä»¶ä¸­æ·»åŠ  source location çš„æ³¨é‡Šï¼ˆå°±åƒ Swift build ä¸­å¤„ç†çš„ä¸€æ ·ï¼‰ã€‚</p><h1 id="ä»æºç ç¼–è¯‘-Swift"><a href="#ä»æºç ç¼–è¯‘-Swift" class="headerlink" title="ä»æºç ç¼–è¯‘ Swift"></a>ä»æºç ç¼–è¯‘ Swift</h1><p>ç¯å¢ƒçš„æ­å»ºå¯ä»¥é˜…è¯» Swift ä»“åº“ä¸­çš„ <a href="https://github.com/apple/swift/blob/master/README.md" target="_blank" rel="external">readme</a>ã€‚ å¦‚æœçš„ Mac æœºå™¨ä¸Šï¼ŒæŒ‰ç…§ä¸‹é¢çš„æ­¥éª¤è¿›è¡Œæ“ä½œï¼ˆä½¿ç”¨ Homebrew å®‰è£…å„ç§ä¾èµ–ï¼‰ï¼Œä½†æ˜¯åˆ«å¿˜è®°æ£€æŸ¥è¿™äº›æ­¥éª¤æ˜¯å¦è¿˜æ­£ç¡®ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"># Install build tools</div><div class="line">brew install cmake ninja</div><div class="line"># Create base directory</div><div class="line">mkdir swift-source</div><div class="line">cd swift-source</div><div class="line"># Clone Swift</div><div class="line">git clone https://github.com/apple/swift.git</div><div class="line"># Clone dependencies (LLVM, Clang, etc.)</div><div class="line">./swift/utils/update-checkout --clone</div></pre></td></tr></table></figure><p>æœ€åä¸€å¥å‘½ä»¤ä¼šæŠŠ build Swift éœ€è¦çš„å…¶å®ƒéƒ¨åˆ†çš„ repo ç»™ clone ä¸‹æ¥ï¼Œæ¯”å¦‚ LLVMï¼ŒClangï¼ŒLLDB ç­‰ç­‰ã€‚å°±åƒå¯¹äº Linux çš„ Foundation å’Œ libdispatch æ¨¡å—ä¸€æ ·ã€‚åœ¨è¿™ä¸€æ­¥è¿‡åï¼Œä½ çš„ <code>swift-source</code> æ–‡ä»¶å¤¹å­ä¼šçœ‹èµ·æ¥åƒè¿™æ ·ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">du -h -d 1</div><div class="line">250M./clang</div><div class="line">4,7M./cmark</div><div class="line"> 47M./compiler-rt</div><div class="line"> 15M./llbuild</div><div class="line">197M./lldb</div><div class="line">523M./llvm</div><div class="line">221M./swift</div><div class="line"> 26M./swift-corelibs-foundation</div><div class="line">7,8M./swift-corelibs-libdispatch</div><div class="line">1,1M./swift-corelibs-xctest</div><div class="line">316K./swift-integration-tests</div><div class="line">960K./swift-xcode-playground-support</div><div class="line">7,0M./swiftpm</div><div class="line">1,3G.</div></pre></td></tr></table></figure><p>ç°åœ¨ä½ å°±å¯ä»¥å¼€å§‹è¿è¡Œ build è„šæœ¬äº†ï¼Œå®ƒä¼šå…ˆå¼€å§‹ build LLVMï¼Œç„¶åæ˜¯ Swiftï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">./swift/utils/build-script -x -R</div></pre></td></tr></table></figure><p>å‚æ•°æ˜¯å¾ˆé‡è¦çš„ï¼š</p><ul><li><code>-x</code> ä¼šç”Ÿæˆä¸€ä¸ª Xcode projectï¼Œä½ å°±å¯ä»¥åœ¨è¿™ä¸ª project ä¸­ä½¿ç”¨ Xcode é˜…è¯»æºç äº†ã€‚</li><li><code>-R</code> ä»£è¡¨ release æ¨¡å¼çš„ç¼–è¯‘ã€‚å®ƒä¼šæ¯” debug æ¨¡å¼æ›´å¿«ï¼Œåœ¨æˆ‘ 2.6 GHz çš„ core i7 2013 ç”µè„‘ä¸Šï¼Œ25 åˆ† vs 70 åˆ†ã€‚å ç”¨çš„ç©ºé—´ä¹Ÿæ›´å°‘ï¼Œ2GB vs 24GBã€‚</li></ul><h1 id="Orienting-yourself"><a href="#Orienting-yourself" class="headerlink" title="Orienting yourself"></a>Orienting yourself</h1><p>å½“ build ç»“æŸå¿«æ·ï¼Œä½ å¯ä»¥åœ¨ <code>./build/Xcode-ReleaseAssert/swift-macosx-x86_64/</code> ä¸­æ‰¾åˆ°ç»“æœï¼Œ<code>swift-source</code> çš„å­æ–‡ä»¶å¤¹ä¸­ã€‚å…¶ä¸­ä¼šæœ‰ä¸€ä¸ª <code>Swift.xcodeproj</code> Xcode é¡¹ç›®ï¼Œå·²ç»å¤„ç†å¥½çš„æ ‡å‡†åº“ä»£ç åœ¨ <code>./stdlib/public/code/8/</code> ä¸­ã€‚æ³¨æ„ï¼Œè¿™ä¸ªæ–‡ä»¶å¤¹ä¸­åªæœ‰ä» .gyb æ–‡ä»¶å¤„ç†è¿‡æ¥çš„æ–‡ä»¶ï¼ŒåŸæ¥ä»¥ <code>.swift</code> ç»“å°¾çš„æ–‡ä»¶è¿˜åœ¨åŸæ¥çš„ä½ç½®ã€‚</p><p>ä¸å¹¸çš„æ˜¯, åœ¨ Xcode ä¸­ä½¿ç”¨ <em>Open Quickly</em> (â‡§âŒ˜O) <a href="https://twitter.com/UINT_MIN/status/792101106495008768" target="_blank" rel="external">æ‰“ä¸å¼€ç‰¹å®šçš„ API</a>. æˆ‘é€šå¸¸ä½¿ç”¨ <em>Find in Project</em> (â‡§âŒ˜F) æ¥è¿›è¡Œå¯¼èˆªã€‚å¦‚æœä½ ä½¿ç”¨åªå‡ºç°çš„å‡½æ•°å®šä¹‰çš„å­—ç¬¦ä¸²æ¥æœç´¢ï¼Œé‚£å°±å¾ˆå®¹æ˜“æœç´¢åˆ°äº†ã€‚æ¯”å¦‚è¦æœç´¢ <code>print</code> å‡½æ•°çš„å®šä¹‰ï¼Œæœç´¢ â€œfunc print(â€œ è€Œä¸æ˜¯ â€œprintâ€ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥è¿è¡Œ <code>swift</code> REPL æˆ–è€… <code>swiftc</code> ç¼–è¯‘å™¨äº†ã€‚éƒ½åœ¨ <code>./Release/bin/</code> ä¸­ã€‚å¦‚æœä½ æƒ³è¦æµ‹è¯•ä¸€äº›åœ¨ä¹‹å‰ release ä¸­æœ‰çš„ bugï¼Œä½†æ˜¯åœ¨å½“å‰ master å·²ç»è¢«ä¿®å¤äº†ï¼Œå°±ä¼šå¾ˆæ–¹ä¾¿äº†ã€‚</p><h1 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h1><p>å¦‚æœä½ æƒ³åœ¨ä»¥åæ›´æ–°æœ¬åœ°çš„ cloneï¼Œé‡æ–°è¿è¡Œ <code>update-checkout</code> è„šæœ¬ï¼Œå¹¶ä¸” rebuild:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">./swift/utils/update-checkout</div><div class="line">./swift/utils/build-script -x -R</div></pre></td></tr></table></figure><p>è¿™äº›éƒ½æ˜¯å¢é‡ç¼–è¯‘ï¼Œæ¯”ç¬¬ä¸€æ¬¡è¦å¿«å¾—å¤šã€‚</p><h1 id="åˆ‡æ¢åˆ°æŒ‡å®šçš„ç‰ˆæœ¬"><a href="#åˆ‡æ¢åˆ°æŒ‡å®šçš„ç‰ˆæœ¬" class="headerlink" title="åˆ‡æ¢åˆ°æŒ‡å®šçš„ç‰ˆæœ¬"></a>åˆ‡æ¢åˆ°æŒ‡å®šçš„ç‰ˆæœ¬</h1><p>å¦‚æœä½ æƒ³è¦éªŒè¯ä¸€ä¸ªä½ åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å·²ç»ä½¿ç”¨çš„ Swift ç‰¹å®šç‰ˆæœ¬ API çš„è¡¨ç°ï¼Œä½ å°±éœ€è¦æŸ¥çœ‹é‚£ä¸ªç‰ˆæœ¬çš„ Swift ä»£ç è€Œä¸æ˜¯å½“å‰ <em>master</em> åˆ†æ”¯ã€‚ä½†æ˜¯ç®€å•åœ°åˆ‡æ¢åˆ†æ”¯å¹¶ä¸èƒ½è§£å†³é—®é¢˜ï¼Œå› ä¸ºå¦‚æœä¸€äº›ä¾èµ–çš„ç‰ˆæœ¬å¯¹ä¸ä¸Šçš„è¯ï¼Œç¼–è¯‘æ˜¯ä¼šå¤±è´¥çš„ã€‚</p><p><code>update-checkout</code> è„šæœ¬èƒ½å¤Ÿè®©ä½ æŒ‡å®šä¸€ä¸ªç‰¹å®šçš„ tag æˆ–è€… branchã€‚å®ƒä¼šå¸®ä½ åˆ‡æ¢æ‰€æœ‰ä¾èµ–çš„ç‰ˆæœ¬ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"># Either</div><div class="line">./swift/utils/update-checkout --tag swift-3.0-RELEASE</div><div class="line"># or</div><div class="line">./swift/utils/update-checkout --scheme swift-3.0-branch</div></pre></td></tr></table></figure><p><em>swift-3.0-RELEASE</em> tag å’Œ <em>swift-3.0-branch</em> branch çš„åŒºåˆ«æ˜¯ï¼Œtag ç›¸å½“äºä¸€ä¸ª mailstoneï¼Œä»£è¡¨ Swift çš„æŸä¸ªç‰¹å®šçš„ release åˆ†æ”¯ã€‚ç„¶è€Œåˆ†æ”¯æ˜¯ä¼šä¼´éšç€ bug ä¿®å¤å’ŒåŠŸèƒ½æ”¹è¿›ä¸æ–­æ›´æ–°çš„ã€‚ç°åœ¨æ¥çœ‹ï¼Œåœ¨å®˜æ–¹ release Xcode 8.1 çš„ Swift 3.0.1 æ—¶ï¼Œ<em>swift-3.0-branch</em> åˆ†æ”¯å·²ç»åŒ…å«äº†ä¸€äº› Swift 3.0.2 ä¸­çš„ä¿®å¤ã€‚</p><p>ä¸å¹¸çš„æ˜¯ï¼Œæˆ‘å‘ç° <code>update-checkout --scheme</code> çš„å‘½ä»¤éå¸¸è„†å¼±ï¼ˆ<code>--tag</code> åœ¨æˆ‘çœ‹æ¥èƒ½å¥½ä¸€äº›ï¼‰ã€‚è¿™ä¸ªè„šæœ¬ä¼šå¯¹ä»£ç è¿›è¡Œ <a href="https://git-scm.com/docs/git-rebase" target="_blank" rel="external">rebase</a>  æ“ä½œï¼Œå¹¶ä¸”åˆ‡æ¢åˆ°æŒ‡å®šçš„åˆ†æ”¯ï¼Œè¿™ä¼šåœ¨å­é¡¹ç›®ä¸­å¸¦æ¥åˆå¹¶å†²çªï¼Œç„¶è€Œæˆ‘å¹¶æ²¡æœ‰å¯¹ä»£ç ä½œå‡ºä»»ä½•æ›´æ”¹ã€‚æˆ‘ä¸æ˜ç™½ä¸ºä»€ä¹ˆè¿™ä¸ªè„šæœ¬ä¼šè¿™æ ·ã€‚</p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;åŸæ–‡é“¾æ¥=&lt;a href=&quot;https://oleb.net/blog/2016/10/swift-stdlib-source/&quot; target=&quot;_blank&quot; rel=&quot;external&quot;&gt;https://oleb.net/blog/2016/10/swift-stdl
      
    
    </summary>
    
    
      <category term="ç¿»è¯‘" scheme="http://zhaoxinyu.me/tags/%E7%BF%BB%E8%AF%91/"/>
    
  </entry>
  
  <entry>
    <title>ä½¿ç”¨ Vagrant æ­å»º Node.js ç¯å¢ƒ</title>
    <link href="http://zhaoxinyu.me/2016-11-20-vagrant-setup/"/>
    <id>http://zhaoxinyu.me/2016-11-20-vagrant-setup/</id>
    <published>2016-11-20T03:22:00.000Z</published>
    <updated>2016-11-20T15:47:13.000Z</updated>
    
    <content type="html"><![CDATA[<p>æˆ‘è®°å¾—æˆ‘åœ¨çŸ¥ä¹ Q3 çš„ä¸ªäºº OKR ä¸­å®šä¸‹äº†ä¸€ä¸ªå°ç›®æ ‡ï¼Œå°±æ˜¯å­¦ä¹  Node.jsï¼Œå¯æ˜¯ç°åœ¨ Q4 éƒ½è¿‡å»ä¸€åŠäº†ï¼ŒNode çš„æ¯›ä¹Ÿæ²¡å­¦ã€‚</p><p>ä¸ºäº†åœ†ä¹‹å‰å¹è¿‡çš„ç‰›é€¼ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†ä¹‹åæˆ‘å°†ä¸ classTC åŒå­¦ä¸€èµ·åšçš„é¡¹ç›®ï¼Œæˆ‘å†³å®šå¥½å¥½å­¦ä¹ ä¸€ä¸‹ã€‚å…ˆä»ç¯å¢ƒæ­å»ºåšèµ·ã€‚</p><p>å…¶å® Node çš„ç¯å¢ƒæ˜¯å¾ˆå¥½æ­å»ºçš„ï¼Œç›´æ¥åœ¨å®˜ç½‘åœ¨ä¸Šä¸‹è½½æœ€æ–° Binary Package å®‰è£…å°±å¯ä»¥äº†ï¼Œå¯æ˜¯ä¸ºä»€ä¹ˆè¿˜è¦ç”¨ Vagrant å‘¢ï¼Ÿ</p><p>å› ä¸ºæˆ‘æ›¾ç»åœ¨ä¸€æœŸ TeaHour.fm çš„èŠ‚ç›®ä¸­å¬åˆ°è¿‡ï¼Œè¦å…»æˆæŠŠå†™ä»£ç çš„ç¯å¢ƒå’Œç”Ÿäº§çš„ç¯å¢ƒä¿æŒä¸€è‡´çš„å¥½ä¹ æƒ¯ã€‚è€Œ Vagrant å°±å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œä¸çŸ¥é“çš„åŒå­¦å¯ä»¥å»å®˜ç½‘äº†è§£ä¸€ä¸‹ã€‚</p><ul><li>é¦–å…ˆå®‰è£… <a href="https://www.vagrantup.com/" target="_blank" rel="external">vagrant</a> + <a href="https://www.virtualbox.org/" target="_blank" rel="external">virtual box</a></li><li>mac ä¸Šåˆ›å»ºä¸€ä¸ªç›®å½•å¹¶è¿›å…¥ï¼Œæ¯”å¦‚æˆ‘çš„ç›®å½•æ˜¯ <code>vagrant</code>ï¼Œ</li><li>æ‰§è¡Œ <code>vagrant init</code></li><li><p>å®‰è£… Ubuntu 14.04 boxï¼ˆå½“ç„¶ä½ ä¹Ÿå¯ä»¥é€‰æ‹©å…¶å®ƒ boxï¼Œä½ ç”Ÿäº§ç¯å¢ƒç”¨ä»€ä¹ˆï¼Œè¿™é‡Œå°±ç”¨ä»€ä¹ˆ boxï¼‰</p><p><code>vagrant box add ubuntu/trusty64</code> ï¼ˆæ­¤æ­¥éª¤æ‰§è¡Œæ—¶é—´å–å†³äºç½‘é€Ÿï¼Œåšå¥½å¿ƒç†å‡†å¤‡ï¼‰</p><p>å¦‚æœæŠ¥é”™ï¼Œæ‰§è¡Œ <code>sudo rm /opt/vagrant/embedded/bin/curl</code> åå†æ‰§è¡Œä¸€éä¸Šä¸€æ¡å‘½ä»¤</p></li><li><code>vagrant up</code> æ ¹æ®å½“å‰ Vagrantfile å¯åŠ¨ vagrant</li><li><p><code>vagrant ssh</code> ssh è¿›å…¥å½“å‰çš„ vagrant ç¯å¢ƒï¼Œè¿›è¡Œä¸€äº› setup çš„å·¥ä½œ</p><p>åœ¨ vagrant ä¸­æ‰§è¡Œ <code>mkdir helloworld</code> åˆ›å»ºä¸€ä¸ªå’Œ mac å…±äº«çš„ç›®å½•<br><code>logout</code> é€€å‡º ssh</p></li><li>åœ¨ mac ä¸Šçš„ vagrant ç›®å½•åˆ›å»ºä¸€ä¸ªç›®å½• <code>mkdir helloworld</code> ç”¨äºä¸ vagrant å…±äº«</li><li>ç¼–è¾‘ Vagrantfile</li></ul><p>ç†Ÿæ‚‰ CocoaPods çš„åŒå­¦çœ‹ç€ä¸‹é¢çš„æ–‡ä»¶åº”è¯¥å¾ˆäº²åˆ‡</p><figure class="highlight ruby"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># -*- mode: ruby -*-</span></div><div class="line"><span class="comment"># vi: set ft=ruby :</span></div><div class="line"><span class="comment"># è¿™é‡Œçš„ host æŒ‡çš„æ˜¯æˆ‘ä»¬çš„ç”µè„‘ -&gt; ä¹Ÿå°±æ˜¯ mac</span></div><div class="line"><span class="comment"># guest æŒ‡çš„æ˜¯ Ubuntu</span></div><div class="line">Vagrant.configure(<span class="string">"2"</span>) <span class="keyword">do</span> <span class="params">|config|</span></div><div class="line">  <span class="comment"># æŒ‡å®šæˆ‘ä»¬ä½¿ç”¨çš„ box</span></div><div class="line">  config.vm.box = <span class="string">"ubuntu/trusty64"</span></div><div class="line">  <span class="comment"># ç¦ç”¨æ‰è‡ªåŠ¨æ›´æ–°ï¼Œå½“ç„¶å•¦ï¼Œè¿™è¡Œæ˜¯ optional çš„</span></div><div class="line">  config.vm.box_check_update = <span class="literal">false</span></div><div class="line">  <span class="comment"># å‡å®šæˆ‘ä»¬çš„ node ç¨‹åºè·‘åœ¨ 8080 ç«¯å£ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªç«¯å£è½¬å‘å‡ºæ¥ç»™ macï¼Œ</span></div><div class="line">  <span class="comment"># åœ¨ mac ä¸Šä¹Ÿå°±èƒ½é€šè¿‡ http://localhost:8080 è®¿é—®è·‘åœ¨ Ubuntu ä¸Šçš„ node åº”ç”¨äº†</span></div><div class="line">  config.vm.network <span class="string">"forwarded_port"</span>, <span class="symbol">guest:</span> <span class="number">8080</span>, <span class="symbol">host:</span> <span class="number">8080</span></div><div class="line">  <span class="comment"># æ˜ å°„å…±äº«æ–‡ä»¶å¤¹</span></div><div class="line">  config.vm.synced_folder <span class="string">"path-to-vagrant/vagrant/helloworld"</span>, <span class="string">"/home/vagrant/helloworld"</span></div><div class="line">  <span class="comment"># è¿™ä¸‹é¢çš„å‘½ä»¤å¯ä»¥é€šè¿‡ `vagrant provision` æ¥æ‰§è¡Œï¼Œè¿›è¡Œä¸€äº› Ubuntu ç¯å¢ƒçš„åˆå§‹åŒ–å·¥ä½œ</span></div><div class="line">  <span class="comment"># ä¸éœ€è¦æ¯æ¬¡éƒ½æ‰§è¡Œï¼Œæœ‰å˜æ›´äº†æ‰§è¡Œå°±å¥½</span></div><div class="line">  config.vm.provision <span class="string">"shell"</span>, <span class="symbol">inline:</span> <span class="string">&lt;&lt;-SHELL</span></div><div class="line"><span class="string">    apt-get update</span></div><div class="line"><span class="string">    sudo apt-get install nodejs -y</span></div><div class="line"><span class="string">    sudo apt-get install npm -y</span></div><div class="line"><span class="string">  SHELL</span></div><div class="line"><span class="keyword">end</span></div></pre></td></tr></table></figure><ul><li><code>vagrant reload</code> é‡å¯ vagrant</li><li><code>vagrant provision</code> å®‰è£…æˆ‘ä»¬åœ¨ Vagrantfile ä¸­å†™å¥½çš„ provision</li></ul><p>ç¯å¢ƒå®‰è£…åˆ°æ­¤ç»“æŸ</p><hr><p>æµ‹è¯•æˆ‘ä»¬å®‰è£…å¥½çš„ç¯å¢ƒï¼š</p><ul><li><code>vagrant ssh</code> ssh è¿› vagrant</li><li>åœ¨ mac ä¸Šçš„ /path-to-vagrant/vagrant æ–°å»ºä¸€ä¸ª <code>main.js</code> çš„æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</li></ul><p>è¿™å°±æ˜¯æˆ‘ä»¬å»ºç«‹ç›®å½•æ˜ å°„çš„åŸå› ï¼Œå¯ä»¥é€šè¿‡ mac ä¸Šçš„å„ç§ç¼–è¾‘å™¨ï¼Œç¼–è¾‘åœ¨ vagrant ä¸­çš„ä¸œè¥¿</p><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> http = <span class="built_in">require</span>(<span class="string">"http"</span>);</div><div class="line"></div><div class="line">http.createServer(<span class="function"><span class="keyword">function</span> (<span class="params">request, response</span>) </span>&#123;</div><div class="line">response.writeHead(<span class="number">200</span>, &#123;<span class="string">'Content-Type'</span>: <span class="string">'text/plain'</span>&#125;);</div><div class="line">response.end(<span class="string">'Hello World\n'</span>);</div><div class="line">&#125;).listen(<span class="number">8080</span>);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'Sever running at http://127.0.0.1:8080'</span>);</div></pre></td></tr></table></figure><ul><li><code>vagrant ssh</code> è¿›å…¥ vagrantï¼Œ<code>cd helloworld</code> æ‰§è¡Œ <code>node main.js</code></li><li>åœ¨ mac ä¸Šç”¨æµè§ˆå™¨æŸ¥çœ‹ <code>localhost:8080</code>ï¼Œå¦‚æœæœ‰ <code>hello world</code> å°±è¯´æ˜æˆåŠŸå•¦~ å¯ä»¥é¡ºåˆ©å¼€å§‹ node.js çš„å­¦ä¹ äº†</li></ul><p><del>å¦‚æœä½ åªæ˜¯ä¸ºäº†å­¦ä¹  Node.js å¤§å¯ä¸å¿…åƒæˆ‘è¿™ä¹ˆæŠ˜è…¾ï¼Œç›´æ¥ä¸‹è½½ Binary å®‰è£…å°±å¯ä»¥äº†</del></p>]]></content>
    
    <summary type="html">
    
      
      
        &lt;p&gt;æˆ‘è®°å¾—æˆ‘åœ¨çŸ¥ä¹ Q3 çš„ä¸ªäºº OKR ä¸­å®šä¸‹äº†ä¸€ä¸ªå°ç›®æ ‡ï¼Œå°±æ˜¯å­¦ä¹  Node.jsï¼Œå¯æ˜¯ç°åœ¨ Q4 éƒ½è¿‡å»ä¸€åŠäº†ï¼ŒNode çš„æ¯›ä¹Ÿæ²¡å­¦ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†åœ†ä¹‹å‰å¹è¿‡çš„ç‰›é€¼ï¼ŒåŒæ—¶ä¹Ÿä¸ºäº†ä¹‹åæˆ‘å°†ä¸ classTC åŒå­¦ä¸€èµ·åšçš„é¡¹ç›®ï¼Œæˆ‘å†³å®šå¥½å¥½å­¦ä¹ ä¸€ä¸‹ã€‚å…ˆä»ç¯å¢ƒæ­å»ºåšèµ·ã€‚&lt;/p
      
    
    </summary>
    
    
      <category term="å·¥å…·" scheme="http://zhaoxinyu.me/tags/%E5%B7%A5%E5%85%B7/"/>
    
  </entry>
  
</feed>
